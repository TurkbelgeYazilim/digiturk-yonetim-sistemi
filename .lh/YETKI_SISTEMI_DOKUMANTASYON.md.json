{
    "sourceFile": "YETKI_SISTEMI_DOKUMANTASYON.md",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1761058556909,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1761058556909,
            "name": "Commit-0",
            "content": "# ğŸ” Sayfa Yetkilendirme Sistemi DokÃ¼mantasyonu\r\n\r\n## ğŸ“‹ Ä°Ã§indekiler\r\n1. [Genel BakÄ±ÅŸ](#genel-bakÄ±ÅŸ)\r\n2. [Kurulum](#kurulum)\r\n3. [Yetki DeÄŸerleri](#yetki-deÄŸerleri)\r\n4. [KullanÄ±m Ã–rnekleri](#kullanÄ±m-Ã¶rnekleri)\r\n5. [Admin KontrolÃ¼](#admin-kontrolÃ¼)\r\n6. [VeritabanÄ± YapÄ±sÄ±](#veritabanÄ±-yapÄ±sÄ±)\r\n7. [Checklist](#checklist)\r\n\r\n---\r\n\r\n## ğŸ¯ Genel BakÄ±ÅŸ\r\n\r\nBu sistem, sayfalarÄ±n kullanÄ±cÄ± gruplarÄ±na gÃ¶re yetkilendirilmesini saÄŸlar.\r\n\r\n**Ana Ã–zellikler:**\r\n- âœ… Sayfa bazlÄ± eriÅŸim kontrolÃ¼\r\n- âœ… KullanÄ±cÄ± grubu bazlÄ± yetkilendirme\r\n- âœ… Admin bypass (group_id = 1)\r\n- âœ… Kendi kayÄ±tlarÄ±nÄ± gÃ¶rme kÄ±sÄ±tÄ±\r\n- âœ… Ekleme, dÃ¼zenleme, silme yetkileri\r\n\r\n---\r\n\r\n## ğŸ”§ Kurulum\r\n\r\n### AdÄ±m 1: Auth KontrolÃ¼ ve Yetki Sistemi Kodu\r\n\r\nHer sayfanÄ±n baÅŸÄ±na (header'dan Ã¶nce) aÅŸaÄŸÄ±daki kodu ekleyin:\r\n\r\n```php\r\n<?php\r\n$pageTitle = \"Sayfa BaÅŸlÄ±ÄŸÄ±\";\r\n$breadcrumbs = [\r\n    ['title' => 'Sayfa BaÅŸlÄ±ÄŸÄ±']\r\n];\r\n\r\n// Auth kontrol\r\nrequire_once '../../../auth.php';\r\n$currentUser = checkAuth();\r\ncheckUserStatus();\r\nupdateLastActivity();\r\n\r\n// Sayfa yetkilendirme kontrolÃ¼\r\n$sayfaYetkileri = [\r\n    'gor' => false,\r\n    'kendi_kullanicini_gor' => false,\r\n    'ekle' => false,\r\n    'duzenle' => false,\r\n    'sil' => false\r\n];\r\n\r\n// Admin kontrolÃ¼ (group_id = 1 ise tÃ¼m yetkilere sahip)\r\n$isAdmin = ($currentUser['group_id'] == 1);\r\n\r\nif ($isAdmin) {\r\n    // Admin iÃ§in tÃ¼m yetkileri aÃ§\r\n    $sayfaYetkileri = [\r\n        'gor' => 1,\r\n        'kendi_kullanicini_gor' => 0, // 0 = Herkesi gÃ¶rebilir\r\n        'ekle' => 1,\r\n        'duzenle' => 1,\r\n        'sil' => 1\r\n    ];\r\n} else {\r\n    // Admin deÄŸilse normal yetki kontrolÃ¼ yap\r\n    try {\r\n        $conn = getDatabaseConnection();\r\n        \r\n        // Mevcut sayfa URL'sini al\r\n        $currentPageUrl = basename($_SERVER['PHP_SELF']);\r\n        \r\n        // Sayfa bilgisini ve yetkilerini Ã§ek\r\n        $yetkiSql = \"\r\n            SELECT \r\n                tsy.gor,\r\n                tsy.kendi_kullanicini_gor,\r\n                tsy.ekle,\r\n                tsy.duzenle,\r\n                tsy.sil,\r\n                tsy.durum as yetki_durum,\r\n                ts.durum as sayfa_durum\r\n            FROM dbo.tanim_sayfalar ts\r\n            INNER JOIN dbo.tanim_sayfa_yetkiler tsy ON ts.sayfa_id = tsy.sayfa_id\r\n            WHERE ts.sayfa_url = ?\r\n            AND tsy.user_group_id = ?\r\n            AND ts.durum = 1\r\n            AND tsy.durum = 1\r\n        \";\r\n        \r\n        $yetkiStmt = $conn->prepare($yetkiSql);\r\n        $yetkiStmt->execute([$currentPageUrl, $currentUser['group_id']]);\r\n        $yetkiResult = $yetkiStmt->fetch(PDO::FETCH_ASSOC);\r\n        \r\n        if ($yetkiResult) {\r\n            $sayfaYetkileri = [\r\n                'gor' => (int)$yetkiResult['gor'],\r\n                'kendi_kullanicini_gor' => (int)$yetkiResult['kendi_kullanicini_gor'],\r\n                'ekle' => (int)$yetkiResult['ekle'],\r\n                'duzenle' => (int)$yetkiResult['duzenle'],\r\n                'sil' => (int)$yetkiResult['sil']\r\n            ];\r\n            \r\n            // GÃ¶rme yetkisi yoksa (0 ise) sayfaya eriÅŸimi engelle\r\n            if ($sayfaYetkileri['gor'] == 0) {\r\n                header('Location: ../../../index.php?error=yetki_yok');\r\n                exit;\r\n            }\r\n        } else {\r\n            // Yetki tanÄ±mÄ± bulunamazsa eriÅŸimi engelle\r\n            header('Location: ../../../index.php?error=yetki_tanimlanmamis');\r\n            exit;\r\n        }\r\n        \r\n    } catch (Exception $e) {\r\n        // Hata durumunda gÃ¼venlik iÃ§in eriÅŸimi engelle\r\n        error_log(\"Yetki kontrol hatasÄ±: \" . $e->getMessage());\r\n        header('Location: ../../../index.php?error=sistem_hatasi');\r\n        exit;\r\n    }\r\n}\r\n\r\n// Buradan sonra sayfa kodlarÄ± devam eder...\r\n?>\r\n```\r\n\r\n### AdÄ±m 2: Path AyarlamasÄ±\r\n\r\nFarklÄ± klasÃ¶r yapÄ±larÄ±na gÃ¶re path'leri dÃ¼zenleyin:\r\n\r\n| KlasÃ¶r Seviyesi | Path |\r\n|----------------|------|\r\n| `/views/Yonetim/Muhasebe/` | `../../../` |\r\n| `/views/Yonetim/` | `../../` |\r\n| `/views/` | `../` |\r\n\r\n---\r\n\r\n## ğŸ“Š Yetki DeÄŸerleri\r\n\r\n### Yetki Tablosu\r\n\r\n| Yetki | DeÄŸer | AnlamÄ± | KullanÄ±m AlanÄ± |\r\n|-------|-------|--------|----------------|\r\n| **gor** | 1 | âœ… Sayfaya girebilir | Sayfa eriÅŸim kontrolÃ¼ |\r\n| **gor** | 0 | âŒ Sayfaya giremez | Redirect yapÄ±lÄ±r |\r\n| **kendi_kullanicini_gor** | 1 | ğŸ‘¤ Sadece kendi kayÄ±tlarÄ±nÄ± gÃ¶rÃ¼r | SQL filtreleme, dropdown disable |\r\n| **kendi_kullanicini_gor** | 0 | ğŸ‘¥ Herkesi gÃ¶rÃ¼r | Tam eriÅŸim |\r\n| **ekle** | 1 | âœ… Ekleme yapabilir | \"Yeni Ekle\" butonu |\r\n| **ekle** | 0 | âŒ Ekleme yapamaz | Buton gizlenir |\r\n| **duzenle** | 1 | âœ… DÃ¼zenleme yapabilir | Edit butonu, Export, YazdÄ±r |\r\n| **duzenle** | 0 | âŒ DÃ¼zenleme yapamaz | Buton gizlenir |\r\n| **sil** | 1 | âœ… Silme yapabilir | Delete butonu |\r\n| **sil** | 0 | âŒ Silme yapamaz | Buton gizlenir |\r\n\r\n### DeÄŸer MantÄ±ÄŸÄ±\r\n\r\n```\r\n1 = Aktif / Ä°zinli / Yapabilir\r\n0 = Pasif / Ä°zinsiz / Yapamaz\r\n```\r\n\r\n**Ã–NEMLÄ°:** `kendi_kullanicini_gor` tersi mantÄ±kta Ã§alÄ±ÅŸÄ±r:\r\n- `1` = KÄ±sÄ±tlÄ± (sadece kendini gÃ¶rÃ¼r)\r\n- `0` = Serbest (herkesi gÃ¶rÃ¼r)\r\n\r\n---\r\n\r\n## ğŸ¯ KullanÄ±m Ã–rnekleri\r\n\r\n### 1ï¸âƒ£ Buton GÃ¶ster/Gizle\r\n\r\n#### Yeni Ekleme Butonu\r\n```php\r\n<?php if ($sayfaYetkileri['ekle'] == 1): ?>\r\n<button class=\"btn btn-primary\" onclick=\"openNewModal()\">\r\n    <i class=\"fas fa-plus me-1\"></i>Yeni Ekle\r\n</button>\r\n<?php endif; ?>\r\n```\r\n\r\n#### Export ve YazdÄ±r ButonlarÄ±\r\n```php\r\n<?php if ($sayfaYetkileri['duzenle'] == 1): ?>\r\n<button class=\"btn btn-outline-primary\" onclick=\"exportToExcel()\">\r\n    <i class=\"fas fa-file-excel me-1\"></i>Excel'e Aktar\r\n</button>\r\n<button class=\"btn btn-outline-secondary\" onclick=\"printReport()\">\r\n    <i class=\"fas fa-print me-1\"></i>YazdÄ±r\r\n</button>\r\n<?php endif; ?>\r\n```\r\n\r\n### 2ï¸âƒ£ Dropdown Aktif/Pasif Yapma\r\n\r\n#### Bayi SeÃ§imi Dropdown\r\n```php\r\n<select class=\"form-select\" id=\"bayi_ad_soyad\" name=\"bayi_ad_soyad\" \r\n    <?php echo $sayfaYetkileri['kendi_kullanicini_gor'] == 1 ? 'disabled' : ''; ?>>\r\n    <option value=\"\">TÃ¼mÃ¼</option>\r\n    <?php foreach ($bayiAdSoyadOptions as $id => $bayiData): ?>\r\n        <?php \r\n        // kendi_kullanicini_gor = 1 ise sadece kendi kaydÄ±nÄ± gÃ¶ster\r\n        if ($sayfaYetkileri['kendi_kullanicini_gor'] == 1 && $id != $currentUser['id']) {\r\n            continue;\r\n        }\r\n        ?>\r\n        <option value=\"<?php echo htmlspecialchars($id); ?>\">\r\n            <?php echo htmlspecialchars($bayiData['full_name']); ?>\r\n        </option>\r\n    <?php endforeach; ?>\r\n</select>\r\n\r\n<?php if ($sayfaYetkileri['kendi_kullanicini_gor'] == 1): ?>\r\n    <!-- KÄ±sÄ±tlÄ± kullanÄ±cÄ± iÃ§in hidden input ile deÄŸeri gÃ¶nder -->\r\n    <input type=\"hidden\" name=\"bayi_ad_soyad\" value=\"<?php echo htmlspecialchars($currentUser['id']); ?>\">\r\n    <small class=\"text-muted\">\r\n        <i class=\"fas fa-info-circle\"></i> Sadece kendi kayÄ±tlarÄ±nÄ±zÄ± gÃ¶rÃ¼ntÃ¼leyebilirsiniz\r\n    </small>\r\n<?php endif; ?>\r\n```\r\n\r\n### 3ï¸âƒ£ SQL Veri Filtreleme\r\n\r\n#### KayÄ±t Listeleme\r\n```php\r\n// kendi_kullanicini_gor = 1 ise sadece kendi kayÄ±tlarÄ±nÄ± getir\r\nif ($sayfaYetkileri['kendi_kullanicini_gor'] == 1) {\r\n    $sql = \"SELECT * FROM tablo WHERE user_id = ? ORDER BY created_at DESC\";\r\n    $stmt = $conn->prepare($sql);\r\n    $stmt->execute([$currentUser['id']]);\r\n} else {\r\n    // kendi_kullanicini_gor = 0 ise tÃ¼m kayÄ±tlarÄ± getir\r\n    $sql = \"SELECT * FROM tablo ORDER BY created_at DESC\";\r\n    $stmt = $conn->prepare($sql);\r\n    $stmt->execute();\r\n}\r\n```\r\n\r\n#### Bayi Listesi Ã‡ekme\r\n```php\r\ntry {\r\n    $conn = getDatabaseConnection();\r\n    \r\n    // kendi_kullanicini_gor = 1 ise sadece kendi kaydÄ±nÄ± Ã§ek\r\n    if ($sayfaYetkileri['kendi_kullanicini_gor'] == 1) {\r\n        $bayiSql = \"SELECT id, first_name, last_name, email \r\n                   FROM users \r\n                   WHERE id = ? AND status = 'AKTIF'\";\r\n        $bayiStmt = $conn->prepare($bayiSql);\r\n        $bayiStmt->execute([$currentUser['id']]);\r\n        $bayiler = $bayiStmt->fetchAll(PDO::FETCH_ASSOC);\r\n    } else {\r\n        // kendi_kullanicini_gor = 0 ise tÃ¼m bayileri gÃ¶ster\r\n        $bayiSql = \"SELECT id, first_name, last_name, email \r\n                   FROM users \r\n                   WHERE user_group_id IN (SELECT id FROM user_groups WHERE group_name IN ('bayi', 'Bayi'))\r\n                   AND status = 'AKTIF'\r\n                   ORDER BY first_name, last_name\";\r\n        $bayiStmt = $conn->prepare($bayiSql);\r\n        $bayiStmt->execute();\r\n        $bayiler = $bayiStmt->fetchAll(PDO::FETCH_ASSOC);\r\n    }\r\n    \r\n} catch (Exception $e) {\r\n    $bayiler = [];\r\n}\r\n```\r\n\r\n### 4ï¸âƒ£ Tablo Ä°ÅŸlem ButonlarÄ±\r\n\r\n#### DÃ¼zenle ve Sil ButonlarÄ±\r\n```php\r\n<td>\r\n    <div class=\"btn-group\" role=\"group\">\r\n        <?php if ($sayfaYetkileri['duzenle'] == 1): ?>\r\n        <button type=\"button\" class=\"btn btn-sm btn-outline-primary\" \r\n                onclick=\"editRecord(<?php echo $row['id']; ?>)\">\r\n            <i class=\"fas fa-edit\"></i>\r\n        </button>\r\n        <?php endif; ?>\r\n        \r\n        <?php if ($sayfaYetkileri['sil'] == 1): ?>\r\n        <button type=\"button\" class=\"btn btn-sm btn-outline-danger\" \r\n                onclick=\"deleteRecord(<?php echo $row['id']; ?>)\">\r\n            <i class=\"fas fa-trash\"></i>\r\n        </button>\r\n        <?php endif; ?>\r\n        \r\n        <?php if ($sayfaYetkileri['duzenle'] == 0 && $sayfaYetkileri['sil'] == 0): ?>\r\n        <span class=\"badge bg-secondary\">Yetki Yok</span>\r\n        <?php endif; ?>\r\n    </div>\r\n</td>\r\n```\r\n\r\n### 5ï¸âƒ£ Filtre Dropdown'larÄ±\r\n\r\n#### Tablo Filtre SatÄ±rÄ±\r\n```php\r\n<tr class=\"filter-row\">\r\n    <th>\r\n        <select class=\"form-select form-select-sm table-filter\" data-column=\"1\" \r\n                <?php echo $sayfaYetkileri['kendi_kullanicini_gor'] == 1 ? 'disabled' : ''; ?>>\r\n            <?php if ($sayfaYetkileri['kendi_kullanicini_gor'] == 1 && !empty($bayiler)): ?>\r\n                <option value=\"<?php echo $bayiler[0]['id']; ?>\" selected>\r\n                    <?php echo htmlspecialchars($bayiler[0]['first_name'] . ' ' . $bayiler[0]['last_name']); ?>\r\n                </option>\r\n            <?php else: ?>\r\n                <option value=\"\">TÃ¼m Bayiler</option>\r\n                <?php foreach ($filterData['bayiler'] as $bayiId => $bayiName): ?>\r\n                    <option value=\"<?php echo $bayiId; ?>\">\r\n                        <?php echo htmlspecialchars($bayiName); ?>\r\n                    </option>\r\n                <?php endforeach; ?>\r\n            <?php endif; ?>\r\n        </select>\r\n    </th>\r\n</tr>\r\n```\r\n\r\n### 6ï¸âƒ£ Form Submit KontrolÃ¼\r\n\r\n#### Ekleme/DÃ¼zenleme Ä°zni\r\n```php\r\n// HakediÅŸ tanÄ±m iÅŸlemleri\r\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\r\n    $action = $_POST['action'] ?? '';\r\n    \r\n    switch ($action) {\r\n        case 'add':\r\n            // Ekleme yetkisi kontrolÃ¼\r\n            if ($sayfaYetkileri['ekle'] != 1) {\r\n                $message = 'Ekleme yetkiniz bulunmamaktadÄ±r.';\r\n                $messageType = 'danger';\r\n                break;\r\n            }\r\n            // ... ekleme kodu\r\n            break;\r\n            \r\n        case 'edit':\r\n            // DÃ¼zenleme yetkisi kontrolÃ¼\r\n            if ($sayfaYetkileri['duzenle'] != 1) {\r\n                $message = 'DÃ¼zenleme yetkiniz bulunmamaktadÄ±r.';\r\n                $messageType = 'danger';\r\n                break;\r\n            }\r\n            // ... dÃ¼zenleme kodu\r\n            break;\r\n            \r\n        case 'delete':\r\n            // Silme yetkisi kontrolÃ¼\r\n            if ($sayfaYetkileri['sil'] != 1) {\r\n                $message = 'Silme yetkiniz bulunmamaktadÄ±r.';\r\n                $messageType = 'danger';\r\n                break;\r\n            }\r\n            // ... silme kodu\r\n            break;\r\n    }\r\n}\r\n```\r\n\r\n---\r\n\r\n## ğŸ”‘ Admin KontrolÃ¼\r\n\r\n### Admin Bypass Sistemi\r\n\r\n**Admin kullanÄ±cÄ±lar** (`group_id = 1`) iÃ§in tÃ¼m yetki kontrolleri otomatik olarak bypass edilir:\r\n\r\n```php\r\n// Admin kontrolÃ¼ (group_id = 1 ise tÃ¼m yetkilere sahip)\r\n$isAdmin = ($currentUser['group_id'] == 1);\r\n\r\nif ($isAdmin) {\r\n    // Admin iÃ§in tÃ¼m yetkileri aÃ§\r\n    $sayfaYetkileri = [\r\n        'gor' => 1,              // Sayfaya girebilir\r\n        'kendi_kullanicini_gor' => 0,  // 0 = Herkesi gÃ¶rebilir\r\n        'ekle' => 1,             // Ekleyebilir\r\n        'duzenle' => 1,          // DÃ¼zenleyebilir\r\n        'sil' => 1               // Silebilir\r\n    ];\r\n}\r\n```\r\n\r\n### Admin Ã–zellikleri\r\n\r\nâœ… TÃ¼m sayfalara eriÅŸebilir  \r\nâœ… TÃ¼m kullanÄ±cÄ±larÄ±n kayÄ±tlarÄ±nÄ± gÃ¶rebilir  \r\nâœ… Ekleme, dÃ¼zenleme, silme yapabilir  \r\nâœ… VeritabanÄ±nda yetki tanÄ±mÄ± olmasa bile eriÅŸir  \r\nâœ… Excel export, yazdÄ±rma gibi tÃ¼m Ã¶zellikleri kullanabilir  \r\n\r\n---\r\n\r\n## ğŸ—„ï¸ VeritabanÄ± YapÄ±sÄ±\r\n\r\n### 1. `tanim_sayfalar` Tablosu\r\nSistem sayfalarÄ±nÄ±n listesi\r\n\r\n```sql\r\nCREATE TABLE tanim_sayfalar (\r\n    sayfa_id INT PRIMARY KEY IDENTITY(1,1),\r\n    menu_id INT,\r\n    sayfa_adi NVARCHAR(100),\r\n    sayfa_url NVARCHAR(200),  -- Ã–rn: bayi_hakedis_hesapla.php\r\n    aciklama NVARCHAR(500),\r\n    durum BIT DEFAULT 1,       -- 1 = Aktif, 0 = Pasif\r\n    created_at DATETIME DEFAULT GETDATE(),\r\n    updated_at DATETIME DEFAULT GETDATE(),\r\n    sira_no INT,\r\n    sayfa_ikon NVARCHAR(50)\r\n)\r\n```\r\n\r\n### 2. `tanim_sayfa_yetkiler` Tablosu\r\nSayfa bazlÄ± yetki tanÄ±mlarÄ±\r\n\r\n```sql\r\nCREATE TABLE tanim_sayfa_yetkiler (\r\n    sayfa_yetki_id INT PRIMARY KEY IDENTITY(1,1),\r\n    sayfa_id INT,                    -- tanim_sayfalar ile iliÅŸki\r\n    user_group_id INT,               -- user_groups ile iliÅŸki\r\n    gor BIT DEFAULT 0,               -- 1 = GÃ¶rÃ¼r, 0 = GÃ¶remez\r\n    kendi_kullanicini_gor BIT DEFAULT 0,  -- 1 = Sadece kendi, 0 = Herkes\r\n    ekle BIT DEFAULT 0,              -- 1 = Ekler, 0 = Eklemez\r\n    duzenle BIT DEFAULT 0,           -- 1 = DÃ¼zenler, 0 = DÃ¼zenlemez\r\n    sil BIT DEFAULT 0,               -- 1 = Siler, 0 = Silmez\r\n    durum BIT DEFAULT 1,             -- 1 = Aktif, 0 = Pasif\r\n    created_at DATETIME DEFAULT GETDATE(),\r\n    updated_at DATETIME DEFAULT GETDATE()\r\n)\r\n```\r\n\r\n### 3. `user_groups` Tablosu\r\nKullanÄ±cÄ± gruplarÄ±\r\n\r\n```sql\r\nCREATE TABLE user_groups (\r\n    id INT PRIMARY KEY IDENTITY(1,1),\r\n    group_name NVARCHAR(50),         -- Ã–rn: Admin, Bayi, Muhasebe\r\n    group_description NVARCHAR(200),\r\n    created_at DATETIME DEFAULT GETDATE(),\r\n    updated_at DATETIME DEFAULT GETDATE()\r\n)\r\n```\r\n\r\n### Ã–rnek Veri Ekleme\r\n\r\n#### Sayfa Ekleme\r\n```sql\r\nINSERT INTO tanim_sayfalar (sayfa_adi, sayfa_url, durum)\r\nVALUES ('Bayi HakediÅŸ Hesaplama', 'bayi_hakedis_hesapla.php', 1)\r\n```\r\n\r\n#### Yetki Ekleme (Admin - TÃ¼m Yetkiler)\r\n```sql\r\nINSERT INTO tanim_sayfa_yetkiler (sayfa_id, user_group_id, gor, kendi_kullanicini_gor, ekle, duzenle, sil, durum)\r\nVALUES (1, 1, 1, 0, 1, 1, 1, 1)  -- Admin grubu (group_id=1) iÃ§in\r\n```\r\n\r\n#### Yetki Ekleme (Bayi - KÄ±sÄ±tlÄ±)\r\n```sql\r\nINSERT INTO tanim_sayfa_yetkiler (sayfa_id, user_group_id, gor, kendi_kullanicini_gor, ekle, duzenle, sil, durum)\r\nVALUES (1, 3, 1, 1, 1, 1, 0, 1)  -- Bayi grubu (group_id=3) iÃ§in\r\n-- gor=1 (GÃ¶rÃ¼r), kendi_kullanicini_gor=1 (Sadece kendini), ekle=1, duzenle=1, sil=0\r\n```\r\n\r\n---\r\n\r\n## âœ… Checklist (Her Sayfa Ä°Ã§in)\r\n\r\n### Temel Kurulum\r\n- [ ] Auth kontrol kodu eklendi\r\n- [ ] Yetki sistemi kodu eklendi\r\n- [ ] `getDatabaseConnection()` Ã§aÄŸrÄ±ldÄ±\r\n- [ ] `$currentPageUrl = basename($_SERVER['PHP_SELF'])` tanÄ±mlandÄ±\r\n\r\n### Admin KontrolÃ¼\r\n- [ ] `$isAdmin = ($currentUser['group_id'] == 1)` kontrolÃ¼ yapÄ±ldÄ±\r\n- [ ] Admin iÃ§in tÃ¼m yetkiler otomatik aÃ§Ä±ldÄ±\r\n\r\n### VeritabanÄ± Kontrolleri\r\n- [ ] `tanim_sayfalar` tablosunda sayfa kaydÄ± var\r\n- [ ] `tanim_sayfa_yetkiler` tablosunda grup yetkileri tanÄ±mlÄ±\r\n- [ ] `sayfa_url` dosya adÄ± ile eÅŸleÅŸiyor\r\n\r\n### UI Kontrolleri\r\n- [ ] \"Yeni Ekle\" butonuna `ekle` yetkisi eklendi\r\n- [ ] Dropdown'lara `kendi_kullanicini_gor` kontrolÃ¼ eklendi\r\n- [ ] DÃ¼zenle butonuna `duzenle` yetkisi eklendi\r\n- [ ] Sil butonuna `sil` yetkisi eklendi\r\n- [ ] Export/yazdÄ±r butonlarÄ±na `duzenle` yetkisi eklendi\r\n- [ ] Filtre dropdown'larÄ±na `kendi_kullanicini_gor` kontrolÃ¼ eklendi\r\n\r\n### SQL Kontrolleri\r\n- [ ] KayÄ±t listeleme sorgusuna `kendi_kullanicini_gor` filtresi eklendi\r\n- [ ] Bayi listesi sorgusuna `kendi_kullanicini_gor` filtresi eklendi\r\n- [ ] Form submit iÅŸlemlerine yetki kontrolÃ¼ eklendi\r\n\r\n### Test SenaryolarÄ±\r\n- [ ] Admin olarak giriÅŸ yapÄ±p tÃ¼m iÅŸlemleri test et\r\n- [ ] KÄ±sÄ±tlÄ± kullanÄ±cÄ± ile sadece kendi kayÄ±tlarÄ±nÄ± gÃ¶rebildiÄŸini test et\r\n- [ ] Yetkisiz kullanÄ±cÄ± ile sayfaya eriÅŸemediÄŸini test et\r\n- [ ] ButonlarÄ±n yetkiye gÃ¶re gÃ¶rÃ¼ndÃ¼ÄŸÃ¼nÃ¼/gizlendiÄŸini test et\r\n\r\n---\r\n\r\n## ğŸ” Hata AyÄ±klama\r\n\r\n### YaygÄ±n Hatalar ve Ã‡Ã¶zÃ¼mleri\r\n\r\n#### 1. \"Yetki tanÄ±mlanmamÄ±ÅŸ\" HatasÄ±\r\n**Sebep:** VeritabanÄ±nda sayfa veya yetki kaydÄ± yok  \r\n**Ã‡Ã¶zÃ¼m:**\r\n```sql\r\n-- Sayfa var mÄ± kontrol et\r\nSELECT * FROM tanim_sayfalar WHERE sayfa_url = 'dosya_adi.php'\r\n\r\n-- Yetki var mÄ± kontrol et\r\nSELECT * FROM tanim_sayfa_yetkiler \r\nWHERE sayfa_id = X AND user_group_id = Y\r\n```\r\n\r\n#### 2. Admin EriÅŸemiyor\r\n**Sebep:** `group_id` kontrolÃ¼ yanlÄ±ÅŸ  \r\n**Ã‡Ã¶zÃ¼m:**\r\n```php\r\n// KullanÄ±cÄ±nÄ±n group_id'sini kontrol et\r\nvar_dump($currentUser['group_id']);\r\n\r\n// Admin kontrolÃ¼nÃ¼ doÄŸrula\r\n$isAdmin = ($currentUser['group_id'] == 1);  // 1 olmalÄ±\r\n```\r\n\r\n#### 3. Dropdown Ã‡alÄ±ÅŸmÄ±yor\r\n**Sebep:** `kendi_kullanicini_gor` mantÄ±ÄŸÄ± ters  \r\n**Ã‡Ã¶zÃ¼m:**\r\n```php\r\n// 1 = KÄ±sÄ±tlÄ± (disabled olmalÄ±)\r\n// 0 = Serbest (enabled olmalÄ±)\r\n<?php echo $sayfaYetkileri['kendi_kullanicini_gor'] == 1 ? 'disabled' : ''; ?>\r\n```\r\n\r\n---\r\n\r\n## ğŸ“ Notlar\r\n\r\n### Ã–nemli HatÄ±rlatmalar\r\n\r\n1. **Path AyarlarÄ±:** Her sayfa iÃ§in doÄŸru path kullanÄ±n (`../../../` vs `../../`)\r\n2. **SQL Injection:** TÃ¼m SQL sorgularÄ±nda prepared statement kullanÄ±n\r\n3. **Error Log:** HatalarÄ± `error_log()` ile kaydedin\r\n4. **Security:** Yetki kontrolÃ¼ hem frontend hem backend'de olmalÄ±\r\n5. **Test:** Her yetki senaryosunu mutlaka test edin\r\n\r\n### GÃ¼venlik Ä°puÃ§larÄ±\r\n\r\n- âœ… Yetki kontrolÃ¼nÃ¼ her zaman backend'de yapÄ±n\r\n- âœ… Frontend kontrolÃ¼ sadece UX iÃ§indir, gÃ¼venlik iÃ§in deÄŸil\r\n- âœ… Admin bypass kodunu her sayfada uygulayÄ±n\r\n- âœ… Yetki tanÄ±mÄ± yoksa eriÅŸimi reddedin\r\n- âœ… HatalarÄ± kullanÄ±cÄ±ya detaylÄ± gÃ¶stermeyin\r\n\r\n---\r\n\r\n## ğŸ“ Destek\r\n\r\nSorularÄ±nÄ±z iÃ§in:\r\n- **GeliÅŸtirici:** Batuhan Kahraman\r\n- **E-posta:** batuhan.kahraman@ileka.com.tr\r\n- **Telefon:** +90 501 357 10 85\r\n\r\n---\r\n\r\n**Son GÃ¼ncelleme:** 21 Ekim 2025  \r\n**Versiyon:** 1.0.0\r\n"
        }
    ]
}