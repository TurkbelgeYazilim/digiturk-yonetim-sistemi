{
    "sourceFile": "bayi_hakedis_prim_donem.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1759394667448,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1760456491314,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,9 +59,9 @@\n                     break;\r\n                 }\r\n                 \r\n                 // Dönem adı kontrolü\r\n-                $checkSql = \"SELECT id FROM bayi_hakedis_prim_donem WHERE donem_adi = ?\";\r\n+                $checkSql = \"SELECT id FROM digiturk.bayi_hakedis_prim_donem WHERE donem_adi = ?\";\r\n                 $checkStmt = $conn->prepare($checkSql);\r\n                 $checkStmt->execute([$donemAdi]);\r\n                 \r\n                 if ($checkStmt->fetch()) {\r\n@@ -69,9 +69,9 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n-                $sql = \"INSERT INTO bayi_hakedis_prim_donem (donem_adi, baslangic_tarihi, bitis_tarihi, durum, olusturma_tarihi, olusturan) \r\n+                $sql = \"INSERT INTO digiturk.bayi_hakedis_prim_donem (donem_adi, baslangic_tarihi, bitis_tarihi, durum, olusturma_tarihi, olusturan) \r\n                         VALUES (?, ?, ?, ?, GETDATE(), ?)\";\r\n                 $stmt = $conn->prepare($sql);\r\n                 $stmt->execute([$donemAdi, $baslangicTarihi, $bitisTarihi, $durum, $currentUser['id']]);\r\n                 \r\n@@ -117,9 +117,9 @@\n                     break;\r\n                 }\r\n                 \r\n                 // Dönem adı kontrolü (mevcut kayıt hariç)\r\n-                $checkSql = \"SELECT id FROM bayi_hakedis_prim_donem WHERE donem_adi = ? AND id != ?\";\r\n+                $checkSql = \"SELECT id FROM digiturk.bayi_hakedis_prim_donem WHERE donem_adi = ? AND id != ?\";\r\n                 $checkStmt = $conn->prepare($checkSql);\r\n                 $checkStmt->execute([$donemAdi, $id]);\r\n                 \r\n                 if ($checkStmt->fetch()) {\r\n@@ -127,9 +127,9 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n-                $sql = \"UPDATE bayi_hakedis_prim_donem SET donem_adi = ?, baslangic_tarihi = ?, bitis_tarihi = ?, durum = ?, \r\n+                $sql = \"UPDATE digiturk.bayi_hakedis_prim_donem SET donem_adi = ?, baslangic_tarihi = ?, bitis_tarihi = ?, durum = ?, \r\n                         guncelleme_tarihi = GETDATE(), guncelleyen = ? WHERE id = ?\";\r\n                 $stmt = $conn->prepare($sql);\r\n                 $stmt->execute([$donemAdi, $baslangicTarihi, $bitisTarihi, $durum, $currentUser['id'], $id]);\r\n                 \r\n@@ -145,9 +145,9 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n-                $sql = \"DELETE FROM bayi_hakedis_prim_donem WHERE id = ?\";\r\n+                $sql = \"DELETE FROM digiturk.bayi_hakedis_prim_donem WHERE id = ?\";\r\n                 $stmt = $conn->prepare($sql);\r\n                 $stmt->execute([$id]);\r\n                 \r\n                 $message = 'Dönem kaydı başarıyla silindi.';\r\n@@ -175,9 +175,9 @@\n     $sql = \"SELECT d.id, d.donem_adi, d.baslangic_tarihi, d.bitis_tarihi, d.durum, \r\n                    d.olusturma_tarihi, d.guncelleme_tarihi,\r\n                    u1.first_name + ' ' + u1.last_name as olusturan_adi,\r\n                    u2.first_name + ' ' + u2.last_name as guncelleyen_adi\r\n-            FROM bayi_hakedis_prim_donem d \r\n+            FROM digiturk.bayi_hakedis_prim_donem d \r\n             LEFT JOIN users u1 ON d.olusturan = u1.id\r\n             LEFT JOIN users u2 ON d.guncelleyen = u2.id\r\n             ORDER BY d.olusturma_tarihi DESC\";\r\n     $stmt = $conn->prepare($sql);\r\n"
                }
            ],
            "date": 1759394667448,
            "name": "Commit-0",
            "content": "<?php\r\n// Enable error reporting for debugging\r\nini_set('display_errors', 1);\r\nini_set('display_startup_errors', 1);\r\nerror_reporting(E_ALL);\r\n\r\n$pageTitle = \"Bayi Hakedis Prim Dönem Tanımlama\";\r\n$breadcrumbs = [\r\n    ['title' => 'Bayi Hakedis Prim Dönem Tanımlama']\r\n];\r\n\r\n// Auth kontrol\r\ntry {\r\n    require_once 'auth.php';\r\n    $currentUser = checkAdminAuth(); // Sadece admin erişebilir\r\n} catch (Exception $e) {\r\n    die(\"Auth hatası: \" . $e->getMessage());\r\n}\r\n\r\n$message = '';\r\n$messageType = '';\r\n\r\n// Dönem işlemleri\r\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\r\n    try {\r\n        $conn = getDatabaseConnection();\r\n        \r\n        $action = $_POST['action'] ?? '';\r\n        \r\n        switch ($action) {\r\n            case 'add':\r\n                $donemAdi = trim($_POST['donem_adi']);\r\n                $baslangicTarihi = trim($_POST['baslangic_tarihi']);\r\n                $bitisTarihi = trim($_POST['bitis_tarihi']);\r\n                $durum = $_POST['durum'] ?? 'AKTIF';\r\n                \r\n                if (empty($donemAdi)) {\r\n                    $message = 'Dönem adı alanı zorunludur.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                if (empty($baslangicTarihi)) {\r\n                    $message = 'Başlangıç tarihi alanı zorunludur.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                if (empty($bitisTarihi)) {\r\n                    $message = 'Bitiş tarihi alanı zorunludur.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                // Tarih kontrolü\r\n                if (strtotime($baslangicTarihi) >= strtotime($bitisTarihi)) {\r\n                    $message = 'Başlangıç tarihi bitiş tarihinden önce olmalıdır.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                // Dönem adı kontrolü\r\n                $checkSql = \"SELECT id FROM bayi_hakedis_prim_donem WHERE donem_adi = ?\";\r\n                $checkStmt = $conn->prepare($checkSql);\r\n                $checkStmt->execute([$donemAdi]);\r\n                \r\n                if ($checkStmt->fetch()) {\r\n                    $message = 'Bu dönem adı zaten kullanılmaktadır.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                $sql = \"INSERT INTO bayi_hakedis_prim_donem (donem_adi, baslangic_tarihi, bitis_tarihi, durum, olusturma_tarihi, olusturan) \r\n                        VALUES (?, ?, ?, ?, GETDATE(), ?)\";\r\n                $stmt = $conn->prepare($sql);\r\n                $stmt->execute([$donemAdi, $baslangicTarihi, $bitisTarihi, $durum, $currentUser['id']]);\r\n                \r\n                $message = 'Dönem başarıyla tanımlandı.';\r\n                $messageType = 'success';\r\n                break;\r\n                \r\n            case 'edit':\r\n                $id = (int)$_POST['id'];\r\n                $donemAdi = trim($_POST['donem_adi']);\r\n                $baslangicTarihi = trim($_POST['baslangic_tarihi']);\r\n                $bitisTarihi = trim($_POST['bitis_tarihi']);\r\n                $durum = $_POST['durum'] ?? 'AKTIF';\r\n                \r\n                if ($id <= 0) {\r\n                    $message = 'Geçersiz ID.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                if (empty($donemAdi)) {\r\n                    $message = 'Dönem adı alanı zorunludur.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                if (empty($baslangicTarihi)) {\r\n                    $message = 'Başlangıç tarihi alanı zorunludur.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                if (empty($bitisTarihi)) {\r\n                    $message = 'Bitiş tarihi alanı zorunludur.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                // Tarih kontrolü\r\n                if (strtotime($baslangicTarihi) >= strtotime($bitisTarihi)) {\r\n                    $message = 'Başlangıç tarihi bitiş tarihinden önce olmalıdır.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                // Dönem adı kontrolü (mevcut kayıt hariç)\r\n                $checkSql = \"SELECT id FROM bayi_hakedis_prim_donem WHERE donem_adi = ? AND id != ?\";\r\n                $checkStmt = $conn->prepare($checkSql);\r\n                $checkStmt->execute([$donemAdi, $id]);\r\n                \r\n                if ($checkStmt->fetch()) {\r\n                    $message = 'Bu dönem adı başka bir kayıtta kullanılmaktadır.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                $sql = \"UPDATE bayi_hakedis_prim_donem SET donem_adi = ?, baslangic_tarihi = ?, bitis_tarihi = ?, durum = ?, \r\n                        guncelleme_tarihi = GETDATE(), guncelleyen = ? WHERE id = ?\";\r\n                $stmt = $conn->prepare($sql);\r\n                $stmt->execute([$donemAdi, $baslangicTarihi, $bitisTarihi, $durum, $currentUser['id'], $id]);\r\n                \r\n                $message = 'Dönem bilgileri başarıyla güncellendi.';\r\n                $messageType = 'success';\r\n                break;\r\n                \r\n            case 'delete':\r\n                $id = (int)$_POST['id'];\r\n                \r\n                if ($id <= 0) {\r\n                    $message = 'Geçersiz ID.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                $sql = \"DELETE FROM bayi_hakedis_prim_donem WHERE id = ?\";\r\n                $stmt = $conn->prepare($sql);\r\n                $stmt->execute([$id]);\r\n                \r\n                $message = 'Dönem kaydı başarıyla silindi.';\r\n                $messageType = 'success';\r\n                break;\r\n                \r\n            default:\r\n                $message = 'Geçersiz işlem.';\r\n                $messageType = 'danger';\r\n                break;\r\n        }\r\n    } catch (Exception $e) {\r\n        error_log(\"POST operation error: \" . $e->getMessage());\r\n        $message = 'Hata: ' . $e->getMessage();\r\n        $messageType = 'danger';\r\n    }\r\n}\r\n\r\n// Dönemleri listele\r\n$donemler = [];\r\n$error = '';\r\ntry {\r\n    $conn = getDatabaseConnection();\r\n    \r\n    $sql = \"SELECT d.id, d.donem_adi, d.baslangic_tarihi, d.bitis_tarihi, d.durum, \r\n                   d.olusturma_tarihi, d.guncelleme_tarihi,\r\n                   u1.first_name + ' ' + u1.last_name as olusturan_adi,\r\n                   u2.first_name + ' ' + u2.last_name as guncelleyen_adi\r\n            FROM bayi_hakedis_prim_donem d \r\n            LEFT JOIN users u1 ON d.olusturan = u1.id\r\n            LEFT JOIN users u2 ON d.guncelleyen = u2.id\r\n            ORDER BY d.olusturma_tarihi DESC\";\r\n    $stmt = $conn->prepare($sql);\r\n    $stmt->execute();\r\n    $donemler = $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n    \r\n} catch (Exception $e) {\r\n    error_log(\"Error fetching donemler: \" . $e->getMessage());\r\n    $error = \"Veritabanı hatası: \" . $e->getMessage();\r\n}\r\n\r\ntry {\r\n    include 'includes/header.php';\r\n} catch (Exception $e) {\r\n    die(\"Header dosyası yüklenirken hata: \" . $e->getMessage());\r\n}\r\n?>\r\n\r\n<div class=\"container-fluid mt-4\">\r\n    <div class=\"row\">\r\n        <div class=\"col-12\">\r\n            <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n                <h2><i class=\"fas fa-calendar-alt me-2\"></i>Bayi Hakedis Prim Dönem Tanımlama</h2>\r\n                <button class=\"btn btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#addDonemModal\">\r\n                    <i class=\"fas fa-plus me-1\"></i>Yeni Dönem\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <?php if ($message): ?>\r\n        <div class=\"alert alert-<?php echo $messageType; ?> alert-dismissible fade show\" role=\"alert\">\r\n            <i class=\"fas fa-<?php echo $messageType === 'success' ? 'check-circle' : 'exclamation-triangle'; ?> me-2\"></i>\r\n            <?php echo htmlspecialchars($message); ?>\r\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>\r\n        </div>\r\n    <?php endif; ?>\r\n\r\n    <?php if ($error): ?>\r\n        <div class=\"alert alert-danger alert-dismissible fade show\" role=\"alert\">\r\n            <i class=\"fas fa-exclamation-triangle me-2\"></i>\r\n            <?php echo htmlspecialchars($error); ?>\r\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>\r\n        </div>\r\n    <?php endif; ?>\r\n\r\n    <!-- Dönemler Tablosu -->\r\n    <div class=\"card border-0 shadow-sm\">\r\n        <div class=\"card-header bg-primary text-white\">\r\n            <h5 class=\"mb-0\">\r\n                <i class=\"fas fa-list me-2\"></i>Dönem Listesi\r\n            </h5>\r\n        </div>\r\n        <div class=\"card-body p-0\">\r\n            <div class=\"table-responsive\">\r\n                <table class=\"table table-hover mb-0\">\r\n                    <thead class=\"table-light\">\r\n                        <tr>\r\n                            <th>ID</th>\r\n                            <th>Dönem Adı</th>\r\n                            <th>Başlangıç Tarihi</th>\r\n                            <th>Bitiş Tarihi</th>\r\n                            <th>Durum</th>\r\n                            <th>Oluşturan</th>\r\n                            <th>Oluşturma Tarihi</th>\r\n                            <th>Son Güncelleme</th>\r\n                            <th>İşlemler</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <?php if (!empty($donemler)): ?>\r\n                            <?php foreach ($donemler as $donem): ?>\r\n                                <tr>\r\n                                    <td><?php echo $donem['id']; ?></td>\r\n                                    <td>\r\n                                        <strong><?php echo htmlspecialchars($donem['donem_adi']); ?></strong>\r\n                                    </td>\r\n                                    <td>\r\n                                        <?php echo $donem['baslangic_tarihi'] ? date('d.m.Y', strtotime($donem['baslangic_tarihi'])) : '-'; ?>\r\n                                    </td>\r\n                                    <td>\r\n                                        <?php echo $donem['bitis_tarihi'] ? date('d.m.Y', strtotime($donem['bitis_tarihi'])) : '-'; ?>\r\n                                    </td>\r\n                                    <td>\r\n                                        <span class=\"badge bg-<?php echo $donem['durum'] === 'AKTIF' ? 'success' : 'secondary'; ?>\">\r\n                                            <?php echo htmlspecialchars($donem['durum']); ?>\r\n                                        </span>\r\n                                    </td>\r\n                                    <td><?php echo htmlspecialchars($donem['olusturan_adi'] ?? '-'); ?></td>\r\n                                    <td>\r\n                                        <?php echo $donem['olusturma_tarihi'] ? date('d.m.Y H:i', strtotime($donem['olusturma_tarihi'])) : '-'; ?>\r\n                                    </td>\r\n                                    <td>\r\n                                        <?php echo $donem['guncelleme_tarihi'] ? date('d.m.Y H:i', strtotime($donem['guncelleme_tarihi'])) : '-'; ?>\r\n                                        <?php if ($donem['guncelleyen_adi']): ?>\r\n                                            <br><small class=\"text-muted\"><?php echo htmlspecialchars($donem['guncelleyen_adi']); ?></small>\r\n                                        <?php endif; ?>\r\n                                    </td>\r\n                                    <td>\r\n                                        <div class=\"btn-group\" role=\"group\">\r\n                                            <button type=\"button\" class=\"btn btn-sm btn-outline-primary\" \r\n                                                    onclick=\"editDonem(<?php echo htmlspecialchars(json_encode($donem)); ?>)\">\r\n                                                <i class=\"fas fa-edit\"></i>\r\n                                            </button>\r\n                                            <button type=\"button\" class=\"btn btn-sm btn-outline-danger\" \r\n                                                    onclick=\"deleteDonem(<?php echo $donem['id']; ?>, '<?php echo htmlspecialchars($donem['donem_adi']); ?>')\">\r\n                                                <i class=\"fas fa-trash\"></i>\r\n                                            </button>\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n                            <?php endforeach; ?>\r\n                        <?php else: ?>\r\n                            <tr>\r\n                                <td colspan=\"9\" class=\"text-center py-5 text-muted\">\r\n                                    <i class=\"fas fa-calendar-alt fa-3x mb-3 d-block\"></i>\r\n                                    <h5>Henüz dönem tanımlanmamış</h5>\r\n                                    <p>İlk dönemi tanımlamak için \"Yeni Dönem\" butonuna tıklayın.</p>\r\n                                </td>\r\n                            </tr>\r\n                        <?php endif; ?>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- Yeni Dönem Modal -->\r\n<div class=\"modal fade\" id=\"addDonemModal\" tabindex=\"-1\">\r\n    <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n            <form method=\"POST\" action=\"\">\r\n                <input type=\"hidden\" name=\"action\" value=\"add\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">\r\n                        <i class=\"fas fa-calendar-alt me-2\"></i>Yeni Dönem Tanımla\r\n                    </h5>\r\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"add_donem_adi\" class=\"form-label\">Dönem Adı</label>\r\n                        <input type=\"text\" class=\"form-control\" id=\"add_donem_adi\" name=\"donem_adi\" required \r\n                               placeholder=\"Örn: 2025 1. Dönem\">\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"add_baslangic_tarihi\" class=\"form-label\">Başlangıç Tarihi</label>\r\n                                <input type=\"date\" class=\"form-control\" id=\"add_baslangic_tarihi\" name=\"baslangic_tarihi\" required>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"add_bitis_tarihi\" class=\"form-label\">Bitiş Tarihi</label>\r\n                                <input type=\"date\" class=\"form-control\" id=\"add_bitis_tarihi\" name=\"bitis_tarihi\" required>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"add_durum\" class=\"form-label\">Durum</label>\r\n                        <select class=\"form-select\" id=\"add_durum\" name=\"durum\" required>\r\n                            <option value=\"AKTIF\">AKTIF</option>\r\n                            <option value=\"PASIF\">PASIF</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">İptal</button>\r\n                    <button type=\"submit\" class=\"btn btn-primary\">\r\n                        <i class=\"fas fa-save me-1\"></i>Kaydet\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- Dönem Düzenle Modal -->\r\n<div class=\"modal fade\" id=\"editDonemModal\" tabindex=\"-1\">\r\n    <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n            <form method=\"POST\" action=\"\">\r\n                <input type=\"hidden\" name=\"action\" value=\"edit\">\r\n                <input type=\"hidden\" name=\"id\" id=\"edit_id\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">\r\n                        <i class=\"fas fa-edit me-2\"></i>Dönem Düzenle\r\n                    </h5>\r\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"edit_donem_adi\" class=\"form-label\">Dönem Adı</label>\r\n                        <input type=\"text\" class=\"form-control\" id=\"edit_donem_adi\" name=\"donem_adi\" required \r\n                               placeholder=\"Örn: 2025 1. Dönem\">\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"edit_baslangic_tarihi\" class=\"form-label\">Başlangıç Tarihi</label>\r\n                                <input type=\"date\" class=\"form-control\" id=\"edit_baslangic_tarihi\" name=\"baslangic_tarihi\" required>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"edit_bitis_tarihi\" class=\"form-label\">Bitiş Tarihi</label>\r\n                                <input type=\"date\" class=\"form-control\" id=\"edit_bitis_tarihi\" name=\"bitis_tarihi\" required>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"edit_durum\" class=\"form-label\">Durum</label>\r\n                        <select class=\"form-select\" id=\"edit_durum\" name=\"durum\" required>\r\n                            <option value=\"AKTIF\">AKTIF</option>\r\n                            <option value=\"PASIF\">PASIF</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">İptal</button>\r\n                    <button type=\"submit\" class=\"btn btn-primary\">\r\n                        <i class=\"fas fa-save me-1\"></i>Güncelle\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\r\n<script>\r\nfunction editDonem(donem) {\r\n    document.getElementById('edit_id').value = donem.id;\r\n    document.getElementById('edit_donem_adi').value = donem.donem_adi;\r\n    document.getElementById('edit_baslangic_tarihi').value = donem.baslangic_tarihi;\r\n    document.getElementById('edit_bitis_tarihi').value = donem.bitis_tarihi;\r\n    document.getElementById('edit_durum').value = donem.durum;\r\n    \r\n    new bootstrap.Modal(document.getElementById('editDonemModal')).show();\r\n}\r\n\r\nfunction deleteDonem(donemId, donemAdi) {\r\n    if (confirm(donemAdi + ' dönemini silmek istediğinizden emin misiniz?\\n\\nBu işlem geri alınamaz.')) {\r\n        const form = document.createElement('form');\r\n        form.method = 'POST';\r\n        form.innerHTML = `\r\n            <input type=\"hidden\" name=\"action\" value=\"delete\">\r\n            <input type=\"hidden\" name=\"id\" value=\"${donemId}\">\r\n        `;\r\n        document.body.appendChild(form);\r\n        form.submit();\r\n    }\r\n}\r\n\r\n// Modal açıldığında temizle\r\ndocument.getElementById('addDonemModal').addEventListener('show.bs.modal', function () {\r\n    document.getElementById('add_donem_adi').value = '';\r\n    document.getElementById('add_baslangic_tarihi').value = '';\r\n    document.getElementById('add_bitis_tarihi').value = '';\r\n    document.getElementById('add_durum').value = 'AKTIF';\r\n});\r\n\r\n// Tarih validasyonu\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    const baslangicInputs = document.querySelectorAll('[name=\"baslangic_tarihi\"]');\r\n    const bitisInputs = document.querySelectorAll('[name=\"bitis_tarihi\"]');\r\n    \r\n    function validateDates(baslangicInput, bitisInput) {\r\n        if (baslangicInput.value && bitisInput.value) {\r\n            if (new Date(baslangicInput.value) >= new Date(bitisInput.value)) {\r\n                bitisInput.setCustomValidity('Bitiş tarihi başlangıç tarihinden sonra olmalıdır.');\r\n            } else {\r\n                bitisInput.setCustomValidity('');\r\n            }\r\n        }\r\n    }\r\n    \r\n    baslangicInputs.forEach((input, index) => {\r\n        input.addEventListener('change', function() {\r\n            validateDates(this, bitisInputs[index]);\r\n        });\r\n    });\r\n    \r\n    bitisInputs.forEach((input, index) => {\r\n        input.addEventListener('change', function() {\r\n            validateDates(baslangicInputs[index], this);\r\n        });\r\n    });\r\n});\r\n</script>\r\n\r\n<?php include 'includes/footer.php'; ?>"
        }
    ]
}