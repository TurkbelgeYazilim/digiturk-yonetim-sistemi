{
    "sourceFile": "includes/SimpleXLSX.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1760615935595,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1760615935595,
            "name": "Commit-0",
            "content": "<?php\r\n/**\r\n * SimpleXLSX - Basit Excel okuma kütüphanesi\r\n * PhpSpreadsheet alternatifi, daha hafif\r\n */\r\nclass SimpleXLSX {\r\n    private $data = [];\r\n    private static $error = '';\r\n    \r\n    public static function parse($filename) {\r\n        if (!file_exists($filename)) {\r\n            self::$error = 'Dosya bulunamadı';\r\n            return false;\r\n        }\r\n        \r\n        try {\r\n            // ZIP olarak aç (xlsx dosyası aslında bir ZIP arşivi)\r\n            $zip = new ZipArchive();\r\n            if ($zip->open($filename) !== TRUE) {\r\n                self::$error = 'Excel dosyası açılamadı';\r\n                return false;\r\n            }\r\n            \r\n            // shared strings dosyasını oku\r\n            $sharedStrings = [];\r\n            if (($sharedStringsXml = $zip->getFromName('xl/sharedStrings.xml')) !== false) {\r\n                $xml = simplexml_load_string($sharedStringsXml);\r\n                if ($xml) {\r\n                    foreach ($xml->si as $si) {\r\n                        $sharedStrings[] = (string)$si->t;\r\n                    }\r\n                }\r\n            }\r\n            \r\n            // worksheet'i oku\r\n            $worksheetXml = $zip->getFromName('xl/worksheets/sheet1.xml');\r\n            if ($worksheetXml === false) {\r\n                self::$error = 'Worksheet okunamadı';\r\n                $zip->close();\r\n                return false;\r\n            }\r\n            \r\n            $xml = simplexml_load_string($worksheetXml);\r\n            if (!$xml) {\r\n                self::$error = 'XML parse hatası';\r\n                $zip->close();\r\n                return false;\r\n            }\r\n            \r\n            $zip->close();\r\n            \r\n            $instance = new self();\r\n            $instance->parseWorksheet($xml, $sharedStrings);\r\n            \r\n            return $instance;\r\n            \r\n        } catch (Exception $e) {\r\n            self::$error = $e->getMessage();\r\n            return false;\r\n        }\r\n    }\r\n    \r\n    private function parseWorksheet($xml, $sharedStrings) {\r\n        $rows = [];\r\n        \r\n        if (isset($xml->sheetData->row)) {\r\n            foreach ($xml->sheetData->row as $row) {\r\n                $rowData = [];\r\n                $colIndex = 0;\r\n                \r\n                if (isset($row->c)) {\r\n                    foreach ($row->c as $cell) {\r\n                        $cellValue = '';\r\n                        \r\n                        // Hücre referansından sütun indexini al\r\n                        $cellRef = (string)$cell['r'];\r\n                        preg_match('/([A-Z]+)/', $cellRef, $matches);\r\n                        if (isset($matches[1])) {\r\n                            $colIndex = $this->columnIndexFromString($matches[1]);\r\n                        }\r\n                        \r\n                        // Hücre değerini al\r\n                        if (isset($cell->v)) {\r\n                            $cellValue = (string)$cell->v;\r\n                            \r\n                            // Eğer tip shared string ise, shared strings'den al\r\n                            if (isset($cell['t']) && (string)$cell['t'] === 's') {\r\n                                $index = (int)$cellValue;\r\n                                if (isset($sharedStrings[$index])) {\r\n                                    $cellValue = $sharedStrings[$index];\r\n                                }\r\n                            }\r\n                        }\r\n                        \r\n                        // Row array'ini genişlet\r\n                        while (count($rowData) <= $colIndex) {\r\n                            $rowData[] = '';\r\n                        }\r\n                        \r\n                        $rowData[$colIndex] = $cellValue;\r\n                    }\r\n                }\r\n                \r\n                $rows[] = $rowData;\r\n            }\r\n        }\r\n        \r\n        $this->data = $rows;\r\n    }\r\n    \r\n    private function columnIndexFromString($column) {\r\n        $index = 0;\r\n        $length = strlen($column);\r\n        \r\n        for ($i = 0; $i < $length; $i++) {\r\n            $index = $index * 26 + (ord($column[$i]) - ord('A'));\r\n        }\r\n        \r\n        return $index;\r\n    }\r\n    \r\n    public function rows() {\r\n        return $this->data;\r\n    }\r\n    \r\n    public static function parseError() {\r\n        return self::$error;\r\n    }\r\n}\r\n?>"
        }
    ]
}