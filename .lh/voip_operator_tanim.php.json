{
    "sourceFile": "voip_operator_tanim.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1760602699215,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1760605550310,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -378,9 +378,9 @@\n                     <div class=\"row\">\r\n                         <div class=\"col-md-6\">\r\n                             <div class=\"mb-3\">\r\n                                 <label for=\"voip_operator_link\" class=\"form-label\">Link (URL)</label>\r\n-                                <input type=\"text\" class=\"form-control\" id=\"voip_operator_link\" name=\"voip_operator_link\" maxlength=\"20\">\r\n+                                <input type=\"text\" class=\"form-control\" id=\"voip_operator_link\" name=\"voip_operator_link\" maxlength=\"100\">\r\n                             </div>\r\n                         </div>\r\n                         <div class=\"col-md-6\">\r\n                             <div class=\"mb-3\">\r\n@@ -498,9 +498,9 @@\n                     <div class=\"row\">\r\n                         <div class=\"col-md-6\">\r\n                             <div class=\"mb-3\">\r\n                                 <label for=\"edit_voip_operator_link\" class=\"form-label\">Link (URL)</label>\r\n-                                <input type=\"text\" class=\"form-control\" id=\"edit_voip_operator_link\" name=\"voip_operator_link\" maxlength=\"20\">\r\n+                                <input type=\"text\" class=\"form-control\" id=\"edit_voip_operator_link\" name=\"voip_operator_link\" maxlength=\"100\">\r\n                             </div>\r\n                         </div>\r\n                         <div class=\"col-md-6\">\r\n                             <div class=\"mb-3\">\r\n"
                }
            ],
            "date": 1760602699215,
            "name": "Commit-0",
            "content": "<?php\r\n$pageTitle = \"VoIP Operatör Tanımlama\";\r\n$breadcrumbs = [\r\n    ['title' => 'Yönetim', 'url' => 'index.php'],\r\n    ['title' => 'VoIP', 'url' => '#'],\r\n    ['title' => 'VoIP Operatör Tanımlama']\r\n];\r\n\r\n// Auth kontrol\r\nrequire_once 'auth.php';\r\n$currentUser = checkAdminAuth(); // Sadece admin erişebilir\r\n\r\n$message = '';\r\n$messageType = '';\r\n\r\n// VoIP Operatör işlemleri\r\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\r\n    try {\r\n        $conn = getDatabaseConnection();\r\n        \r\n        $action = $_POST['action'] ?? '';\r\n        \r\n        switch ($action) {\r\n            case 'add':\r\n                $operatorAdi = trim($_POST['voip_operator_adi']);\r\n                $operatorAciklama = trim($_POST['voip_operator_aciklama']);\r\n                $operatorKanalSayisi = $_POST['voip_operator_kanalSayisi'] ? (int)$_POST['voip_operator_kanalSayisi'] : null;\r\n                $operatorCPS = $_POST['voip_operator_CPS'] ? (int)$_POST['voip_operator_CPS'] : null;\r\n                $operatorLink = trim($_POST['voip_operator_link']);\r\n                $operatorIP = trim($_POST['voip_operator_IP']);\r\n                $operatorKullanici = trim($_POST['voip_operator_kullanici']);\r\n                $operatorSifre = trim($_POST['voip_operator_sifre']);\r\n                $operatorTrunk = $_POST['voip_operator_trunk'] ? (int)$_POST['voip_operator_trunk'] : 0;\r\n                $operatorDurum = isset($_POST['voip_operator_durum']) ? 1 : 0;\r\n                $operatorUsersId = (int)$_POST['voip_operator_users_id'];\r\n                \r\n                $sql = \"INSERT INTO voip_operator_tanim \r\n                        (voip_operator_users_id, voip_operator_adi, voip_operator_aciklama, \r\n                         voip_operator_kanalSayisi, voip_operator_CPS, voip_operator_link, \r\n                         voip_operator_IP, voip_operator_kullanici, voip_operator_sifre, voip_operator_trunk, \r\n                         voip_operator_durum) \r\n                        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\";\r\n                $stmt = $conn->prepare($sql);\r\n                $stmt->execute([$operatorUsersId, $operatorAdi, $operatorAciklama, \r\n                               $operatorKanalSayisi, $operatorCPS, $operatorLink, \r\n                               $operatorIP, $operatorKullanici, $operatorSifre, $operatorTrunk, $operatorDurum]);\r\n                \r\n                $message = 'VoIP Operatör başarıyla eklendi.';\r\n                $messageType = 'success';\r\n                break;\r\n                \r\n            case 'edit':\r\n                $id = (int)$_POST['voip_operator_id'];\r\n                $operatorAdi = trim($_POST['voip_operator_adi']);\r\n                $operatorAciklama = trim($_POST['voip_operator_aciklama']);\r\n                $operatorKanalSayisi = $_POST['voip_operator_kanalSayisi'] ? (int)$_POST['voip_operator_kanalSayisi'] : null;\r\n                $operatorCPS = $_POST['voip_operator_CPS'] ? (int)$_POST['voip_operator_CPS'] : null;\r\n                $operatorLink = trim($_POST['voip_operator_link']);\r\n                $operatorIP = trim($_POST['voip_operator_IP']);\r\n                $operatorKullanici = trim($_POST['voip_operator_kullanici']);\r\n                $operatorSifre = trim($_POST['voip_operator_sifre']);\r\n                $operatorTrunk = $_POST['voip_operator_trunk'] ? (int)$_POST['voip_operator_trunk'] : 0;\r\n                $operatorDurum = isset($_POST['voip_operator_durum']) ? 1 : 0;\r\n                $operatorUsersId = (int)$_POST['voip_operator_users_id'];\r\n                \r\n                $sql = \"UPDATE voip_operator_tanim SET \r\n                        voip_operator_users_id = ?, voip_operator_adi = ?, voip_operator_aciklama = ?, \r\n                        voip_operator_kanalSayisi = ?, voip_operator_CPS = ?, voip_operator_link = ?, \r\n                        voip_operator_IP = ?, voip_operator_kullanici = ?, voip_operator_sifre = ?, voip_operator_trunk = ?, \r\n                        voip_operator_durum = ? \r\n                        WHERE voip_operator_id = ?\";\r\n                $stmt = $conn->prepare($sql);\r\n                $stmt->execute([$operatorUsersId, $operatorAdi, $operatorAciklama, \r\n                               $operatorKanalSayisi, $operatorCPS, $operatorLink, \r\n                               $operatorIP, $operatorKullanici, $operatorSifre, $operatorTrunk, $operatorDurum, $id]);\r\n                \r\n                $message = 'VoIP Operatör başarıyla güncellendi.';\r\n                $messageType = 'success';\r\n                break;\r\n                \r\n            case 'delete':\r\n                $id = (int)$_POST['id'];\r\n                \r\n                $sql = \"DELETE FROM voip_operator_tanim WHERE voip_operator_id = ?\";\r\n                $stmt = $conn->prepare($sql);\r\n                $stmt->execute([$id]);\r\n                \r\n                $message = 'VoIP Operatör başarıyla silindi.';\r\n                $messageType = 'success';\r\n                break;\r\n        }\r\n    } catch (Exception $e) {\r\n        $message = 'Hata: ' . $e->getMessage();\r\n        $messageType = 'danger';\r\n    }\r\n}\r\n\r\n// Kullanıcıları al\r\ntry {\r\n    $conn = getDatabaseConnection();\r\n    \r\n    $userSql = \"SELECT id, first_name, last_name, email FROM users WHERE status = 'AKTIF' ORDER BY first_name, last_name\";\r\n    $userStmt = $conn->prepare($userSql);\r\n    $userStmt->execute();\r\n    $users = $userStmt->fetchAll(PDO::FETCH_ASSOC);\r\n    \r\n} catch (Exception $e) {\r\n    $users = [];\r\n}\r\n\r\n// Filtreleme parametrelerini al\r\n$filterUser = $_GET['filter_user'] ?? '';\r\n$filterDurum = $_GET['filter_durum'] ?? '';\r\n$filterTrunk = $_GET['filter_trunk'] ?? '';\r\n\r\n// VoIP Operatörlerini listele\r\n$voipOperators = [];\r\n$error = '';\r\ntry {\r\n    $conn = getDatabaseConnection();\r\n    \r\n    $whereConditions = [];\r\n    $params = [];\r\n    \r\n    if ($filterUser) {\r\n        $whereConditions[] = \"v.voip_operator_users_id = ?\";\r\n        $params[] = $filterUser;\r\n    }\r\n    \r\n    if ($filterDurum !== '') {\r\n        $whereConditions[] = \"v.voip_operator_durum = ?\";\r\n        $params[] = $filterDurum;\r\n    }\r\n    \r\n    if ($filterTrunk !== '') {\r\n        $whereConditions[] = \"v.voip_operator_trunk = ?\";\r\n        $params[] = $filterTrunk;\r\n    }\r\n    \r\n    $whereClause = !empty($whereConditions) ? 'WHERE ' . implode(' AND ', $whereConditions) : '';\r\n    \r\n    $sql = \"SELECT v.*, u.first_name, u.last_name, u.email\r\n            FROM voip_operator_tanim v \r\n            LEFT JOIN users u ON v.voip_operator_users_id = u.id\r\n            $whereClause\r\n            ORDER BY v.voip_operator_olusturmaTarihi DESC\";\r\n    $stmt = $conn->prepare($sql);\r\n    $stmt->execute($params);\r\n    $voipOperators = $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n    \r\n} catch (Exception $e) {\r\n    $error = \"Veritabanı hatası: \" . $e->getMessage();\r\n}\r\n\r\ninclude 'includes/header.php';\r\n?>\r\n\r\n<div class=\"container-fluid mt-4\">\r\n    <div class=\"row\">\r\n        <div class=\"col-12\">\r\n            <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n                <h2><i class=\"fas fa-headset me-2\"></i>VoIP Operatör Tanımlama</h2>\r\n                <button class=\"btn btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#addOperatorModal\">\r\n                    <i class=\"fas fa-plus me-1\"></i>Yeni Operatör\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <?php if ($message): ?>\r\n        <div class=\"alert alert-<?php echo $messageType; ?> alert-dismissible fade show\" role=\"alert\">\r\n            <i class=\"fas fa-<?php echo $messageType === 'success' ? 'check-circle' : 'exclamation-triangle'; ?> me-2\"></i>\r\n            <?php echo htmlspecialchars($message); ?>\r\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>\r\n        </div>\r\n    <?php endif; ?>\r\n\r\n    <?php if ($error): ?>\r\n        <div class=\"alert alert-danger alert-dismissible fade show\" role=\"alert\">\r\n            <i class=\"fas fa-exclamation-triangle me-2\"></i>\r\n            <?php echo htmlspecialchars($error); ?>\r\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>\r\n        </div>\r\n    <?php endif; ?>\r\n\r\n    <!-- Filtreleme -->\r\n    <div class=\"card border-0 shadow-sm mb-4\">\r\n        <div class=\"card-header bg-light\">\r\n            <h5 class=\"mb-0\">\r\n                <i class=\"fas fa-filter me-2\"></i>Filtreleme\r\n            </h5>\r\n        </div>\r\n        <div class=\"card-body\">\r\n            <form method=\"GET\" class=\"row g-3\">\r\n                <div class=\"col-md-4\">\r\n                    <label class=\"form-label\">Kullanıcı</label>\r\n                    <select name=\"filter_user\" class=\"form-select\">\r\n                        <option value=\"\">Tümü</option>\r\n                        <?php foreach ($users as $user): ?>\r\n                            <option value=\"<?php echo $user['id']; ?>\" <?php echo $filterUser == $user['id'] ? 'selected' : ''; ?>>\r\n                                <?php echo htmlspecialchars($user['first_name'] . ' ' . $user['last_name']); ?>\r\n                            </option>\r\n                        <?php endforeach; ?>\r\n                    </select>\r\n                </div>\r\n                <div class=\"col-md-3\">\r\n                    <label class=\"form-label\">Durum</label>\r\n                    <select name=\"filter_durum\" class=\"form-select\">\r\n                        <option value=\"\">Tümü</option>\r\n                        <option value=\"1\" <?php echo $filterDurum === '1' ? 'selected' : ''; ?>>Aktif</option>\r\n                        <option value=\"0\" <?php echo $filterDurum === '0' ? 'selected' : ''; ?>>Pasif</option>\r\n                    </select>\r\n                </div>\r\n                <div class=\"col-md-3\">\r\n                    <label class=\"form-label\">Trunk Tipi</label>\r\n                    <select name=\"filter_trunk\" class=\"form-select\">\r\n                        <option value=\"\">Tümü</option>\r\n                        <option value=\"0\" <?php echo $filterTrunk === '0' ? 'selected' : ''; ?>>SIP</option>\r\n                        <option value=\"1\" <?php echo $filterTrunk === '1' ? 'selected' : ''; ?>>IP Register</option>\r\n                    </select>\r\n                </div>\r\n                <div class=\"col-md-2\">\r\n                    <label class=\"form-label\">&nbsp;</label>\r\n                    <div class=\"d-grid\">\r\n                        <button type=\"submit\" class=\"btn btn-primary\">\r\n                            <i class=\"fas fa-search me-1\"></i>Filtrele\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- VoIP Operatörler Tablosu -->\r\n    <div class=\"card border-0 shadow-sm\">\r\n        <div class=\"card-header bg-primary text-white\">\r\n            <h5 class=\"mb-0\">\r\n                <i class=\"fas fa-list me-2\"></i>VoIP Operatör Listesi\r\n            </h5>\r\n        </div>\r\n        <div class=\"card-body p-0\">\r\n            <div class=\"table-responsive\">\r\n                <table class=\"table table-hover mb-0\">\r\n                    <thead class=\"table-light\">\r\n                        <tr>\r\n                            <th>ID</th>\r\n                            <th>Operatör Adı</th>\r\n                            <th>Kullanıcı</th>\r\n                            <th>Açıklama</th>\r\n                            <th>Kanal Sayısı</th>\r\n                            <th>CPS</th>\r\n                            <th>Link</th>\r\n                            <th>IP Adres</th>\r\n                            <th>Trunk</th>\r\n                            <th>Durum</th>\r\n                            <th>Oluşturma Tarihi</th>\r\n                            <th>İşlemler</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <?php if (!empty($voipOperators)): ?>\r\n                            <?php foreach ($voipOperators as $operator): ?>\r\n                                <tr>\r\n                                    <td><?php echo $operator['voip_operator_id']; ?></td>\r\n                                    <td><strong><?php echo htmlspecialchars($operator['voip_operator_adi']); ?></strong></td>\r\n                                    <td>\r\n                                        <?php if ($operator['first_name']): ?>\r\n                                            <?php echo htmlspecialchars($operator['first_name'] . ' ' . $operator['last_name']); ?>\r\n                                            <br><small class=\"text-muted\"><?php echo htmlspecialchars($operator['email']); ?></small>\r\n                                        <?php else: ?>\r\n                                            <span class=\"text-muted\">Kullanıcı bulunamadı</span>\r\n                                        <?php endif; ?>\r\n                                    </td>\r\n                                    <td><?php echo htmlspecialchars($operator['voip_operator_aciklama'] ?? '-'); ?></td>\r\n                                    <td><?php echo $operator['voip_operator_kanalSayisi'] ?? '-'; ?></td>\r\n                                    <td><?php echo $operator['voip_operator_CPS'] ?? '-'; ?></td>\r\n                                    <td><?php echo htmlspecialchars($operator['voip_operator_link'] ?? '-'); ?></td>\r\n                                    <td><?php echo htmlspecialchars($operator['voip_operator_IP'] ?? '-'); ?></td>\r\n                                    <td>\r\n                                        <span class=\"badge <?php echo $operator['voip_operator_trunk'] ? 'bg-info' : 'bg-secondary'; ?>\">\r\n                                            <?php echo $operator['voip_operator_trunk'] ? 'IP Register' : 'SIP'; ?>\r\n                                        </span>\r\n                                    </td>\r\n                                    <td>\r\n                                        <span class=\"badge <?php echo $operator['voip_operator_durum'] ? 'bg-success' : 'bg-danger'; ?>\">\r\n                                            <?php echo $operator['voip_operator_durum'] ? 'Aktif' : 'Pasif'; ?>\r\n                                        </span>\r\n                                    </td>\r\n                                    <td>\r\n                                        <?php echo $operator['voip_operator_olusturmaTarihi'] ? date('d.m.Y', strtotime($operator['voip_operator_olusturmaTarihi'])) : '-'; ?>\r\n                                    </td>\r\n                                    <td>\r\n                                        <div class=\"btn-group\" role=\"group\">\r\n                                            <button type=\"button\" class=\"btn btn-sm btn-outline-primary\" \r\n                                                    onclick=\"editOperator(<?php echo htmlspecialchars(json_encode($operator)); ?>)\">\r\n                                                <i class=\"fas fa-edit\"></i>\r\n                                            </button>\r\n                                            <button type=\"button\" class=\"btn btn-sm btn-outline-danger\" \r\n                                                    onclick=\"deleteOperator(<?php echo $operator['voip_operator_id']; ?>, '<?php echo htmlspecialchars($operator['voip_operator_adi']); ?>')\">\r\n                                                <i class=\"fas fa-trash\"></i>\r\n                                            </button>\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n                            <?php endforeach; ?>\r\n                        <?php else: ?>\r\n                            <tr>\r\n                                <td colspan=\"12\" class=\"text-center py-5 text-muted\">\r\n                                    <i class=\"fas fa-headset fa-3x mb-3 d-block\"></i>\r\n                                    <h5>Henüz VoIP operatör bulunmuyor</h5>\r\n                                    <p>İlk operatörü eklemek için \"Yeni Operatör\" butonuna tıklayın.</p>\r\n                                </td>\r\n                            </tr>\r\n                        <?php endif; ?>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- Yeni Operatör Ekleme Modal -->\r\n<div class=\"modal fade\" id=\"addOperatorModal\" tabindex=\"-1\" aria-labelledby=\"addOperatorModalLabel\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog modal-lg\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h5 class=\"modal-title\" id=\"addOperatorModalLabel\">\r\n                    <i class=\"fas fa-plus me-2\"></i>Yeni VoIP Operatör Ekle\r\n                </h5>\r\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n            </div>\r\n            <form method=\"POST\">\r\n                <div class=\"modal-body\">\r\n                    <input type=\"hidden\" name=\"action\" value=\"add\">\r\n                    \r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"voip_operator_adi\" class=\"form-label\">Operatör Adı <span class=\"text-danger\">*</span></label>\r\n                                <input type=\"text\" class=\"form-control\" id=\"voip_operator_adi\" name=\"voip_operator_adi\" maxlength=\"20\" required>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"voip_operator_users_id\" class=\"form-label\">Kullanıcı <span class=\"text-danger\">*</span></label>\r\n                                <select class=\"form-select\" id=\"voip_operator_users_id\" name=\"voip_operator_users_id\" required>\r\n                                    <option value=\"\">Seçiniz...</option>\r\n                                    <?php foreach ($users as $user): ?>\r\n                                        <option value=\"<?php echo $user['id']; ?>\">\r\n                                            <?php echo htmlspecialchars($user['first_name'] . ' ' . $user['last_name']); ?>\r\n                                        </option>\r\n                                    <?php endforeach; ?>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"mb-3\">\r\n                        <label for=\"voip_operator_aciklama\" class=\"form-label\">Açıklama</label>\r\n                        <textarea class=\"form-control\" id=\"voip_operator_aciklama\" name=\"voip_operator_aciklama\" maxlength=\"100\" rows=\"2\"></textarea>\r\n                    </div>\r\n                    \r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-4\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"voip_operator_kanalSayisi\" class=\"form-label\">Kanal Sayısı</label>\r\n                                <input type=\"number\" class=\"form-control\" id=\"voip_operator_kanalSayisi\" name=\"voip_operator_kanalSayisi\" min=\"1\">\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-4\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"voip_operator_CPS\" class=\"form-label\">CPS</label>\r\n                                <input type=\"number\" class=\"form-control\" id=\"voip_operator_CPS\" name=\"voip_operator_CPS\" min=\"1\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"voip_operator_link\" class=\"form-label\">Link (URL)</label>\r\n                                <input type=\"text\" class=\"form-control\" id=\"voip_operator_link\" name=\"voip_operator_link\" maxlength=\"20\">\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"voip_operator_IP\" class=\"form-label\">IP Adres</label>\r\n                                <input type=\"text\" class=\"form-control\" id=\"voip_operator_IP\" name=\"voip_operator_IP\" maxlength=\"50\" placeholder=\"örn: 192.168.1.1\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"voip_operator_kullanici\" class=\"form-label\">Kullanıcı Adı</label>\r\n                                <input type=\"text\" class=\"form-control\" id=\"voip_operator_kullanici\" name=\"voip_operator_kullanici\" maxlength=\"20\">\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"voip_operator_sifre\" class=\"form-label\">Şifre</label>\r\n                                <input type=\"password\" class=\"form-control\" id=\"voip_operator_sifre\" name=\"voip_operator_sifre\" maxlength=\"20\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"voip_operator_trunk\" class=\"form-label\">Trunk Tipi</label>\r\n                                <select class=\"form-select\" id=\"voip_operator_trunk\" name=\"voip_operator_trunk\">\r\n                                    <option value=\"0\">SIP</option>\r\n                                    <option value=\"1\">IP Register</option>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <div class=\"form-check mt-4\">\r\n                                    <input class=\"form-check-input\" type=\"checkbox\" id=\"voip_operator_durum\" name=\"voip_operator_durum\" checked>\r\n                                    <label class=\"form-check-label\" for=\"voip_operator_durum\">\r\n                                        Aktif\r\n                                    </label>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">İptal</button>\r\n                    <button type=\"submit\" class=\"btn btn-primary\">\r\n                        <i class=\"fas fa-save me-1\"></i>Kaydet\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- Operatör Düzenleme Modal -->\r\n<div class=\"modal fade\" id=\"editOperatorModal\" tabindex=\"-1\" aria-labelledby=\"editOperatorModalLabel\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog modal-lg\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h5 class=\"modal-title\" id=\"editOperatorModalLabel\">\r\n                    <i class=\"fas fa-edit me-2\"></i>VoIP Operatör Düzenle\r\n                </h5>\r\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n            </div>\r\n            <form method=\"POST\" id=\"editOperatorForm\">\r\n                <div class=\"modal-body\">\r\n                    <input type=\"hidden\" name=\"action\" value=\"edit\">\r\n                    <input type=\"hidden\" name=\"voip_operator_id\" id=\"edit_voip_operator_id\">\r\n                    \r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"edit_voip_operator_adi\" class=\"form-label\">Operatör Adı <span class=\"text-danger\">*</span></label>\r\n                                <input type=\"text\" class=\"form-control\" id=\"edit_voip_operator_adi\" name=\"voip_operator_adi\" maxlength=\"20\" required>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"edit_voip_operator_users_id\" class=\"form-label\">Kullanıcı <span class=\"text-danger\">*</span></label>\r\n                                <select class=\"form-select\" id=\"edit_voip_operator_users_id\" name=\"voip_operator_users_id\" required>\r\n                                    <option value=\"\">Seçiniz...</option>\r\n                                    <?php foreach ($users as $user): ?>\r\n                                        <option value=\"<?php echo $user['id']; ?>\">\r\n                                            <?php echo htmlspecialchars($user['first_name'] . ' ' . $user['last_name']); ?>\r\n                                        </option>\r\n                                    <?php endforeach; ?>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"mb-3\">\r\n                        <label for=\"edit_voip_operator_aciklama\" class=\"form-label\">Açıklama</label>\r\n                        <textarea class=\"form-control\" id=\"edit_voip_operator_aciklama\" name=\"voip_operator_aciklama\" maxlength=\"100\" rows=\"2\"></textarea>\r\n                    </div>\r\n                    \r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-4\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"edit_voip_operator_kanalSayisi\" class=\"form-label\">Kanal Sayısı</label>\r\n                                <input type=\"number\" class=\"form-control\" id=\"edit_voip_operator_kanalSayisi\" name=\"voip_operator_kanalSayisi\" min=\"1\">\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-4\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"edit_voip_operator_CPS\" class=\"form-label\">CPS</label>\r\n                                <input type=\"number\" class=\"form-control\" id=\"edit_voip_operator_CPS\" name=\"voip_operator_CPS\" min=\"1\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"edit_voip_operator_link\" class=\"form-label\">Link (URL)</label>\r\n                                <input type=\"text\" class=\"form-control\" id=\"edit_voip_operator_link\" name=\"voip_operator_link\" maxlength=\"20\">\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"edit_voip_operator_IP\" class=\"form-label\">IP Adres</label>\r\n                                <input type=\"text\" class=\"form-control\" id=\"edit_voip_operator_IP\" name=\"voip_operator_IP\" maxlength=\"50\" placeholder=\"örn: 192.168.1.1\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"edit_voip_operator_kullanici\" class=\"form-label\">Kullanıcı Adı</label>\r\n                                <input type=\"text\" class=\"form-control\" id=\"edit_voip_operator_kullanici\" name=\"voip_operator_kullanici\" maxlength=\"20\">\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"edit_voip_operator_sifre\" class=\"form-label\">Şifre</label>\r\n                                <input type=\"password\" class=\"form-control\" id=\"edit_voip_operator_sifre\" name=\"voip_operator_sifre\" maxlength=\"20\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <label for=\"edit_voip_operator_trunk\" class=\"form-label\">Trunk Tipi</label>\r\n                                <select class=\"form-select\" id=\"edit_voip_operator_trunk\" name=\"voip_operator_trunk\">\r\n                                    <option value=\"0\">SIP</option>\r\n                                    <option value=\"1\">IP Register</option>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"mb-3\">\r\n                                <div class=\"form-check mt-4\">\r\n                                    <input class=\"form-check-input\" type=\"checkbox\" id=\"edit_voip_operator_durum\" name=\"voip_operator_durum\">\r\n                                    <label class=\"form-check-label\" for=\"edit_voip_operator_durum\">\r\n                                        Aktif\r\n                                    </label>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">İptal</button>\r\n                    <button type=\"submit\" class=\"btn btn-primary\">\r\n                        <i class=\"fas fa-save me-1\"></i>Güncelle\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- Silme Onay Modal -->\r\n<div class=\"modal fade\" id=\"deleteOperatorModal\" tabindex=\"-1\" aria-labelledby=\"deleteOperatorModalLabel\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h5 class=\"modal-title\" id=\"deleteOperatorModalLabel\">\r\n                    <i class=\"fas fa-trash me-2\"></i>Operatör Sil\r\n                </h5>\r\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <p>Bu VoIP operatörü silmek istediğinizden emin misiniz?</p>\r\n                <p><strong id=\"deleteOperatorName\"></strong></p>\r\n                <p class=\"text-danger\"><small>Bu işlem geri alınamaz!</small></p>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <form method=\"POST\" id=\"deleteOperatorForm\">\r\n                    <input type=\"hidden\" name=\"action\" value=\"delete\">\r\n                    <input type=\"hidden\" name=\"id\" id=\"deleteOperatorId\">\r\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">İptal</button>\r\n                    <button type=\"submit\" class=\"btn btn-danger\">\r\n                        <i class=\"fas fa-trash me-1\"></i>Sil\r\n                    </button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<script>\r\nfunction editOperator(operator) {\r\n    // Modal formuna veri doldur\r\n    document.getElementById('edit_voip_operator_id').value = operator.voip_operator_id;\r\n    document.getElementById('edit_voip_operator_adi').value = operator.voip_operator_adi;\r\n    document.getElementById('edit_voip_operator_users_id').value = operator.voip_operator_users_id;\r\n    document.getElementById('edit_voip_operator_aciklama').value = operator.voip_operator_aciklama || '';\r\n    document.getElementById('edit_voip_operator_kanalSayisi').value = operator.voip_operator_kanalSayisi || '';\r\n    document.getElementById('edit_voip_operator_CPS').value = operator.voip_operator_CPS || '';\r\n    document.getElementById('edit_voip_operator_link').value = operator.voip_operator_link || '';\r\n    document.getElementById('edit_voip_operator_IP').value = operator.voip_operator_IP || '';\r\n    document.getElementById('edit_voip_operator_kullanici').value = operator.voip_operator_kullanici || '';\r\n    document.getElementById('edit_voip_operator_sifre').value = operator.voip_operator_sifre || '';\r\n    document.getElementById('edit_voip_operator_trunk').value = operator.voip_operator_trunk || '0';\r\n    document.getElementById('edit_voip_operator_durum').checked = operator.voip_operator_durum == 1;\r\n    \r\n    // Modal'ı aç\r\n    new bootstrap.Modal(document.getElementById('editOperatorModal')).show();\r\n}\r\n\r\nfunction deleteOperator(id, name) {\r\n    document.getElementById('deleteOperatorId').value = id;\r\n    document.getElementById('deleteOperatorName').textContent = name;\r\n    new bootstrap.Modal(document.getElementById('deleteOperatorModal')).show();\r\n}\r\n</script>\r\n\r\n<?php include 'includes/footer.php'; ?>"
        }
    ]
}