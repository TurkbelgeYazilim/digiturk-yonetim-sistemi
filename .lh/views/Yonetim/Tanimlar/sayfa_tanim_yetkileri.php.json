{
    "sourceFile": "views/Yonetim/Tanimlar/sayfa_tanim_yetkileri.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 16,
            "patches": [
                {
                    "date": 1761042748670,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1761045890846,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,8 +30,16 @@\n         switch ($action) {\r\n             case 'add_modul':\r\n                 $modulAdi = trim($_POST['modul_adi']);\r\n                 $modulUrl = trim($_POST['modul_url']);\r\n+                // Eğer kullanıcı boş bıraktıysa null, değilse başına '/' ekle (tekrar eklemeyi önle)\r\n+                if (!empty($modulUrl)) {\r\n+                    if ($modulUrl[0] !== '/') {\r\n+                        $modulUrl = '/' . $modulUrl;\r\n+                    }\r\n+                } else {\r\n+                    $modulUrl = null;\r\n+                }\r\n                 $aciklama = trim($_POST['aciklama'] ?? '');\r\n                 $durum = $_POST['durum'] ?? 1;\r\n                 \r\n                 if (empty($modulAdi)) {\r\n@@ -270,9 +278,42 @@\n     error_log(\"Error fetching data: \" . $e->getMessage());\r\n     $error = \"Veritabanı hatası: \" . $e->getMessage();\r\n }\r\n \r\n+// View klasörlerini tara ve dropdown için hazırla\r\n+$viewFolders = []; // Modül için üst seviye klasörler\r\n+$viewSubFolders = []; // Menü için alt klasörler (modül bazlı)\r\n try {\r\n+    // __DIR__ => .../views/Yonetim/Tanimlar, views dizinine çık\r\n+    $viewsBase = dirname(__DIR__, 2);\r\n+    if (is_dir($viewsBase)) {\r\n+        $iter = new DirectoryIterator($viewsBase);\r\n+        foreach ($iter as $fileinfo) {\r\n+            if ($fileinfo->isDot() || !$fileinfo->isDir()) continue;\r\n+            $folderName = $fileinfo->getFilename();\r\n+            // Üst seviye klasörü ekle\r\n+            $viewFolders[] = '/' . $folderName;\r\n+            \r\n+            // Alt klasörleri tara (Menü için)\r\n+            $subdir = $viewsBase . DIRECTORY_SEPARATOR . $folderName;\r\n+            $subFolderList = [];\r\n+            if (is_dir($subdir)) {\r\n+                $subIter = new DirectoryIterator($subdir);\r\n+                foreach ($subIter as $subInfo) {\r\n+                    if ($subInfo->isDot() || !$subInfo->isDir()) continue;\r\n+                    $subFolderList[] = $subInfo->getFilename();\r\n+                }\r\n+                sort($subFolderList);\r\n+            }\r\n+            $viewSubFolders[$folderName] = $subFolderList;\r\n+        }\r\n+        sort($viewFolders);\r\n+    }\r\n+} catch (Exception $e) {\r\n+    // ignore scanning errors, not critical\r\n+}\r\n+\r\n+try {\r\n     include '../../../includes/header.php';\r\n } catch (Exception $e) {\r\n     die(\"Header dosyası yüklenirken hata: \" . $e->getMessage());\r\n }\r\n@@ -347,10 +388,15 @@\n                                            placeholder=\"Örn: Yönetim\">\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"modul_url\" class=\"form-label\">Modül URL</label>\r\n-                                    <input type=\"text\" class=\"form-control\" id=\"modul_url\" name=\"modul_url\" \r\n-                                           placeholder=\"Örn: /Yonetim\">\r\n+                                    <select class=\"form-select\" id=\"modul_url\" name=\"modul_url\">\r\n+                                        <option value=\"\">Klasör seçiniz veya elle girin...</option>\r\n+                                        <?php foreach ($viewFolders as $vf): ?>\r\n+                                            <option value=\"<?php echo htmlspecialchars($vf); ?>\"><?php echo htmlspecialchars($vf); ?></option>\r\n+                                        <?php endforeach; ?>\r\n+                                    </select>\r\n+                                    <small class=\"form-text text-muted\">Eğer listede yoksa elle \"/Klasor\" şeklinde girebilirsiniz.</small>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"modul_aciklama\" class=\"form-label\">Açıklama</label>\r\n                                     <textarea class=\"form-control\" id=\"modul_aciklama\" name=\"aciklama\" rows=\"2\" \r\n@@ -428,9 +474,9 @@\n                             <form method=\"POST\" action=\"\">\r\n                                 <input type=\"hidden\" name=\"action\" value=\"add_menu\">\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"menu_modul_id\" class=\"form-label\">Modül Seç</label>\r\n-                                    <select class=\"form-select\" id=\"menu_modul_id\" name=\"modul_id\" required>\r\n+                                    <select class=\"form-select\" id=\"menu_modul_id\" name=\"modul_id\" required onchange=\"updateMenuUrlDropdown()\">\r\n                                         <option value=\"\">Modül seçiniz...</option>\r\n                                         <?php foreach ($moduller as $modul): ?>\r\n                                             <?php if ($modul['durum'] == 1): ?>\r\n                                                 <option value=\"<?php echo $modul['modul_id']; ?>\">\r\n@@ -446,10 +492,12 @@\n                                            placeholder=\"Örn: Tanımlar\">\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"menu_url\" class=\"form-label\">Menü URL</label>\r\n-                                    <input type=\"text\" class=\"form-control\" id=\"menu_url\" name=\"menu_url\" \r\n-                                           placeholder=\"Örn: Tanimlar\">\r\n+                                    <select class=\"form-select\" id=\"menu_url\" name=\"menu_url\">\r\n+                                        <option value=\"\">Önce modül seçiniz...</option>\r\n+                                    </select>\r\n+                                    <small class=\"form-text text-muted\">Seçilen modülün alt klasörleri listelenir.</small>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"menu_ikon\" class=\"form-label\">İkon</label>\r\n                                     <input type=\"text\" class=\"form-control\" id=\"menu_ikon\" name=\"ikon\" \r\n@@ -861,9 +909,38 @@\n <script>\r\n // Menü verilerini JavaScript'e aktar\r\n const menulerData = <?php echo json_encode($menuler); ?>;\r\n const sayfalarData = <?php echo json_encode($sayfalar); ?>;\r\n+const viewSubFolders = <?php echo json_encode($viewSubFolders); ?>;\r\n+const modullerData = <?php echo json_encode($moduller); ?>;\r\n \r\n+// Menü tanımı için modül seçildiğinde URL dropdown'unu güncelle\r\n+function updateMenuUrlDropdown() {\r\n+    const modulId = document.getElementById('menu_modul_id').value;\r\n+    const menuUrlDropdown = document.getElementById('menu_url');\r\n+    \r\n+    menuUrlDropdown.innerHTML = '<option value=\"\">Alt klasör seçiniz...</option>';\r\n+    \r\n+    if (modulId) {\r\n+        // Seçilen modülün modul_url'sini bul\r\n+        const selectedModul = modullerData.find(m => m.modul_id == modulId);\r\n+        if (selectedModul && selectedModul.modul_url) {\r\n+            // modul_url'den başındaki \"/\" kaldır\r\n+            const folderName = selectedModul.modul_url.replace(/^\\//, '');\r\n+            \r\n+            // Bu modülün alt klasörlerini getir\r\n+            if (viewSubFolders[folderName] && viewSubFolders[folderName].length > 0) {\r\n+                viewSubFolders[folderName].forEach(subFolder => {\r\n+                    const option = document.createElement('option');\r\n+                    option.value = subFolder;\r\n+                    option.textContent = subFolder;\r\n+                    menuUrlDropdown.appendChild(option);\r\n+                });\r\n+            }\r\n+        }\r\n+    }\r\n+}\r\n+\r\n // Sayfa tanımı için menü dropdown güncelleme\r\n function updateMenuDropdown() {\r\n     const modulId = document.getElementById('sayfa_modul_id').value;\r\n     const menuDropdown = document.getElementById('sayfa_menu_id');\r\n"
                },
                {
                    "date": 1761046026204,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -311,8 +311,23 @@\n } catch (Exception $e) {\r\n     // ignore scanning errors, not critical\r\n }\r\n \r\n+// Kullanılmış modül URL'lerini topla (filtreleme için)\r\n+$usedModulUrls = array_column($moduller, 'modul_url');\r\n+$viewFolders = array_diff($viewFolders, $usedModulUrls);\r\n+\r\n+// Kullanılmış menü URL'lerini modül bazında topla (filtreleme için)\r\n+$usedMenuUrls = [];\r\n+foreach ($menuler as $menu) {\r\n+    if (!empty($menu['modul_id']) && !empty($menu['menu_url'])) {\r\n+        if (!isset($usedMenuUrls[$menu['modul_id']])) {\r\n+            $usedMenuUrls[$menu['modul_id']] = [];\r\n+        }\r\n+        $usedMenuUrls[$menu['modul_id']][] = $menu['menu_url'];\r\n+    }\r\n+}\r\n+\r\n try {\r\n     include '../../../includes/header.php';\r\n } catch (Exception $e) {\r\n     die(\"Header dosyası yüklenirken hata: \" . $e->getMessage());\r\n@@ -911,8 +926,9 @@\n const menulerData = <?php echo json_encode($menuler); ?>;\r\n const sayfalarData = <?php echo json_encode($sayfalar); ?>;\r\n const viewSubFolders = <?php echo json_encode($viewSubFolders); ?>;\r\n const modullerData = <?php echo json_encode($moduller); ?>;\r\n+const usedMenuUrls = <?php echo json_encode($usedMenuUrls); ?>;\r\n \r\n // Menü tanımı için modül seçildiğinde URL dropdown'unu güncelle\r\n function updateMenuUrlDropdown() {\r\n     const modulId = document.getElementById('menu_modul_id').value;\r\n@@ -926,15 +942,21 @@\n         if (selectedModul && selectedModul.modul_url) {\r\n             // modul_url'den başındaki \"/\" kaldır\r\n             const folderName = selectedModul.modul_url.replace(/^\\//, '');\r\n             \r\n-            // Bu modülün alt klasörlerini getir\r\n+            // Bu modül için kullanılmış URL'leri al\r\n+            const usedUrls = usedMenuUrls[modulId] || [];\r\n+            \r\n+            // Bu modülün alt klasörlerini getir ve kullanılmamış olanları listele\r\n             if (viewSubFolders[folderName] && viewSubFolders[folderName].length > 0) {\r\n                 viewSubFolders[folderName].forEach(subFolder => {\r\n-                    const option = document.createElement('option');\r\n-                    option.value = subFolder;\r\n-                    option.textContent = subFolder;\r\n-                    menuUrlDropdown.appendChild(option);\r\n+                    // Eğer bu URL daha önce kullanılmamışsa ekle\r\n+                    if (!usedUrls.includes(subFolder)) {\r\n+                        const option = document.createElement('option');\r\n+                        option.value = subFolder;\r\n+                        option.textContent = subFolder;\r\n+                        menuUrlDropdown.appendChild(option);\r\n+                    }\r\n                 });\r\n             }\r\n         }\r\n     }\r\n"
                },
                {
                    "date": 1761046102025,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -942,11 +942,16 @@\n         if (selectedModul && selectedModul.modul_url) {\r\n             // modul_url'den başındaki \"/\" kaldır\r\n             const folderName = selectedModul.modul_url.replace(/^\\//, '');\r\n             \r\n-            // Bu modül için kullanılmış URL'leri al\r\n-            const usedUrls = usedMenuUrls[modulId] || [];\r\n+            // Bu modül için kullanılmış URL'leri al (string ve number karşılaştırması için her ikisini de kontrol et)\r\n+            const usedUrls = usedMenuUrls[modulId] || usedMenuUrls[String(modulId)] || [];\r\n             \r\n+            console.log('Seçilen Modül ID:', modulId);\r\n+            console.log('Folder Name:', folderName);\r\n+            console.log('Kullanılmış URL\\'ler:', usedUrls);\r\n+            console.log('Alt Klasörler:', viewSubFolders[folderName]);\r\n+            \r\n             // Bu modülün alt klasörlerini getir ve kullanılmamış olanları listele\r\n             if (viewSubFolders[folderName] && viewSubFolders[folderName].length > 0) {\r\n                 viewSubFolders[folderName].forEach(subFolder => {\r\n                     // Eğer bu URL daha önce kullanılmamışsa ekle\r\n@@ -954,8 +959,10 @@\n                         const option = document.createElement('option');\r\n                         option.value = subFolder;\r\n                         option.textContent = subFolder;\r\n                         menuUrlDropdown.appendChild(option);\r\n+                    } else {\r\n+                        console.log('Filtrelendi (kullanılmış):', subFolder);\r\n                     }\r\n                 });\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1761046497794,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -67,8 +67,55 @@\n                 $message = 'Modül başarıyla tanımlandı.';\r\n                 $messageType = 'success';\r\n                 break;\r\n                 \r\n+            case 'edit_modul':\r\n+                $modulId = (int)$_POST['modul_id'];\r\n+                $modulAdi = trim($_POST['modul_adi']);\r\n+                $modulUrl = trim($_POST['modul_url']);\r\n+                // Eğer kullanıcı boş bıraktıysa null, değilse başına '/' ekle\r\n+                if (!empty($modulUrl)) {\r\n+                    if ($modulUrl[0] !== '/') {\r\n+                        $modulUrl = '/' . $modulUrl;\r\n+                    }\r\n+                } else {\r\n+                    $modulUrl = null;\r\n+                }\r\n+                $aciklama = trim($_POST['aciklama'] ?? '');\r\n+                $durum = $_POST['durum'] ?? 1;\r\n+                \r\n+                if ($modulId <= 0) {\r\n+                    $message = 'Geçersiz modül ID.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                if (empty($modulAdi)) {\r\n+                    $message = 'Modül adı alanı zorunludur.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                // Modül adı kontrolü (mevcut kayıt hariç)\r\n+                $checkSql = \"SELECT modul_id FROM tanim_moduller WHERE modul_adi = ? AND modul_id != ?\";\r\n+                $checkStmt = $conn->prepare($checkSql);\r\n+                $checkStmt->execute([$modulAdi, $modulId]);\r\n+                \r\n+                if ($checkStmt->fetch()) {\r\n+                    $message = 'Bu modül adı başka bir kayıtta kullanılmaktadır.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                $sql = \"UPDATE tanim_moduller SET modul_adi = ?, modul_url = ?, aciklama = ?, durum = ?, updated_at = GETDATE() \r\n+                        WHERE modul_id = ?\";\r\n+                $stmt = $conn->prepare($sql);\r\n+                $stmt->execute([$modulAdi, $modulUrl, $aciklama, $durum, $modulId]);\r\n+                \r\n+                $message = 'Modül başarıyla güncellendi.';\r\n+                $messageType = 'success';\r\n+                break;\r\n+                \r\n             case 'add_menu':\r\n                 $modulId = (int)$_POST['modul_id'];\r\n                 $menuAdi = trim($_POST['menu_adi']);\r\n                 $menuUrl = trim($_POST['menu_url']);\r\n@@ -96,8 +143,44 @@\n                 $message = 'Menü başarıyla tanımlandı.';\r\n                 $messageType = 'success';\r\n                 break;\r\n                 \r\n+            case 'edit_menu':\r\n+                $menuId = (int)$_POST['menu_id'];\r\n+                $modulId = (int)$_POST['modul_id'];\r\n+                $menuAdi = trim($_POST['menu_adi']);\r\n+                $menuUrl = trim($_POST['menu_url']);\r\n+                $ikon = trim($_POST['ikon'] ?? '');\r\n+                $siraNo = (int)($_POST['sira_no'] ?? 0);\r\n+                $durum = $_POST['durum'] ?? 1;\r\n+                \r\n+                if ($menuId <= 0) {\r\n+                    $message = 'Geçersiz menü ID.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                if ($modulId <= 0) {\r\n+                    $message = 'Lütfen bir modül seçiniz.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                if (empty($menuAdi)) {\r\n+                    $message = 'Menü adı alanı zorunludur.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                $sql = \"UPDATE tanim_menuler SET modul_id = ?, menu_adi = ?, menu_url = ?, ikon = ?, sira_no = ?, durum = ?, updated_at = GETDATE() \r\n+                        WHERE menu_id = ?\";\r\n+                $stmt = $conn->prepare($sql);\r\n+                $stmt->execute([$modulId, $menuAdi, $menuUrl, $ikon, $siraNo, $durum, $menuId]);\r\n+                \r\n+                $message = 'Menü başarıyla güncellendi.';\r\n+                $messageType = 'success';\r\n+                break;\r\n+                \r\n             case 'add_sayfa':\r\n                 $menuId = (int)$_POST['menu_id'];\r\n                 $sayfaAdi = trim($_POST['sayfa_adi']);\r\n                 $sayfaUrl = trim($_POST['sayfa_url']);\r\n@@ -124,8 +207,43 @@\n                 $message = 'Sayfa başarıyla tanımlandı.';\r\n                 $messageType = 'success';\r\n                 break;\r\n                 \r\n+            case 'edit_sayfa':\r\n+                $sayfaId = (int)$_POST['sayfa_id'];\r\n+                $menuId = (int)$_POST['menu_id'];\r\n+                $sayfaAdi = trim($_POST['sayfa_adi']);\r\n+                $sayfaUrl = trim($_POST['sayfa_url']);\r\n+                $aciklama = trim($_POST['aciklama'] ?? '');\r\n+                $durum = $_POST['durum'] ?? 1;\r\n+                \r\n+                if ($sayfaId <= 0) {\r\n+                    $message = 'Geçersiz sayfa ID.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                if ($menuId <= 0) {\r\n+                    $message = 'Lütfen bir menü seçiniz.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                if (empty($sayfaAdi)) {\r\n+                    $message = 'Sayfa adı alanı zorunludur.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                $sql = \"UPDATE tanim_sayfalar SET menu_id = ?, sayfa_adi = ?, sayfa_url = ?, aciklama = ?, durum = ?, updated_at = GETDATE() \r\n+                        WHERE sayfa_id = ?\";\r\n+                $stmt = $conn->prepare($sql);\r\n+                $stmt->execute([$menuId, $sayfaAdi, $sayfaUrl, $aciklama, $durum, $sayfaId]);\r\n+                \r\n+                $message = 'Sayfa başarıyla güncellendi.';\r\n+                $messageType = 'success';\r\n+                break;\r\n+                \r\n             case 'add_yetki':\r\n                 $sayfaId = (int)$_POST['sayfa_id'];\r\n                 $userGroupId = (int)$_POST['user_group_id'];\r\n                 $gor = isset($_POST['gor']) ? 1 : 0;\r\n@@ -445,8 +563,9 @@\n                                             <th>Modül Adı</th>\r\n                                             <th>URL</th>\r\n                                             <th>Açıklama</th>\r\n                                             <th>Durum</th>\r\n+                                            <th>İşlemler</th>\r\n                                         </tr>\r\n                                     </thead>\r\n                                     <tbody>\r\n                                         <?php if (!empty($moduller)): ?>\r\n@@ -460,13 +579,19 @@\n                                                         <span class=\"badge bg-<?php echo $modul['durum'] == 1 ? 'success' : 'secondary'; ?>\">\r\n                                                             <?php echo $modul['durum'] == 1 ? 'Aktif' : 'Pasif'; ?>\r\n                                                         </span>\r\n                                                     </td>\r\n+                                                    <td>\r\n+                                                        <button type=\"button\" class=\"btn btn-sm btn-outline-primary\" \r\n+                                                                onclick=\"editModul(<?php echo htmlspecialchars(json_encode($modul)); ?>)\">\r\n+                                                            <i class=\"fas fa-edit\"></i>\r\n+                                                        </button>\r\n+                                                    </td>\r\n                                                 </tr>\r\n                                             <?php endforeach; ?>\r\n                                         <?php else: ?>\r\n                                             <tr>\r\n-                                                <td colspan=\"5\" class=\"text-center py-4 text-muted\">Henüz modül tanımlanmamış</td>\r\n+                                                <td colspan=\"6\" class=\"text-center py-4 text-muted\">Henüz modül tanımlanmamış</td>\r\n                                             </tr>\r\n                                         <?php endif; ?>\r\n                                     </tbody>\r\n                                 </table>\r\n@@ -552,8 +677,9 @@\n                                             <th>URL</th>\r\n                                             <th>İkon</th>\r\n                                             <th>Sıra</th>\r\n                                             <th>Durum</th>\r\n+                                            <th>İşlemler</th>\r\n                                         </tr>\r\n                                     </thead>\r\n                                     <tbody>\r\n                                         <?php if (!empty($menuler)): ?>\r\n@@ -569,13 +695,19 @@\n                                                         <span class=\"badge bg-<?php echo $menu['durum'] == 1 ? 'success' : 'secondary'; ?>\">\r\n                                                             <?php echo $menu['durum'] == 1 ? 'Aktif' : 'Pasif'; ?>\r\n                                                         </span>\r\n                                                     </td>\r\n+                                                    <td>\r\n+                                                        <button type=\"button\" class=\"btn btn-sm btn-outline-primary\" \r\n+                                                                onclick=\"editMenu(<?php echo htmlspecialchars(json_encode($menu)); ?>)\">\r\n+                                                            <i class=\"fas fa-edit\"></i>\r\n+                                                        </button>\r\n+                                                    </td>\r\n                                                 </tr>\r\n                                             <?php endforeach; ?>\r\n                                         <?php else: ?>\r\n                                             <tr>\r\n-                                                <td colspan=\"7\" class=\"text-center py-4 text-muted\">Henüz menü tanımlanmamış</td>\r\n+                                                <td colspan=\"8\" class=\"text-center py-4 text-muted\">Henüz menü tanımlanmamış</td>\r\n                                             </tr>\r\n                                         <?php endif; ?>\r\n                                     </tbody>\r\n                                 </table>\r\n@@ -660,8 +792,9 @@\n                                             <th>Menü</th>\r\n                                             <th>Sayfa Adı</th>\r\n                                             <th>URL</th>\r\n                                             <th>Durum</th>\r\n+                                            <th>İşlemler</th>\r\n                                         </tr>\r\n                                     </thead>\r\n                                     <tbody>\r\n                                         <?php if (!empty($sayfalar)): ?>\r\n@@ -676,13 +809,19 @@\n                                                         <span class=\"badge bg-<?php echo $sayfa['durum'] == 1 ? 'success' : 'secondary'; ?>\">\r\n                                                             <?php echo $sayfa['durum'] == 1 ? 'Aktif' : 'Pasif'; ?>\r\n                                                         </span>\r\n                                                     </td>\r\n+                                                    <td>\r\n+                                                        <button type=\"button\" class=\"btn btn-sm btn-outline-primary\" \r\n+                                                                onclick=\"editSayfa(<?php echo htmlspecialchars(json_encode($sayfa)); ?>)\">\r\n+                                                            <i class=\"fas fa-edit\"></i>\r\n+                                                        </button>\r\n+                                                    </td>\r\n                                                 </tr>\r\n                                             <?php endforeach; ?>\r\n                                         <?php else: ?>\r\n                                             <tr>\r\n-                                                <td colspan=\"6\" class=\"text-center py-4 text-muted\">Henüz sayfa tanımlanmamış</td>\r\n+                                                <td colspan=\"7\" class=\"text-center py-4 text-muted\">Henüz sayfa tanımlanmamış</td>\r\n                                             </tr>\r\n                                         <?php endif; ?>\r\n                                     </tbody>\r\n                                 </table>\r\n@@ -855,8 +994,188 @@\n         </div>\r\n     </div>\r\n </div>\r\n \r\n+<!-- Modül Düzenle Modal -->\r\n+<div class=\"modal fade\" id=\"editModulModal\" tabindex=\"-1\">\r\n+    <div class=\"modal-dialog\">\r\n+        <div class=\"modal-content\">\r\n+            <form method=\"POST\" action=\"\">\r\n+                <input type=\"hidden\" name=\"action\" value=\"edit_modul\">\r\n+                <input type=\"hidden\" name=\"modul_id\" id=\"edit_modul_id\">\r\n+                <div class=\"modal-header\">\r\n+                    <h5 class=\"modal-title\">\r\n+                        <i class=\"fas fa-edit me-2\"></i>Modül Düzenle\r\n+                    </h5>\r\n+                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n+                </div>\r\n+                <div class=\"modal-body\">\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_modul_adi\" class=\"form-label\">Modül Adı</label>\r\n+                        <input type=\"text\" class=\"form-control\" id=\"edit_modul_adi\" name=\"modul_adi\" required>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_modul_url\" class=\"form-label\">Modül URL</label>\r\n+                        <select class=\"form-select\" id=\"edit_modul_url\" name=\"modul_url\">\r\n+                            <option value=\"\">Klasör seçiniz...</option>\r\n+                            <?php foreach ($viewFolders as $vf): ?>\r\n+                                <option value=\"<?php echo htmlspecialchars($vf); ?>\"><?php echo htmlspecialchars($vf); ?></option>\r\n+                            <?php endforeach; ?>\r\n+                        </select>\r\n+                        <small class=\"form-text text-muted\">View klasörlerinden seçiniz.</small>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_modul_aciklama\" class=\"form-label\">Açıklama</label>\r\n+                        <textarea class=\"form-control\" id=\"edit_modul_aciklama\" name=\"aciklama\" rows=\"2\"></textarea>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_modul_durum\" class=\"form-label\">Durum</label>\r\n+                        <select class=\"form-select\" id=\"edit_modul_durum\" name=\"durum\">\r\n+                            <option value=\"1\">Aktif</option>\r\n+                            <option value=\"0\">Pasif</option>\r\n+                        </select>\r\n+                    </div>\r\n+                </div>\r\n+                <div class=\"modal-footer\">\r\n+                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">İptal</button>\r\n+                    <button type=\"submit\" class=\"btn btn-primary\">\r\n+                        <i class=\"fas fa-save me-1\"></i>Güncelle\r\n+                    </button>\r\n+                </div>\r\n+            </form>\r\n+        </div>\r\n+    </div>\r\n+</div>\r\n+\r\n+<!-- Menü Düzenle Modal -->\r\n+<div class=\"modal fade\" id=\"editMenuModal\" tabindex=\"-1\">\r\n+    <div class=\"modal-dialog\">\r\n+        <div class=\"modal-content\">\r\n+            <form method=\"POST\" action=\"\">\r\n+                <input type=\"hidden\" name=\"action\" value=\"edit_menu\">\r\n+                <input type=\"hidden\" name=\"menu_id\" id=\"edit_menu_id\">\r\n+                <div class=\"modal-header\">\r\n+                    <h5 class=\"modal-title\">\r\n+                        <i class=\"fas fa-edit me-2\"></i>Menü Düzenle\r\n+                    </h5>\r\n+                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n+                </div>\r\n+                <div class=\"modal-body\">\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_menu_modul_id\" class=\"form-label\">Modül</label>\r\n+                        <select class=\"form-select\" id=\"edit_menu_modul_id\" name=\"modul_id\" required onchange=\"updateEditMenuUrlDropdown()\">\r\n+                            <option value=\"\">Modül seçiniz...</option>\r\n+                            <?php foreach ($moduller as $modul): ?>\r\n+                                <?php if ($modul['durum'] == 1): ?>\r\n+                                    <option value=\"<?php echo $modul['modul_id']; ?>\">\r\n+                                        <?php echo htmlspecialchars($modul['modul_adi']); ?>\r\n+                                    </option>\r\n+                                <?php endif; ?>\r\n+                            <?php endforeach; ?>\r\n+                        </select>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_menu_adi\" class=\"form-label\">Menü Adı</label>\r\n+                        <input type=\"text\" class=\"form-control\" id=\"edit_menu_adi\" name=\"menu_adi\" required>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_menu_url\" class=\"form-label\">Menü URL</label>\r\n+                        <select class=\"form-select\" id=\"edit_menu_url\" name=\"menu_url\">\r\n+                            <option value=\"\">Önce modül seçiniz...</option>\r\n+                        </select>\r\n+                        <small class=\"form-text text-muted\">Seçilen modülün alt klasörleri listelenir.</small>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_menu_ikon\" class=\"form-label\">İkon</label>\r\n+                        <input type=\"text\" class=\"form-control\" id=\"edit_menu_ikon\" name=\"ikon\">\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_menu_sira_no\" class=\"form-label\">Sıra No</label>\r\n+                        <input type=\"number\" class=\"form-control\" id=\"edit_menu_sira_no\" name=\"sira_no\">\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_menu_durum\" class=\"form-label\">Durum</label>\r\n+                        <select class=\"form-select\" id=\"edit_menu_durum\" name=\"durum\">\r\n+                            <option value=\"1\">Aktif</option>\r\n+                            <option value=\"0\">Pasif</option>\r\n+                        </select>\r\n+                    </div>\r\n+                </div>\r\n+                <div class=\"modal-footer\">\r\n+                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">İptal</button>\r\n+                    <button type=\"submit\" class=\"btn btn-primary\">\r\n+                        <i class=\"fas fa-save me-1\"></i>Güncelle\r\n+                    </button>\r\n+                </div>\r\n+            </form>\r\n+        </div>\r\n+    </div>\r\n+</div>\r\n+\r\n+<!-- Sayfa Düzenle Modal -->\r\n+<div class=\"modal fade\" id=\"editSayfaModal\" tabindex=\"-1\">\r\n+    <div class=\"modal-dialog\">\r\n+        <div class=\"modal-content\">\r\n+            <form method=\"POST\" action=\"\">\r\n+                <input type=\"hidden\" name=\"action\" value=\"edit_sayfa\">\r\n+                <input type=\"hidden\" name=\"sayfa_id\" id=\"edit_sayfa_id\">\r\n+                <div class=\"modal-header\">\r\n+                    <h5 class=\"modal-title\">\r\n+                        <i class=\"fas fa-edit me-2\"></i>Sayfa Düzenle\r\n+                    </h5>\r\n+                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n+                </div>\r\n+                <div class=\"modal-body\">\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_sayfa_modul_id\" class=\"form-label\">Modül</label>\r\n+                        <select class=\"form-select\" id=\"edit_sayfa_modul_id\" onchange=\"updateEditSayfaMenuDropdown()\">\r\n+                            <option value=\"\">Modül seçiniz...</option>\r\n+                            <?php foreach ($moduller as $modul): ?>\r\n+                                <?php if ($modul['durum'] == 1): ?>\r\n+                                    <option value=\"<?php echo $modul['modul_id']; ?>\">\r\n+                                        <?php echo htmlspecialchars($modul['modul_adi']); ?>\r\n+                                    </option>\r\n+                                <?php endif; ?>\r\n+                            <?php endforeach; ?>\r\n+                        </select>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_sayfa_menu_id\" class=\"form-label\">Menü</label>\r\n+                        <select class=\"form-select\" id=\"edit_sayfa_menu_id\" name=\"menu_id\" required>\r\n+                            <option value=\"\">Önce modül seçiniz...</option>\r\n+                        </select>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_sayfa_adi\" class=\"form-label\">Sayfa Adı</label>\r\n+                        <input type=\"text\" class=\"form-control\" id=\"edit_sayfa_adi\" name=\"sayfa_adi\" required>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_sayfa_url\" class=\"form-label\">Sayfa URL</label>\r\n+                        <input type=\"text\" class=\"form-control\" id=\"edit_sayfa_url\" name=\"sayfa_url\">\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_sayfa_aciklama\" class=\"form-label\">Açıklama</label>\r\n+                        <textarea class=\"form-control\" id=\"edit_sayfa_aciklama\" name=\"aciklama\" rows=\"2\"></textarea>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_sayfa_durum\" class=\"form-label\">Durum</label>\r\n+                        <select class=\"form-select\" id=\"edit_sayfa_durum\" name=\"durum\">\r\n+                            <option value=\"1\">Aktif</option>\r\n+                            <option value=\"0\">Pasif</option>\r\n+                        </select>\r\n+                    </div>\r\n+                </div>\r\n+                <div class=\"modal-footer\">\r\n+                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">İptal</button>\r\n+                    <button type=\"submit\" class=\"btn btn-primary\">\r\n+                        <i class=\"fas fa-save me-1\"></i>Güncelle\r\n+                    </button>\r\n+                </div>\r\n+            </form>\r\n+        </div>\r\n+    </div>\r\n+</div>\r\n+\r\n <!-- Yetki Düzenle Modal -->\r\n <div class=\"modal fade\" id=\"editYetkiModal\" tabindex=\"-1\">\r\n     <div class=\"modal-dialog\">\r\n         <div class=\"modal-content\">\r\n@@ -1024,8 +1343,116 @@\n         });\r\n     }\r\n }\r\n \r\n+// Modül düzenleme\r\n+function editModul(modul) {\r\n+    document.getElementById('edit_modul_id').value = modul.modul_id;\r\n+    document.getElementById('edit_modul_adi').value = modul.modul_adi;\r\n+    document.getElementById('edit_modul_url').value = modul.modul_url || '';\r\n+    document.getElementById('edit_modul_aciklama').value = modul.aciklama || '';\r\n+    document.getElementById('edit_modul_durum').value = modul.durum;\r\n+    \r\n+    new bootstrap.Modal(document.getElementById('editModulModal')).show();\r\n+}\r\n+\r\n+// Menü düzenleme\r\n+function editMenu(menu) {\r\n+    document.getElementById('edit_menu_id').value = menu.menu_id;\r\n+    document.getElementById('edit_menu_modul_id').value = menu.modul_id;\r\n+    document.getElementById('edit_menu_adi').value = menu.menu_adi;\r\n+    document.getElementById('edit_menu_ikon').value = menu.ikon || '';\r\n+    document.getElementById('edit_menu_sira_no').value = menu.sira_no;\r\n+    document.getElementById('edit_menu_durum').value = menu.durum;\r\n+    \r\n+    // Modül seçilince URL dropdown'unu güncelle\r\n+    updateEditMenuUrlDropdown();\r\n+    \r\n+    // Dropdown dolduktan sonra mevcut URL'yi seç\r\n+    setTimeout(() => {\r\n+        const urlDropdown = document.getElementById('edit_menu_url');\r\n+        // Eğer mevcut URL dropdown'da yoksa, option olarak ekle\r\n+        if (menu.menu_url) {\r\n+            const existingOption = Array.from(urlDropdown.options).find(opt => opt.value === menu.menu_url);\r\n+            if (!existingOption) {\r\n+                const option = document.createElement('option');\r\n+                option.value = menu.menu_url;\r\n+                option.textContent = menu.menu_url + ' (mevcut)';\r\n+                urlDropdown.appendChild(option);\r\n+            }\r\n+            urlDropdown.value = menu.menu_url;\r\n+        }\r\n+    }, 100);\r\n+    \r\n+    new bootstrap.Modal(document.getElementById('editMenuModal')).show();\r\n+}\r\n+\r\n+// Menü düzenleme modalı için URL dropdown güncelleme\r\n+function updateEditMenuUrlDropdown() {\r\n+    const modulId = document.getElementById('edit_menu_modul_id').value;\r\n+    const menuUrlDropdown = document.getElementById('edit_menu_url');\r\n+    \r\n+    menuUrlDropdown.innerHTML = '<option value=\"\">Alt klasör seçiniz...</option>';\r\n+    \r\n+    if (modulId) {\r\n+        const selectedModul = modullerData.find(m => m.modul_id == modulId);\r\n+        if (selectedModul && selectedModul.modul_url) {\r\n+            const folderName = selectedModul.modul_url.replace(/^\\//, '');\r\n+            const usedUrls = usedMenuUrls[modulId] || usedMenuUrls[String(modulId)] || [];\r\n+            \r\n+            if (viewSubFolders[folderName] && viewSubFolders[folderName].length > 0) {\r\n+                viewSubFolders[folderName].forEach(subFolder => {\r\n+                    // Düzenleme modunda tüm URL'leri göster (filtreleme yapma)\r\n+                    const option = document.createElement('option');\r\n+                    option.value = subFolder;\r\n+                    option.textContent = subFolder;\r\n+                    menuUrlDropdown.appendChild(option);\r\n+                });\r\n+            }\r\n+        }\r\n+    }\r\n+}\r\n+\r\n+// Sayfa düzenleme\r\n+function editSayfa(sayfa) {\r\n+    document.getElementById('edit_sayfa_id').value = sayfa.sayfa_id;\r\n+    document.getElementById('edit_sayfa_adi').value = sayfa.sayfa_adi;\r\n+    document.getElementById('edit_sayfa_url').value = sayfa.sayfa_url || '';\r\n+    document.getElementById('edit_sayfa_aciklama').value = sayfa.aciklama || '';\r\n+    document.getElementById('edit_sayfa_durum').value = sayfa.durum;\r\n+    \r\n+    // Menü seçimi için modül bulup menü dropdown'unu doldur\r\n+    const menu = menulerData.find(m => m.menu_id == sayfa.menu_id);\r\n+    if (menu) {\r\n+        document.getElementById('edit_sayfa_modul_id').value = menu.modul_id;\r\n+        updateEditSayfaMenuDropdown();\r\n+        // Dropdown dolduktan sonra menüyü seç\r\n+        setTimeout(() => {\r\n+            document.getElementById('edit_sayfa_menu_id').value = sayfa.menu_id;\r\n+        }, 100);\r\n+    }\r\n+    \r\n+    new bootstrap.Modal(document.getElementById('editSayfaModal')).show();\r\n+}\r\n+\r\n+// Sayfa düzenleme modalı için menü dropdown güncelleme\r\n+function updateEditSayfaMenuDropdown() {\r\n+    const modulId = document.getElementById('edit_sayfa_modul_id').value;\r\n+    const menuDropdown = document.getElementById('edit_sayfa_menu_id');\r\n+    \r\n+    menuDropdown.innerHTML = '<option value=\"\">Menü seçiniz...</option>';\r\n+    \r\n+    if (modulId) {\r\n+        const filteredMenuler = menulerData.filter(m => m.modul_id == modulId && m.durum == 1);\r\n+        filteredMenuler.forEach(menu => {\r\n+            const option = document.createElement('option');\r\n+            option.value = menu.menu_id;\r\n+            option.textContent = menu.menu_adi;\r\n+            menuDropdown.appendChild(option);\r\n+        });\r\n+    }\r\n+}\r\n+\r\n // Yetki düzenleme\r\n function editYetki(yetki) {\r\n     document.getElementById('edit_yetki_id').value = yetki.sayfa_yetki_id;\r\n     document.getElementById('edit_sayfa_info').value = yetki.modul_adi + ' / ' + yetki.menu_adi + ' / ' + yetki.sayfa_adi;\r\n"
                },
                {
                    "date": 1761046659593,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -399,8 +399,9 @@\n \r\n // View klasörlerini tara ve dropdown için hazırla\r\n $viewFolders = []; // Modül için üst seviye klasörler\r\n $viewSubFolders = []; // Menü için alt klasörler (modül bazlı)\r\n+$viewFiles = []; // Sayfa için PHP dosyaları (modül/menü bazlı)\r\n try {\r\n     // __DIR__ => .../views/Yonetim/Tanimlar, views dizinine çık\r\n     $viewsBase = dirname(__DIR__, 2);\r\n     if (is_dir($viewsBase)) {\r\n@@ -417,9 +418,25 @@\n             if (is_dir($subdir)) {\r\n                 $subIter = new DirectoryIterator($subdir);\r\n                 foreach ($subIter as $subInfo) {\r\n                     if ($subInfo->isDot() || !$subInfo->isDir()) continue;\r\n-                    $subFolderList[] = $subInfo->getFilename();\r\n+                    $subFolderName = $subInfo->getFilename();\r\n+                    $subFolderList[] = $subFolderName;\r\n+                    \r\n+                    // PHP dosyalarını tara (Sayfa için)\r\n+                    $subSubDir = $subdir . DIRECTORY_SEPARATOR . $subFolderName;\r\n+                    $phpFilesList = [];\r\n+                    if (is_dir($subSubDir)) {\r\n+                        $fileIter = new DirectoryIterator($subSubDir);\r\n+                        foreach ($fileIter as $file) {\r\n+                            if ($file->isDot() || !$file->isFile()) continue;\r\n+                            if (pathinfo($file->getFilename(), PATHINFO_EXTENSION) === 'php') {\r\n+                                $phpFilesList[] = $file->getFilename();\r\n+                            }\r\n+                        }\r\n+                        sort($phpFilesList);\r\n+                    }\r\n+                    $viewFiles[$folderName][$subFolderName] = $phpFilesList;\r\n                 }\r\n                 sort($subFolderList);\r\n             }\r\n             $viewSubFolders[$folderName] = $subFolderList;\r\n@@ -444,8 +461,19 @@\n         $usedMenuUrls[$menu['modul_id']][] = $menu['menu_url'];\r\n     }\r\n }\r\n \r\n+// Kullanılmış sayfa URL'lerini menü bazında topla (filtreleme için)\r\n+$usedSayfaUrls = [];\r\n+foreach ($sayfalar as $sayfa) {\r\n+    if (!empty($sayfa['menu_id']) && !empty($sayfa['sayfa_url'])) {\r\n+        if (!isset($usedSayfaUrls[$sayfa['menu_id']])) {\r\n+            $usedSayfaUrls[$sayfa['menu_id']] = [];\r\n+        }\r\n+        $usedSayfaUrls[$sayfa['menu_id']][] = $sayfa['sayfa_url'];\r\n+    }\r\n+}\r\n+\r\n try {\r\n     include '../../../includes/header.php';\r\n } catch (Exception $e) {\r\n     die(\"Header dosyası yüklenirken hata: \" . $e->getMessage());\r\n@@ -743,9 +771,9 @@\n                                     </select>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"sayfa_menu_id\" class=\"form-label\">Menü Seç</label>\r\n-                                    <select class=\"form-select\" id=\"sayfa_menu_id\" name=\"menu_id\" required>\r\n+                                    <select class=\"form-select\" id=\"sayfa_menu_id\" name=\"menu_id\" required onchange=\"updateSayfaUrlDropdown()\">\r\n                                         <option value=\"\">Önce modül seçiniz...</option>\r\n                                     </select>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n@@ -754,10 +782,12 @@\n                                            placeholder=\"Örn: Bayi Hakedis Prim Dönem\">\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"sayfa_url\" class=\"form-label\">Sayfa URL</label>\r\n-                                    <input type=\"text\" class=\"form-control\" id=\"sayfa_url\" name=\"sayfa_url\" \r\n-                                           placeholder=\"Örn: bayi_hakedis_prim_donem.php\">\r\n+                                    <select class=\"form-select\" id=\"sayfa_url\" name=\"sayfa_url\">\r\n+                                        <option value=\"\">Önce menü seçiniz...</option>\r\n+                                    </select>\r\n+                                    <small class=\"form-text text-muted\">Seçilen menünün PHP dosyaları listelenir.</small>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"sayfa_aciklama\" class=\"form-label\">Açıklama</label>\r\n                                     <textarea class=\"form-control\" id=\"sayfa_aciklama\" name=\"aciklama\" rows=\"2\" \r\n@@ -1139,9 +1169,9 @@\n                         </select>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_sayfa_menu_id\" class=\"form-label\">Menü</label>\r\n-                        <select class=\"form-select\" id=\"edit_sayfa_menu_id\" name=\"menu_id\" required>\r\n+                        <select class=\"form-select\" id=\"edit_sayfa_menu_id\" name=\"menu_id\" required onchange=\"updateEditSayfaUrlDropdown()\">\r\n                             <option value=\"\">Önce modül seçiniz...</option>\r\n                         </select>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n@@ -1149,9 +1179,12 @@\n                         <input type=\"text\" class=\"form-control\" id=\"edit_sayfa_adi\" name=\"sayfa_adi\" required>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_sayfa_url\" class=\"form-label\">Sayfa URL</label>\r\n-                        <input type=\"text\" class=\"form-control\" id=\"edit_sayfa_url\" name=\"sayfa_url\">\r\n+                        <select class=\"form-select\" id=\"edit_sayfa_url\" name=\"sayfa_url\">\r\n+                            <option value=\"\">PHP dosyası seçiniz...</option>\r\n+                        </select>\r\n+                        <small class=\"form-text text-muted\">Seçilen menünün PHP dosyaları listelenir.</small>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_sayfa_aciklama\" class=\"form-label\">Açıklama</label>\r\n                         <textarea class=\"form-control\" id=\"edit_sayfa_aciklama\" name=\"aciklama\" rows=\"2\"></textarea>\r\n@@ -1244,10 +1277,12 @@\n // Menü verilerini JavaScript'e aktar\r\n const menulerData = <?php echo json_encode($menuler); ?>;\r\n const sayfalarData = <?php echo json_encode($sayfalar); ?>;\r\n const viewSubFolders = <?php echo json_encode($viewSubFolders); ?>;\r\n+const viewFiles = <?php echo json_encode($viewFiles); ?>;\r\n const modullerData = <?php echo json_encode($moduller); ?>;\r\n const usedMenuUrls = <?php echo json_encode($usedMenuUrls); ?>;\r\n+const usedSayfaUrls = <?php echo json_encode($usedSayfaUrls); ?>;\r\n \r\n // Menü tanımı için modül seçildiğinde URL dropdown'unu güncelle\r\n function updateMenuUrlDropdown() {\r\n     const modulId = document.getElementById('menu_modul_id').value;\r\n@@ -1291,10 +1326,12 @@\n // Sayfa tanımı için menü dropdown güncelleme\r\n function updateMenuDropdown() {\r\n     const modulId = document.getElementById('sayfa_modul_id').value;\r\n     const menuDropdown = document.getElementById('sayfa_menu_id');\r\n+    const urlDropdown = document.getElementById('sayfa_url');\r\n     \r\n     menuDropdown.innerHTML = '<option value=\"\">Menü seçiniz...</option>';\r\n+    urlDropdown.innerHTML = '<option value=\"\">Önce menü seçiniz...</option>';\r\n     \r\n     if (modulId) {\r\n         const filteredMenuler = menulerData.filter(m => m.modul_id == modulId && m.durum == 1);\r\n         filteredMenuler.forEach(menu => {\r\n@@ -1305,8 +1342,43 @@\n         });\r\n     }\r\n }\r\n \r\n+// Sayfa tanımı için URL dropdown güncelleme\r\n+function updateSayfaUrlDropdown() {\r\n+    const menuId = document.getElementById('sayfa_menu_id').value;\r\n+    const urlDropdown = document.getElementById('sayfa_url');\r\n+    \r\n+    urlDropdown.innerHTML = '<option value=\"\">PHP dosyası seçiniz...</option>';\r\n+    \r\n+    if (menuId) {\r\n+        // Seçilen menünün modül ve menu_url bilgisini bul\r\n+        const selectedMenu = menulerData.find(m => m.menu_id == menuId);\r\n+        if (selectedMenu) {\r\n+            const selectedModul = modullerData.find(m => m.modul_id == selectedMenu.modul_id);\r\n+            if (selectedModul && selectedModul.modul_url && selectedMenu.menu_url) {\r\n+                const modulFolder = selectedModul.modul_url.replace(/^\\//, '');\r\n+                const menuFolder = selectedMenu.menu_url;\r\n+                \r\n+                // Bu menü için kullanılmış URL'leri al\r\n+                const usedUrls = usedSayfaUrls[menuId] || usedSayfaUrls[String(menuId)] || [];\r\n+                \r\n+                // PHP dosyalarını getir ve kullanılmayanları listele\r\n+                if (viewFiles[modulFolder] && viewFiles[modulFolder][menuFolder]) {\r\n+                    viewFiles[modulFolder][menuFolder].forEach(file => {\r\n+                        if (!usedUrls.includes(file)) {\r\n+                            const option = document.createElement('option');\r\n+                            option.value = file;\r\n+                            option.textContent = file;\r\n+                            urlDropdown.appendChild(option);\r\n+                        }\r\n+                    });\r\n+                }\r\n+            }\r\n+        }\r\n+    }\r\n+}\r\n+\r\n // Yetki tanımı için menü dropdown güncelleme\r\n function updateYetkiMenuDropdown() {\r\n     const modulId = document.getElementById('yetki_modul_id').value;\r\n     const menuDropdown = document.getElementById('yetki_menu_id');\r\n@@ -1415,26 +1487,70 @@\n // Sayfa düzenleme\r\n function editSayfa(sayfa) {\r\n     document.getElementById('edit_sayfa_id').value = sayfa.sayfa_id;\r\n     document.getElementById('edit_sayfa_adi').value = sayfa.sayfa_adi;\r\n-    document.getElementById('edit_sayfa_url').value = sayfa.sayfa_url || '';\r\n     document.getElementById('edit_sayfa_aciklama').value = sayfa.aciklama || '';\r\n     document.getElementById('edit_sayfa_durum').value = sayfa.durum;\r\n     \r\n     // Menü seçimi için modül bulup menü dropdown'unu doldur\r\n     const menu = menulerData.find(m => m.menu_id == sayfa.menu_id);\r\n     if (menu) {\r\n         document.getElementById('edit_sayfa_modul_id').value = menu.modul_id;\r\n         updateEditSayfaMenuDropdown();\r\n-        // Dropdown dolduktan sonra menüyü seç\r\n+        // Dropdown dolduktan sonra menüyü ve URL'yi seç\r\n         setTimeout(() => {\r\n             document.getElementById('edit_sayfa_menu_id').value = sayfa.menu_id;\r\n+            updateEditSayfaUrlDropdown();\r\n+            \r\n+            // URL dropdown dolduktan sonra mevcut URL'yi seç\r\n+            setTimeout(() => {\r\n+                const urlDropdown = document.getElementById('edit_sayfa_url');\r\n+                if (sayfa.sayfa_url) {\r\n+                    const existingOption = Array.from(urlDropdown.options).find(opt => opt.value === sayfa.sayfa_url);\r\n+                    if (!existingOption) {\r\n+                        const option = document.createElement('option');\r\n+                        option.value = sayfa.sayfa_url;\r\n+                        option.textContent = sayfa.sayfa_url + ' (mevcut)';\r\n+                        urlDropdown.appendChild(option);\r\n+                    }\r\n+                    urlDropdown.value = sayfa.sayfa_url;\r\n+                }\r\n+            }, 100);\r\n         }, 100);\r\n     }\r\n     \r\n     new bootstrap.Modal(document.getElementById('editSayfaModal')).show();\r\n }\r\n \r\n+// Sayfa düzenleme modalı için URL dropdown güncelleme\r\n+function updateEditSayfaUrlDropdown() {\r\n+    const menuId = document.getElementById('edit_sayfa_menu_id').value;\r\n+    const urlDropdown = document.getElementById('edit_sayfa_url');\r\n+    \r\n+    urlDropdown.innerHTML = '<option value=\"\">PHP dosyası seçiniz...</option>';\r\n+    \r\n+    if (menuId) {\r\n+        const selectedMenu = menulerData.find(m => m.menu_id == menuId);\r\n+        if (selectedMenu) {\r\n+            const selectedModul = modullerData.find(m => m.modul_id == selectedMenu.modul_id);\r\n+            if (selectedModul && selectedModul.modul_url && selectedMenu.menu_url) {\r\n+                const modulFolder = selectedModul.modul_url.replace(/^\\//, '');\r\n+                const menuFolder = selectedMenu.menu_url;\r\n+                \r\n+                // Düzenleme modunda tüm dosyaları göster (filtreleme yapma)\r\n+                if (viewFiles[modulFolder] && viewFiles[modulFolder][menuFolder]) {\r\n+                    viewFiles[modulFolder][menuFolder].forEach(file => {\r\n+                        const option = document.createElement('option');\r\n+                        option.value = file;\r\n+                        option.textContent = file;\r\n+                        urlDropdown.appendChild(option);\r\n+                    });\r\n+                }\r\n+            }\r\n+        }\r\n+    }\r\n+}\r\n+\r\n // Sayfa düzenleme modalı için menü dropdown güncelleme\r\n function updateEditSayfaMenuDropdown() {\r\n     const modulId = document.getElementById('edit_sayfa_modul_id').value;\r\n     const menuDropdown = document.getElementById('edit_sayfa_menu_id');\r\n"
                },
                {
                    "date": 1761055100018,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,8 +39,10 @@\n                 } else {\r\n                     $modulUrl = null;\r\n                 }\r\n                 $aciklama = trim($_POST['aciklama'] ?? '');\r\n+                $modulIkon = trim($_POST['modul_ikon'] ?? '');\r\n+                $siraNo = (int)($_POST['sira_no'] ?? 0);\r\n                 $durum = $_POST['durum'] ?? 1;\r\n                 \r\n                 if (empty($modulAdi)) {\r\n                     $message = 'Modül adı alanı zorunludur.';\r\n@@ -58,12 +60,12 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n-                $sql = \"INSERT INTO tanim_moduller (modul_adi, modul_url, aciklama, durum, created_at) \r\n-                        VALUES (?, ?, ?, ?, GETDATE())\";\r\n+                $sql = \"INSERT INTO tanim_moduller (modul_adi, modul_url, aciklama, modul_ikon, sira_no, durum, created_at) \r\n+                        VALUES (?, ?, ?, ?, ?, ?, GETDATE())\";\r\n                 $stmt = $conn->prepare($sql);\r\n-                $stmt->execute([$modulAdi, $modulUrl, $aciklama, $durum]);\r\n+                $stmt->execute([$modulAdi, $modulUrl, $aciklama, $modulIkon, $siraNo, $durum]);\r\n                 \r\n                 $message = 'Modül başarıyla tanımlandı.';\r\n                 $messageType = 'success';\r\n                 break;\r\n@@ -80,8 +82,10 @@\n                 } else {\r\n                     $modulUrl = null;\r\n                 }\r\n                 $aciklama = trim($_POST['aciklama'] ?? '');\r\n+                $modulIkon = trim($_POST['modul_ikon'] ?? '');\r\n+                $siraNo = (int)($_POST['sira_no'] ?? 0);\r\n                 $durum = $_POST['durum'] ?? 1;\r\n                 \r\n                 if ($modulId <= 0) {\r\n                     $message = 'Geçersiz modül ID.';\r\n@@ -105,12 +109,12 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n-                $sql = \"UPDATE tanim_moduller SET modul_adi = ?, modul_url = ?, aciklama = ?, durum = ?, updated_at = GETDATE() \r\n+                $sql = \"UPDATE tanim_moduller SET modul_adi = ?, modul_url = ?, aciklama = ?, modul_ikon = ?, sira_no = ?, durum = ?, updated_at = GETDATE() \r\n                         WHERE modul_id = ?\";\r\n                 $stmt = $conn->prepare($sql);\r\n-                $stmt->execute([$modulAdi, $modulUrl, $aciklama, $durum, $modulId]);\r\n+                $stmt->execute([$modulAdi, $modulUrl, $aciklama, $modulIkon, $siraNo, $durum, $modulId]);\r\n                 \r\n                 $message = 'Modül başarıyla güncellendi.';\r\n                 $messageType = 'success';\r\n                 break;\r\n@@ -184,8 +188,10 @@\n                 $menuId = (int)$_POST['menu_id'];\r\n                 $sayfaAdi = trim($_POST['sayfa_adi']);\r\n                 $sayfaUrl = trim($_POST['sayfa_url']);\r\n                 $aciklama = trim($_POST['aciklama'] ?? '');\r\n+                $sayfaIkon = trim($_POST['sayfa_ikon'] ?? '');\r\n+                $siraNo = (int)($_POST['sira_no'] ?? 0);\r\n                 $durum = $_POST['durum'] ?? 1;\r\n                 \r\n                 if ($menuId <= 0) {\r\n                     $message = 'Lütfen bir menü seçiniz.';\r\n@@ -198,12 +204,12 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n-                $sql = \"INSERT INTO tanim_sayfalar (menu_id, sayfa_adi, sayfa_url, aciklama, durum, created_at) \r\n-                        VALUES (?, ?, ?, ?, ?, GETDATE())\";\r\n+                $sql = \"INSERT INTO tanim_sayfalar (menu_id, sayfa_adi, sayfa_url, aciklama, sayfa_ikon, sira_no, durum, created_at) \r\n+                        VALUES (?, ?, ?, ?, ?, ?, ?, GETDATE())\";\r\n                 $stmt = $conn->prepare($sql);\r\n-                $stmt->execute([$menuId, $sayfaAdi, $sayfaUrl, $aciklama, $durum]);\r\n+                $stmt->execute([$menuId, $sayfaAdi, $sayfaUrl, $aciklama, $sayfaIkon, $siraNo, $durum]);\r\n                 \r\n                 $message = 'Sayfa başarıyla tanımlandı.';\r\n                 $messageType = 'success';\r\n                 break;\r\n@@ -213,8 +219,10 @@\n                 $menuId = (int)$_POST['menu_id'];\r\n                 $sayfaAdi = trim($_POST['sayfa_adi']);\r\n                 $sayfaUrl = trim($_POST['sayfa_url']);\r\n                 $aciklama = trim($_POST['aciklama'] ?? '');\r\n+                $sayfaIkon = trim($_POST['sayfa_ikon'] ?? '');\r\n+                $siraNo = (int)($_POST['sira_no'] ?? 0);\r\n                 $durum = $_POST['durum'] ?? 1;\r\n                 \r\n                 if ($sayfaId <= 0) {\r\n                     $message = 'Geçersiz sayfa ID.';\r\n@@ -233,12 +241,12 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n-                $sql = \"UPDATE tanim_sayfalar SET menu_id = ?, sayfa_adi = ?, sayfa_url = ?, aciklama = ?, durum = ?, updated_at = GETDATE() \r\n+                $sql = \"UPDATE tanim_sayfalar SET menu_id = ?, sayfa_adi = ?, sayfa_url = ?, aciklama = ?, sayfa_ikon = ?, sira_no = ?, durum = ?, updated_at = GETDATE() \r\n                         WHERE sayfa_id = ?\";\r\n                 $stmt = $conn->prepare($sql);\r\n-                $stmt->execute([$menuId, $sayfaAdi, $sayfaUrl, $aciklama, $durum, $sayfaId]);\r\n+                $stmt->execute([$menuId, $sayfaAdi, $sayfaUrl, $aciklama, $sayfaIkon, $siraNo, $durum, $sayfaId]);\r\n                 \r\n                 $message = 'Sayfa başarıyla güncellendi.';\r\n                 $messageType = 'success';\r\n                 break;\r\n@@ -563,8 +571,17 @@\n                                     <textarea class=\"form-control\" id=\"modul_aciklama\" name=\"aciklama\" rows=\"2\" \r\n                                               placeholder=\"Modül açıklaması...\"></textarea>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n+                                    <label for=\"modul_ikon\" class=\"form-label\">İkon</label>\r\n+                                    <input type=\"text\" class=\"form-control\" id=\"modul_ikon\" name=\"modul_ikon\" \r\n+                                           placeholder=\"Örn: fa-cube\">\r\n+                                </div>\r\n+                                <div class=\"mb-3\">\r\n+                                    <label for=\"modul_sira_no\" class=\"form-label\">Sıra No</label>\r\n+                                    <input type=\"number\" class=\"form-control\" id=\"modul_sira_no\" name=\"sira_no\" value=\"0\">\r\n+                                </div>\r\n+                                <div class=\"mb-3\">\r\n                                     <label for=\"modul_durum\" class=\"form-label\">Durum</label>\r\n                                     <select class=\"form-select\" id=\"modul_durum\" name=\"durum\">\r\n                                         <option value=\"1\">Aktif</option>\r\n                                         <option value=\"0\">Pasif</option>\r\n@@ -589,9 +606,10 @@\n                                         <tr>\r\n                                             <th>ID</th>\r\n                                             <th>Modül Adı</th>\r\n                                             <th>URL</th>\r\n-                                            <th>Açıklama</th>\r\n+                                            <th>İkon</th>\r\n+                                            <th>Sıra</th>\r\n                                             <th>Durum</th>\r\n                                             <th>İşlemler</th>\r\n                                         </tr>\r\n                                     </thead>\r\n@@ -601,9 +619,10 @@\n                                                 <tr>\r\n                                                     <td><?php echo $modul['modul_id']; ?></td>\r\n                                                     <td><strong><?php echo htmlspecialchars($modul['modul_adi']); ?></strong></td>\r\n                                                     <td><?php echo htmlspecialchars($modul['modul_url'] ?? '-'); ?></td>\r\n-                                                    <td><?php echo htmlspecialchars($modul['aciklama'] ?? '-'); ?></td>\r\n+                                                    <td><i class=\"fas <?php echo htmlspecialchars($modul['modul_ikon'] ?? ''); ?>\"></i></td>\r\n+                                                    <td><?php echo $modul['sira_no'] ?? 0; ?></td>\r\n                                                     <td>\r\n                                                         <span class=\"badge bg-<?php echo $modul['durum'] == 1 ? 'success' : 'secondary'; ?>\">\r\n                                                             <?php echo $modul['durum'] == 1 ? 'Aktif' : 'Pasif'; ?>\r\n                                                         </span>\r\n@@ -617,9 +636,9 @@\n                                                 </tr>\r\n                                             <?php endforeach; ?>\r\n                                         <?php else: ?>\r\n                                             <tr>\r\n-                                                <td colspan=\"6\" class=\"text-center py-4 text-muted\">Henüz modül tanımlanmamış</td>\r\n+                                                <td colspan=\"7\" class=\"text-center py-4 text-muted\">Henüz modül tanımlanmamış</td>\r\n                                             </tr>\r\n                                         <?php endif; ?>\r\n                                     </tbody>\r\n                                 </table>\r\n@@ -793,8 +812,17 @@\n                                     <textarea class=\"form-control\" id=\"sayfa_aciklama\" name=\"aciklama\" rows=\"2\" \r\n                                               placeholder=\"Sayfa açıklaması...\"></textarea>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n+                                    <label for=\"sayfa_ikon\" class=\"form-label\">İkon</label>\r\n+                                    <input type=\"text\" class=\"form-control\" id=\"sayfa_ikon\" name=\"sayfa_ikon\" \r\n+                                           placeholder=\"Örn: fa-file\">\r\n+                                </div>\r\n+                                <div class=\"mb-3\">\r\n+                                    <label for=\"sayfa_sira_no\" class=\"form-label\">Sıra No</label>\r\n+                                    <input type=\"number\" class=\"form-control\" id=\"sayfa_sira_no\" name=\"sira_no\" value=\"0\">\r\n+                                </div>\r\n+                                <div class=\"mb-3\">\r\n                                     <label for=\"sayfa_durum\" class=\"form-label\">Durum</label>\r\n                                     <select class=\"form-select\" id=\"sayfa_durum\" name=\"durum\">\r\n                                         <option value=\"1\">Aktif</option>\r\n                                         <option value=\"0\">Pasif</option>\r\n@@ -821,8 +849,10 @@\n                                             <th>Modül</th>\r\n                                             <th>Menü</th>\r\n                                             <th>Sayfa Adı</th>\r\n                                             <th>URL</th>\r\n+                                            <th>İkon</th>\r\n+                                            <th>Sıra</th>\r\n                                             <th>Durum</th>\r\n                                             <th>İşlemler</th>\r\n                                         </tr>\r\n                                     </thead>\r\n@@ -834,8 +864,10 @@\n                                                     <td><?php echo htmlspecialchars($sayfa['modul_adi'] ?? '-'); ?></td>\r\n                                                     <td><?php echo htmlspecialchars($sayfa['menu_adi'] ?? '-'); ?></td>\r\n                                                     <td><strong><?php echo htmlspecialchars($sayfa['sayfa_adi']); ?></strong></td>\r\n                                                     <td><?php echo htmlspecialchars($sayfa['sayfa_url'] ?? '-'); ?></td>\r\n+                                                    <td><i class=\"fas <?php echo htmlspecialchars($sayfa['sayfa_ikon'] ?? ''); ?>\"></i></td>\r\n+                                                    <td><?php echo $sayfa['sira_no'] ?? 0; ?></td>\r\n                                                     <td>\r\n                                                         <span class=\"badge bg-<?php echo $sayfa['durum'] == 1 ? 'success' : 'secondary'; ?>\">\r\n                                                             <?php echo $sayfa['durum'] == 1 ? 'Aktif' : 'Pasif'; ?>\r\n                                                         </span>\r\n@@ -849,9 +881,9 @@\n                                                 </tr>\r\n                                             <?php endforeach; ?>\r\n                                         <?php else: ?>\r\n                                             <tr>\r\n-                                                <td colspan=\"7\" class=\"text-center py-4 text-muted\">Henüz sayfa tanımlanmamış</td>\r\n+                                                <td colspan=\"9\" class=\"text-center py-4 text-muted\">Henüz sayfa tanımlanmamış</td>\r\n                                             </tr>\r\n                                         <?php endif; ?>\r\n                                     </tbody>\r\n                                 </table>\r\n@@ -1057,8 +1089,17 @@\n                         <label for=\"edit_modul_aciklama\" class=\"form-label\">Açıklama</label>\r\n                         <textarea class=\"form-control\" id=\"edit_modul_aciklama\" name=\"aciklama\" rows=\"2\"></textarea>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n+                        <label for=\"edit_modul_ikon\" class=\"form-label\">İkon</label>\r\n+                        <input type=\"text\" class=\"form-control\" id=\"edit_modul_ikon\" name=\"modul_ikon\" \r\n+                               placeholder=\"Örn: fa-cube\">\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_modul_sira_no\" class=\"form-label\">Sıra No</label>\r\n+                        <input type=\"number\" class=\"form-control\" id=\"edit_modul_sira_no\" name=\"sira_no\" value=\"0\">\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n                         <label for=\"edit_modul_durum\" class=\"form-label\">Durum</label>\r\n                         <select class=\"form-select\" id=\"edit_modul_durum\" name=\"durum\">\r\n                             <option value=\"1\">Aktif</option>\r\n                             <option value=\"0\">Pasif</option>\r\n@@ -1189,8 +1230,17 @@\n                         <label for=\"edit_sayfa_aciklama\" class=\"form-label\">Açıklama</label>\r\n                         <textarea class=\"form-control\" id=\"edit_sayfa_aciklama\" name=\"aciklama\" rows=\"2\"></textarea>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n+                        <label for=\"edit_sayfa_ikon\" class=\"form-label\">İkon</label>\r\n+                        <input type=\"text\" class=\"form-control\" id=\"edit_sayfa_ikon\" name=\"sayfa_ikon\" \r\n+                               placeholder=\"Örn: fa-file\">\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_sayfa_sira_no\" class=\"form-label\">Sıra No</label>\r\n+                        <input type=\"number\" class=\"form-control\" id=\"edit_sayfa_sira_no\" name=\"sira_no\" value=\"0\">\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n                         <label for=\"edit_sayfa_durum\" class=\"form-label\">Durum</label>\r\n                         <select class=\"form-select\" id=\"edit_sayfa_durum\" name=\"durum\">\r\n                             <option value=\"1\">Aktif</option>\r\n                             <option value=\"0\">Pasif</option>\r\n@@ -1421,8 +1471,10 @@\n     document.getElementById('edit_modul_id').value = modul.modul_id;\r\n     document.getElementById('edit_modul_adi').value = modul.modul_adi;\r\n     document.getElementById('edit_modul_url').value = modul.modul_url || '';\r\n     document.getElementById('edit_modul_aciklama').value = modul.aciklama || '';\r\n+    document.getElementById('edit_modul_ikon').value = modul.modul_ikon || '';\r\n+    document.getElementById('edit_modul_sira_no').value = modul.sira_no || 0;\r\n     document.getElementById('edit_modul_durum').value = modul.durum;\r\n     \r\n     new bootstrap.Modal(document.getElementById('editModulModal')).show();\r\n }\r\n@@ -1488,8 +1540,10 @@\n function editSayfa(sayfa) {\r\n     document.getElementById('edit_sayfa_id').value = sayfa.sayfa_id;\r\n     document.getElementById('edit_sayfa_adi').value = sayfa.sayfa_adi;\r\n     document.getElementById('edit_sayfa_aciklama').value = sayfa.aciklama || '';\r\n+    document.getElementById('edit_sayfa_ikon').value = sayfa.sayfa_ikon || '';\r\n+    document.getElementById('edit_sayfa_sira_no').value = sayfa.sira_no || 0;\r\n     document.getElementById('edit_sayfa_durum').value = sayfa.durum;\r\n     \r\n     // Menü seçimi için modül bulup menü dropdown'unu doldur\r\n     const menu = menulerData.find(m => m.menu_id == sayfa.menu_id);\r\n"
                },
                {
                    "date": 1761115677790,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -572,10 +572,26 @@\n                                               placeholder=\"Modül açıklaması...\"></textarea>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"modul_ikon\" class=\"form-label\">İkon</label>\r\n-                                    <input type=\"text\" class=\"form-control\" id=\"modul_ikon\" name=\"modul_ikon\" \r\n-                                           placeholder=\"Örn: fa-cube\">\r\n+                                    <select class=\"form-select icon-select\" id=\"modul_ikon\" name=\"modul_ikon\">\r\n+                                        <option value=\"\">İkon seçiniz...</option>\r\n+                                        <option value=\"fa-cube\">&#xf1b2; fa-cube (Küp)</option>\r\n+                                        <option value=\"fa-home\">&#xf015; fa-home (Ev)</option>\r\n+                                        <option value=\"fa-dashboard\">&#xf0e4; fa-dashboard (Panel)</option>\r\n+                                        <option value=\"fa-cog\">&#xf013; fa-cog (Ayar)</option>\r\n+                                        <option value=\"fa-users\">&#xf0c0; fa-users (Kullanıcılar)</option>\r\n+                                        <option value=\"fa-user\">&#xf007; fa-user (Kullanıcı)</option>\r\n+                                        <option value=\"fa-building\">&#xf1ad; fa-building (Bina)</option>\r\n+                                        <option value=\"fa-chart-bar\">&#xf080; fa-chart-bar (Grafik)</option>\r\n+                                        <option value=\"fa-briefcase\">&#xf0b1; fa-briefcase (Çanta)</option>\r\n+                                        <option value=\"fa-money\">&#xf0d6; fa-money (Para)</option>\r\n+                                        <option value=\"fa-file-alt\">&#xf15c; fa-file-alt (Dosya)</option>\r\n+                                        <option value=\"fa-database\">&#xf1c0; fa-database (Veritabanı)</option>\r\n+                                        <option value=\"fa-box\">&#xf466; fa-box (Kutu)</option>\r\n+                                        <option value=\"fa-tasks\">&#xf0ae; fa-tasks (Görevler)</option>\r\n+                                        <option value=\"fa-shield-alt\">&#xf3ed; fa-shield-alt (Kalkan)</option>\r\n+                                    </select>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"modul_sira_no\" class=\"form-label\">Sıra No</label>\r\n                                     <input type=\"number\" class=\"form-control\" id=\"modul_sira_no\" name=\"sira_no\" value=\"0\">\r\n@@ -686,10 +702,26 @@\n                                     <small class=\"form-text text-muted\">Seçilen modülün alt klasörleri listelenir.</small>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"menu_ikon\" class=\"form-label\">İkon</label>\r\n-                                    <input type=\"text\" class=\"form-control\" id=\"menu_ikon\" name=\"ikon\" \r\n-                                           placeholder=\"Örn: fa-list\">\r\n+                                    <select class=\"form-select icon-select\" id=\"menu_ikon\" name=\"ikon\">\r\n+                                        <option value=\"\">İkon seçiniz...</option>\r\n+                                        <option value=\"fa-list\">&#xf03a; fa-list (Liste)</option>\r\n+                                        <option value=\"fa-bars\">&#xf0c9; fa-bars (Menü)</option>\r\n+                                        <option value=\"fa-th\">&#xf00a; fa-th (Izgara)</option>\r\n+                                        <option value=\"fa-folder\">&#xf07b; fa-folder (Klasör)</option>\r\n+                                        <option value=\"fa-cog\">&#xf013; fa-cog (Ayar)</option>\r\n+                                        <option value=\"fa-wrench\">&#xf0ad; fa-wrench (Anahtar)</option>\r\n+                                        <option value=\"fa-chart-line\">&#xf201; fa-chart-line (Grafik)</option>\r\n+                                        <option value=\"fa-table\">&#xf0ce; fa-table (Tablo)</option>\r\n+                                        <option value=\"fa-file-invoice\">&#xf570; fa-file-invoice (Fatura)</option>\r\n+                                        <option value=\"fa-calculator\">&#xf1ec; fa-calculator (Hesap Mak.)</option>\r\n+                                        <option value=\"fa-dollar-sign\">&#xf155; fa-dollar-sign (Dolar)</option>\r\n+                                        <option value=\"fa-percentage\">&#xf295; fa-percentage (Yüzde)</option>\r\n+                                        <option value=\"fa-receipt\">&#xf543; fa-receipt (Fiş)</option>\r\n+                                        <option value=\"fa-credit-card\">&#xf09d; fa-credit-card (Kart)</option>\r\n+                                        <option value=\"fa-shopping-cart\">&#xf07a; fa-shopping-cart (Sepet)</option>\r\n+                                    </select>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"menu_sira_no\" class=\"form-label\">Sıra No</label>\r\n                                     <input type=\"number\" class=\"form-control\" id=\"menu_sira_no\" name=\"sira_no\" value=\"0\">\r\n@@ -813,10 +845,26 @@\n                                               placeholder=\"Sayfa açıklaması...\"></textarea>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"sayfa_ikon\" class=\"form-label\">İkon</label>\r\n-                                    <input type=\"text\" class=\"form-control\" id=\"sayfa_ikon\" name=\"sayfa_ikon\" \r\n-                                           placeholder=\"Örn: fa-file\">\r\n+                                    <select class=\"form-select icon-select\" id=\"sayfa_ikon\" name=\"sayfa_ikon\">\r\n+                                        <option value=\"\">İkon seçiniz...</option>\r\n+                                        <option value=\"fa-file\">&#xf15b; fa-file (Dosya)</option>\r\n+                                        <option value=\"fa-file-alt\">&#xf15c; fa-file-alt (Döküman)</option>\r\n+                                        <option value=\"fa-file-text\">&#xf15c; fa-file-text (Metin)</option>\r\n+                                        <option value=\"fa-file-invoice\">&#xf570; fa-file-invoice (Fatura)</option>\r\n+                                        <option value=\"fa-clipboard\">&#xf328; fa-clipboard (Pano)</option>\r\n+                                        <option value=\"fa-edit\">&#xf044; fa-edit (Düzenle)</option>\r\n+                                        <option value=\"fa-plus-square\">&#xf0fe; fa-plus-square (Ekle)</option>\r\n+                                        <option value=\"fa-list-alt\">&#xf022; fa-list-alt (Liste)</option>\r\n+                                        <option value=\"fa-check-square\">&#xf14a; fa-check-square (İşaretle)</option>\r\n+                                        <option value=\"fa-calendar\">&#xf133; fa-calendar (Takvim)</option>\r\n+                                        <option value=\"fa-chart-pie\">&#xf200; fa-chart-pie (Pasta Gr.)</option>\r\n+                                        <option value=\"fa-tasks\">&#xf0ae; fa-tasks (Görevler)</option>\r\n+                                        <option value=\"fa-user-check\">&#xf4fc; fa-user-check (Onay)</option>\r\n+                                        <option value=\"fa-handshake\">&#xf2b5; fa-handshake (Anlaşma)</option>\r\n+                                        <option value=\"fa-money-check\">&#xf53c; fa-money-check (Çek)</option>\r\n+                                    </select>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"sayfa_sira_no\" class=\"form-label\">Sıra No</label>\r\n                                     <input type=\"number\" class=\"form-control\" id=\"sayfa_sira_no\" name=\"sira_no\" value=\"0\">\r\n@@ -1090,10 +1138,26 @@\n                         <textarea class=\"form-control\" id=\"edit_modul_aciklama\" name=\"aciklama\" rows=\"2\"></textarea>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_modul_ikon\" class=\"form-label\">İkon</label>\r\n-                        <input type=\"text\" class=\"form-control\" id=\"edit_modul_ikon\" name=\"modul_ikon\" \r\n-                               placeholder=\"Örn: fa-cube\">\r\n+                        <select class=\"form-select icon-select\" id=\"edit_modul_ikon\" name=\"modul_ikon\">\r\n+                            <option value=\"\">İkon seçiniz...</option>\r\n+                            <option value=\"fa-cube\">&#xf1b2; fa-cube (Küp)</option>\r\n+                            <option value=\"fa-home\">&#xf015; fa-home (Ev)</option>\r\n+                            <option value=\"fa-dashboard\">&#xf0e4; fa-dashboard (Panel)</option>\r\n+                            <option value=\"fa-cog\">&#xf013; fa-cog (Ayar)</option>\r\n+                            <option value=\"fa-users\">&#xf0c0; fa-users (Kullanıcılar)</option>\r\n+                            <option value=\"fa-user\">&#xf007; fa-user (Kullanıcı)</option>\r\n+                            <option value=\"fa-building\">&#xf1ad; fa-building (Bina)</option>\r\n+                            <option value=\"fa-chart-bar\">&#xf080; fa-chart-bar (Grafik)</option>\r\n+                            <option value=\"fa-briefcase\">&#xf0b1; fa-briefcase (Çanta)</option>\r\n+                            <option value=\"fa-money\">&#xf0d6; fa-money (Para)</option>\r\n+                            <option value=\"fa-file-alt\">&#xf15c; fa-file-alt (Dosya)</option>\r\n+                            <option value=\"fa-database\">&#xf1c0; fa-database (Veritabanı)</option>\r\n+                            <option value=\"fa-box\">&#xf466; fa-box (Kutu)</option>\r\n+                            <option value=\"fa-tasks\">&#xf0ae; fa-tasks (Görevler)</option>\r\n+                            <option value=\"fa-shield-alt\">&#xf3ed; fa-shield-alt (Kalkan)</option>\r\n+                        </select>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_modul_sira_no\" class=\"form-label\">Sıra No</label>\r\n                         <input type=\"number\" class=\"form-control\" id=\"edit_modul_sira_no\" name=\"sira_no\" value=\"0\">\r\n@@ -1156,9 +1220,26 @@\n                         <small class=\"form-text text-muted\">Seçilen modülün alt klasörleri listelenir.</small>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_menu_ikon\" class=\"form-label\">İkon</label>\r\n-                        <input type=\"text\" class=\"form-control\" id=\"edit_menu_ikon\" name=\"ikon\">\r\n+                        <select class=\"form-select icon-select\" id=\"edit_menu_ikon\" name=\"ikon\">\r\n+                            <option value=\"\">İkon seçiniz...</option>\r\n+                            <option value=\"fa-list\">&#xf03a; fa-list (Liste)</option>\r\n+                            <option value=\"fa-bars\">&#xf0c9; fa-bars (Menü)</option>\r\n+                            <option value=\"fa-th\">&#xf00a; fa-th (Izgara)</option>\r\n+                            <option value=\"fa-folder\">&#xf07b; fa-folder (Klasör)</option>\r\n+                            <option value=\"fa-cog\">&#xf013; fa-cog (Ayar)</option>\r\n+                            <option value=\"fa-wrench\">&#xf0ad; fa-wrench (Anahtar)</option>\r\n+                            <option value=\"fa-chart-line\">&#xf201; fa-chart-line (Grafik)</option>\r\n+                            <option value=\"fa-table\">&#xf0ce; fa-table (Tablo)</option>\r\n+                            <option value=\"fa-file-invoice\">&#xf570; fa-file-invoice (Fatura)</option>\r\n+                            <option value=\"fa-calculator\">&#xf1ec; fa-calculator (Hesap Mak.)</option>\r\n+                            <option value=\"fa-dollar-sign\">&#xf155; fa-dollar-sign (Dolar)</option>\r\n+                            <option value=\"fa-percentage\">&#xf295; fa-percentage (Yüzde)</option>\r\n+                            <option value=\"fa-receipt\">&#xf543; fa-receipt (Fiş)</option>\r\n+                            <option value=\"fa-credit-card\">&#xf09d; fa-credit-card (Kart)</option>\r\n+                            <option value=\"fa-shopping-cart\">&#xf07a; fa-shopping-cart (Sepet)</option>\r\n+                        </select>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_menu_sira_no\" class=\"form-label\">Sıra No</label>\r\n                         <input type=\"number\" class=\"form-control\" id=\"edit_menu_sira_no\" name=\"sira_no\">\r\n@@ -1231,10 +1312,26 @@\n                         <textarea class=\"form-control\" id=\"edit_sayfa_aciklama\" name=\"aciklama\" rows=\"2\"></textarea>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_sayfa_ikon\" class=\"form-label\">İkon</label>\r\n-                        <input type=\"text\" class=\"form-control\" id=\"edit_sayfa_ikon\" name=\"sayfa_ikon\" \r\n-                               placeholder=\"Örn: fa-file\">\r\n+                        <select class=\"form-select icon-select\" id=\"edit_sayfa_ikon\" name=\"sayfa_ikon\">\r\n+                            <option value=\"\">İkon seçiniz...</option>\r\n+                            <option value=\"fa-file\">&#xf15b; fa-file (Dosya)</option>\r\n+                            <option value=\"fa-file-alt\">&#xf15c; fa-file-alt (Döküman)</option>\r\n+                            <option value=\"fa-file-text\">&#xf15c; fa-file-text (Metin)</option>\r\n+                            <option value=\"fa-file-invoice\">&#xf570; fa-file-invoice (Fatura)</option>\r\n+                            <option value=\"fa-clipboard\">&#xf328; fa-clipboard (Pano)</option>\r\n+                            <option value=\"fa-edit\">&#xf044; fa-edit (Düzenle)</option>\r\n+                            <option value=\"fa-plus-square\">&#xf0fe; fa-plus-square (Ekle)</option>\r\n+                            <option value=\"fa-list-alt\">&#xf022; fa-list-alt (Liste)</option>\r\n+                            <option value=\"fa-check-square\">&#xf14a; fa-check-square (İşaretle)</option>\r\n+                            <option value=\"fa-calendar\">&#xf133; fa-calendar (Takvim)</option>\r\n+                            <option value=\"fa-chart-pie\">&#xf200; fa-chart-pie (Pasta Gr.)</option>\r\n+                            <option value=\"fa-tasks\">&#xf0ae; fa-tasks (Görevler)</option>\r\n+                            <option value=\"fa-user-check\">&#xf4fc; fa-user-check (Onay)</option>\r\n+                            <option value=\"fa-handshake\">&#xf2b5; fa-handshake (Anlaşma)</option>\r\n+                            <option value=\"fa-money-check\">&#xf53c; fa-money-check (Çek)</option>\r\n+                        </select>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_sayfa_sira_no\" class=\"form-label\">Sıra No</label>\r\n                         <input type=\"number\" class=\"form-control\" id=\"edit_sayfa_sira_no\" name=\"sira_no\" value=\"0\">\r\n@@ -1321,8 +1418,19 @@\n         </div>\r\n     </div>\r\n </div>\r\n \r\n+<style>\r\n+.icon-select {\r\n+    font-family: 'Font Awesome 5 Free', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\r\n+    font-weight: 900;\r\n+}\r\n+.icon-select option {\r\n+    padding: 8px;\r\n+    font-size: 14px;\r\n+}\r\n+</style>\r\n+\r\n <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\r\n <script>\r\n // Menü verilerini JavaScript'e aktar\r\n const menulerData = <?php echo json_encode($menuler); ?>;\r\n"
                },
                {
                    "date": 1761115990344,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -417,9 +417,9 @@\n         foreach ($iter as $fileinfo) {\r\n             if ($fileinfo->isDot() || !$fileinfo->isDir()) continue;\r\n             $folderName = $fileinfo->getFilename();\r\n             // Üst seviye klasörü ekle\r\n-            $viewFolders[] = '/' . $folderName;\r\n+            $viewFolders[] = $folderName;\r\n             \r\n             // Alt klasörleri tara (Menü için)\r\n             $subdir = $viewsBase . DIRECTORY_SEPARATOR . $folderName;\r\n             $subFolderList = [];\r\n@@ -1577,9 +1577,16 @@\n // Modül düzenleme\r\n function editModul(modul) {\r\n     document.getElementById('edit_modul_id').value = modul.modul_id;\r\n     document.getElementById('edit_modul_adi').value = modul.modul_adi;\r\n-    document.getElementById('edit_modul_url').value = modul.modul_url || '';\r\n+    \r\n+    // Veritabanından gelen URL'nin başındaki \"/\" varsa kaldır (dropdown ile uyumlu hale getir)\r\n+    let modulUrl = modul.modul_url || '';\r\n+    if (modulUrl && modulUrl[0] === '/') {\r\n+        modulUrl = modulUrl.substring(1);\r\n+    }\r\n+    document.getElementById('edit_modul_url').value = modulUrl;\r\n+    \r\n     document.getElementById('edit_modul_aciklama').value = modul.aciklama || '';\r\n     document.getElementById('edit_modul_ikon').value = modul.modul_ikon || '';\r\n     document.getElementById('edit_modul_sira_no').value = modul.sira_no || 0;\r\n     document.getElementById('edit_modul_durum').value = modul.durum;\r\n"
                },
                {
                    "date": 1761116253248,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -456,9 +456,10 @@\n }\r\n \r\n // Kullanılmış modül URL'lerini topla (filtreleme için)\r\n $usedModulUrls = array_column($moduller, 'modul_url');\r\n-$viewFolders = array_diff($viewFolders, $usedModulUrls);\r\n+$allViewFolders = $viewFolders; // Tüm klasörleri sakla (düzenleme için)\r\n+$viewFolders = array_diff($viewFolders, $usedModulUrls); // Yeni ekleme için filtrele\r\n \r\n // Kullanılmış menü URL'lerini modül bazında topla (filtreleme için)\r\n $usedMenuUrls = [];\r\n foreach ($menuler as $menu) {\r\n@@ -1126,9 +1127,9 @@\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_modul_url\" class=\"form-label\">Modül URL</label>\r\n                         <select class=\"form-select\" id=\"edit_modul_url\" name=\"modul_url\">\r\n                             <option value=\"\">Klasör seçiniz...</option>\r\n-                            <?php foreach ($viewFolders as $vf): ?>\r\n+                            <?php foreach ($allViewFolders as $vf): ?>\r\n                                 <option value=\"<?php echo htmlspecialchars($vf); ?>\"><?php echo htmlspecialchars($vf); ?></option>\r\n                             <?php endforeach; ?>\r\n                         </select>\r\n                         <small class=\"form-text text-muted\">View klasörlerinden seçiniz.</small>\r\n@@ -1577,16 +1578,9 @@\n // Modül düzenleme\r\n function editModul(modul) {\r\n     document.getElementById('edit_modul_id').value = modul.modul_id;\r\n     document.getElementById('edit_modul_adi').value = modul.modul_adi;\r\n-    \r\n-    // Veritabanından gelen URL'nin başındaki \"/\" varsa kaldır (dropdown ile uyumlu hale getir)\r\n-    let modulUrl = modul.modul_url || '';\r\n-    if (modulUrl && modulUrl[0] === '/') {\r\n-        modulUrl = modulUrl.substring(1);\r\n-    }\r\n-    document.getElementById('edit_modul_url').value = modulUrl;\r\n-    \r\n+    document.getElementById('edit_modul_url').value = modul.modul_url || '';\r\n     document.getElementById('edit_modul_aciklama').value = modul.aciklama || '';\r\n     document.getElementById('edit_modul_ikon').value = modul.modul_ikon || '';\r\n     document.getElementById('edit_modul_sira_no').value = modul.sira_no || 0;\r\n     document.getElementById('edit_modul_durum').value = modul.durum;\r\n"
                },
                {
                    "date": 1761118730240,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -191,8 +191,9 @@\n                 $aciklama = trim($_POST['aciklama'] ?? '');\r\n                 $sayfaIkon = trim($_POST['sayfa_ikon'] ?? '');\r\n                 $siraNo = (int)($_POST['sira_no'] ?? 0);\r\n                 $durum = $_POST['durum'] ?? 1;\r\n+                $dashboard = isset($_POST['dashboard']) ? 1 : 0;\r\n                 \r\n                 if ($menuId <= 0) {\r\n                     $message = 'Lütfen bir menü seçiniz.';\r\n                     $messageType = 'danger';\r\n@@ -204,12 +205,12 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n-                $sql = \"INSERT INTO tanim_sayfalar (menu_id, sayfa_adi, sayfa_url, aciklama, sayfa_ikon, sira_no, durum, created_at) \r\n-                        VALUES (?, ?, ?, ?, ?, ?, ?, GETDATE())\";\r\n+                $sql = \"INSERT INTO tanim_sayfalar (menu_id, sayfa_adi, sayfa_url, aciklama, sayfa_ikon, sira_no, durum, dashboard, created_at) \r\n+                        VALUES (?, ?, ?, ?, ?, ?, ?, ?, GETDATE())\";\r\n                 $stmt = $conn->prepare($sql);\r\n-                $stmt->execute([$menuId, $sayfaAdi, $sayfaUrl, $aciklama, $sayfaIkon, $siraNo, $durum]);\r\n+                $stmt->execute([$menuId, $sayfaAdi, $sayfaUrl, $aciklama, $sayfaIkon, $siraNo, $durum, $dashboard]);\r\n                 \r\n                 $message = 'Sayfa başarıyla tanımlandı.';\r\n                 $messageType = 'success';\r\n                 break;\r\n@@ -222,8 +223,9 @@\n                 $aciklama = trim($_POST['aciklama'] ?? '');\r\n                 $sayfaIkon = trim($_POST['sayfa_ikon'] ?? '');\r\n                 $siraNo = (int)($_POST['sira_no'] ?? 0);\r\n                 $durum = $_POST['durum'] ?? 1;\r\n+                $dashboard = isset($_POST['dashboard']) ? 1 : 0;\r\n                 \r\n                 if ($sayfaId <= 0) {\r\n                     $message = 'Geçersiz sayfa ID.';\r\n                     $messageType = 'danger';\r\n@@ -241,12 +243,12 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n-                $sql = \"UPDATE tanim_sayfalar SET menu_id = ?, sayfa_adi = ?, sayfa_url = ?, aciklama = ?, sayfa_ikon = ?, sira_no = ?, durum = ?, updated_at = GETDATE() \r\n+                $sql = \"UPDATE tanim_sayfalar SET menu_id = ?, sayfa_adi = ?, sayfa_url = ?, aciklama = ?, sayfa_ikon = ?, sira_no = ?, durum = ?, dashboard = ?, updated_at = GETDATE() \r\n                         WHERE sayfa_id = ?\";\r\n                 $stmt = $conn->prepare($sql);\r\n-                $stmt->execute([$menuId, $sayfaAdi, $sayfaUrl, $aciklama, $sayfaIkon, $siraNo, $durum, $sayfaId]);\r\n+                $stmt->execute([$menuId, $sayfaAdi, $sayfaUrl, $aciklama, $sayfaIkon, $siraNo, $durum, $dashboard, $sayfaId]);\r\n                 \r\n                 $message = 'Sayfa başarıyla güncellendi.';\r\n                 $messageType = 'success';\r\n                 break;\r\n@@ -870,8 +872,16 @@\n                                     <label for=\"sayfa_sira_no\" class=\"form-label\">Sıra No</label>\r\n                                     <input type=\"number\" class=\"form-control\" id=\"sayfa_sira_no\" name=\"sira_no\" value=\"0\">\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n+                                    <div class=\"form-check\">\r\n+                                        <input class=\"form-check-input\" type=\"checkbox\" name=\"dashboard\" id=\"sayfa_dashboard\" value=\"1\">\r\n+                                        <label class=\"form-check-label\" for=\"sayfa_dashboard\">\r\n+                                            Dashboard'da Göster\r\n+                                        </label>\r\n+                                    </div>\r\n+                                </div>\r\n+                                <div class=\"mb-3\">\r\n                                     <label for=\"sayfa_durum\" class=\"form-label\">Durum</label>\r\n                                     <select class=\"form-select\" id=\"sayfa_durum\" name=\"durum\">\r\n                                         <option value=\"1\">Aktif</option>\r\n                                         <option value=\"0\">Pasif</option>\r\n@@ -900,8 +910,9 @@\n                                             <th>Sayfa Adı</th>\r\n                                             <th>URL</th>\r\n                                             <th>İkon</th>\r\n                                             <th>Sıra</th>\r\n+                                            <th>Dashboard</th>\r\n                                             <th>Durum</th>\r\n                                             <th>İşlemler</th>\r\n                                         </tr>\r\n                                     </thead>\r\n@@ -916,8 +927,15 @@\n                                                     <td><?php echo htmlspecialchars($sayfa['sayfa_url'] ?? '-'); ?></td>\r\n                                                     <td><i class=\"fas <?php echo htmlspecialchars($sayfa['sayfa_ikon'] ?? ''); ?>\"></i></td>\r\n                                                     <td><?php echo $sayfa['sira_no'] ?? 0; ?></td>\r\n                                                     <td>\r\n+                                                        <?php if (!empty($sayfa['dashboard'])): ?>\r\n+                                                            <i class=\"fas fa-check text-success\"></i>\r\n+                                                        <?php else: ?>\r\n+                                                            <i class=\"fas fa-times text-muted\"></i>\r\n+                                                        <?php endif; ?>\r\n+                                                    </td>\r\n+                                                    <td>\r\n                                                         <span class=\"badge bg-<?php echo $sayfa['durum'] == 1 ? 'success' : 'secondary'; ?>\">\r\n                                                             <?php echo $sayfa['durum'] == 1 ? 'Aktif' : 'Pasif'; ?>\r\n                                                         </span>\r\n                                                     </td>\r\n@@ -930,9 +948,9 @@\n                                                 </tr>\r\n                                             <?php endforeach; ?>\r\n                                         <?php else: ?>\r\n                                             <tr>\r\n-                                                <td colspan=\"9\" class=\"text-center py-4 text-muted\">Henüz sayfa tanımlanmamış</td>\r\n+                                                <td colspan=\"10\" class=\"text-center py-4 text-muted\">Henüz sayfa tanımlanmamış</td>\r\n                                             </tr>\r\n                                         <?php endif; ?>\r\n                                     </tbody>\r\n                                 </table>\r\n@@ -1337,8 +1355,16 @@\n                         <label for=\"edit_sayfa_sira_no\" class=\"form-label\">Sıra No</label>\r\n                         <input type=\"number\" class=\"form-control\" id=\"edit_sayfa_sira_no\" name=\"sira_no\" value=\"0\">\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n+                        <div class=\"form-check\">\r\n+                            <input class=\"form-check-input\" type=\"checkbox\" name=\"dashboard\" id=\"edit_sayfa_dashboard\" value=\"1\">\r\n+                            <label class=\"form-check-label\" for=\"edit_sayfa_dashboard\">\r\n+                                Dashboard'da Göster\r\n+                            </label>\r\n+                        </div>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n                         <label for=\"edit_sayfa_durum\" class=\"form-label\">Durum</label>\r\n                         <select class=\"form-select\" id=\"edit_sayfa_durum\" name=\"durum\">\r\n                             <option value=\"1\">Aktif</option>\r\n                             <option value=\"0\">Pasif</option>\r\n@@ -1651,8 +1677,9 @@\n     document.getElementById('edit_sayfa_adi').value = sayfa.sayfa_adi;\r\n     document.getElementById('edit_sayfa_aciklama').value = sayfa.aciklama || '';\r\n     document.getElementById('edit_sayfa_ikon').value = sayfa.sayfa_ikon || '';\r\n     document.getElementById('edit_sayfa_sira_no').value = sayfa.sira_no || 0;\r\n+    document.getElementById('edit_sayfa_dashboard').checked = sayfa.dashboard == 1;\r\n     document.getElementById('edit_sayfa_durum').value = sayfa.durum;\r\n     \r\n     // Menü seçimi için modül bulup menü dropdown'unu doldur\r\n     const menu = menulerData.find(m => m.menu_id == sayfa.menu_id);\r\n"
                },
                {
                    "date": 1761119324709,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -60,14 +60,27 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n+                // Modül klasörünü oluştur\r\n+                if (!empty($modulUrl)) {\r\n+                    $viewsBase = dirname(__DIR__, 2);\r\n+                    $modulPath = $viewsBase . $modulUrl;\r\n+                    if (!is_dir($modulPath)) {\r\n+                        if (!mkdir($modulPath, 0755, true)) {\r\n+                            $message = 'Modül klasörü oluşturulamadı: ' . $modulPath;\r\n+                            $messageType = 'danger';\r\n+                            break;\r\n+                        }\r\n+                    }\r\n+                }\r\n+                \r\n                 $sql = \"INSERT INTO tanim_moduller (modul_adi, modul_url, aciklama, modul_ikon, sira_no, durum, created_at) \r\n                         VALUES (?, ?, ?, ?, ?, ?, GETDATE())\";\r\n                 $stmt = $conn->prepare($sql);\r\n                 $stmt->execute([$modulAdi, $modulUrl, $aciklama, $modulIkon, $siraNo, $durum]);\r\n                 \r\n-                $message = 'Modül başarıyla tanımlandı.';\r\n+                $message = 'Modül başarıyla tanımlandı ve klasör oluşturuldu.';\r\n                 $messageType = 'success';\r\n                 break;\r\n                 \r\n             case 'edit_modul':\r\n@@ -138,14 +151,35 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n+                // Menü klasörünü oluştur\r\n+                if (!empty($menuUrl)) {\r\n+                    // Modülün URL'sini bul\r\n+                    $modulSql = \"SELECT modul_url FROM tanim_moduller WHERE modul_id = ?\";\r\n+                    $modulStmt = $conn->prepare($modulSql);\r\n+                    $modulStmt->execute([$modulId]);\r\n+                    $modul = $modulStmt->fetch();\r\n+                    \r\n+                    if ($modul && !empty($modul['modul_url'])) {\r\n+                        $viewsBase = dirname(__DIR__, 2);\r\n+                        $menuPath = $viewsBase . $modul['modul_url'] . '/' . $menuUrl;\r\n+                        if (!is_dir($menuPath)) {\r\n+                            if (!mkdir($menuPath, 0755, true)) {\r\n+                                $message = 'Menü klasörü oluşturulamadı: ' . $menuPath;\r\n+                                $messageType = 'danger';\r\n+                                break;\r\n+                            }\r\n+                        }\r\n+                    }\r\n+                }\r\n+                \r\n                 $sql = \"INSERT INTO tanim_menuler (modul_id, menu_adi, menu_url, ikon, sira_no, durum, created_at) \r\n                         VALUES (?, ?, ?, ?, ?, ?, GETDATE())\";\r\n                 $stmt = $conn->prepare($sql);\r\n                 $stmt->execute([$modulId, $menuAdi, $menuUrl, $ikon, $siraNo, $durum]);\r\n                 \r\n-                $message = 'Menü başarıyla tanımlandı.';\r\n+                $message = 'Menü başarıyla tanımlandı ve klasör oluşturuldu.';\r\n                 $messageType = 'success';\r\n                 break;\r\n                 \r\n             case 'edit_menu':\r\n@@ -205,14 +239,113 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n+                // Sayfa dosyasını oluştur\r\n+                if (!empty($sayfaUrl)) {\r\n+                    // Menü ve modül bilgilerini al\r\n+                    $menuSql = \"SELECT m.menu_url, mod.modul_url \r\n+                                FROM tanim_menuler m \r\n+                                LEFT JOIN tanim_moduller mod ON m.modul_id = mod.modul_id \r\n+                                WHERE m.menu_id = ?\";\r\n+                    $menuStmt = $conn->prepare($menuSql);\r\n+                    $menuStmt->execute([$menuId]);\r\n+                    $menuData = $menuStmt->fetch();\r\n+                    \r\n+                    if ($menuData && !empty($menuData['modul_url']) && !empty($menuData['menu_url'])) {\r\n+                        $viewsBase = dirname(__DIR__, 2);\r\n+                        $filePath = $viewsBase . $menuData['modul_url'] . '/' . $menuData['menu_url'] . '/' . $sayfaUrl;\r\n+                        \r\n+                        // Eğer dosya yoksa oluştur\r\n+                        if (!file_exists($filePath)) {\r\n+                            // Temel PHP template\r\n+                            $template = <<<'PHP'\r\n+<?php\r\n+$pageTitle = \"{SAYFA_ADI}\";\r\n+$breadcrumbs = [\r\n+    ['title' => '{SAYFA_ADI}']\r\n+];\r\n+\r\n+// Auth kontrol\r\n+require_once '../../../auth.php';\r\n+$currentUser = checkAuth();\r\n+\r\n+// Sayfa yetkilerini kontrol et\r\n+$pagePermissions = checkPagePermission($currentUser['user_id']);\r\n+if (!$pagePermissions['gor']) {\r\n+    header('Location: /index.php');\r\n+    exit;\r\n+}\r\n+\r\n+$message = '';\r\n+$messageType = '';\r\n+\r\n+// Form işlemleri\r\n+if ($_SERVER['REQUEST_METHOD'] === 'POST') {\r\n+    try {\r\n+        $conn = getDatabaseConnection();\r\n+        \r\n+        // İşlemler buraya gelecek\r\n+        \r\n+        $message = 'İşlem başarılı.';\r\n+        $messageType = 'success';\r\n+    } catch (Exception $e) {\r\n+        $message = 'Hata: ' . $e->getMessage();\r\n+        $messageType = 'danger';\r\n+    }\r\n+}\r\n+\r\n+include '../../../includes/header.php';\r\n+?>\r\n+\r\n+<div class=\"container-fluid mt-4\">\r\n+    <div class=\"row\">\r\n+        <div class=\"col-12\">\r\n+            <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n+                <h2><i class=\"fas {SAYFA_IKON} me-2\"></i>{SAYFA_ADI}</h2>\r\n+            </div>\r\n+        </div>\r\n+    </div>\r\n+\r\n+    <?php if ($message): ?>\r\n+        <div class=\"alert alert-<?php echo $messageType; ?> alert-dismissible fade show\" role=\"alert\">\r\n+            <i class=\"fas fa-<?php echo $messageType === 'success' ? 'check-circle' : 'exclamation-triangle'; ?> me-2\"></i>\r\n+            <?php echo htmlspecialchars($message); ?>\r\n+            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>\r\n+        </div>\r\n+    <?php endif; ?>\r\n+\r\n+    <div class=\"card border-0 shadow-sm\">\r\n+        <div class=\"card-header bg-primary text-white\">\r\n+            <h5 class=\"mb-0\">{SAYFA_ADI}</h5>\r\n+        </div>\r\n+        <div class=\"card-body\">\r\n+            <p>Bu sayfa içeriği buraya gelecek.</p>\r\n+        </div>\r\n+    </div>\r\n+</div>\r\n+\r\n+<?php include '../../../includes/footer.php'; ?>\r\n+PHP;\r\n+                            \r\n+                            $template = str_replace('{SAYFA_ADI}', $sayfaAdi, $template);\r\n+                            $template = str_replace('{SAYFA_IKON}', $sayfaIkon ?: 'fa-file', $template);\r\n+                            \r\n+                            if (!file_put_contents($filePath, $template)) {\r\n+                                $message = 'Sayfa dosyası oluşturulamadı: ' . $filePath;\r\n+                                $messageType = 'danger';\r\n+                                break;\r\n+                            }\r\n+                        }\r\n+                    }\r\n+                }\r\n+                \r\n                 $sql = \"INSERT INTO tanim_sayfalar (menu_id, sayfa_adi, sayfa_url, aciklama, sayfa_ikon, sira_no, durum, dashboard, created_at) \r\n                         VALUES (?, ?, ?, ?, ?, ?, ?, ?, GETDATE())\";\r\n                 $stmt = $conn->prepare($sql);\r\n                 $stmt->execute([$menuId, $sayfaAdi, $sayfaUrl, $aciklama, $sayfaIkon, $siraNo, $durum, $dashboard]);\r\n                 \r\n-                $message = 'Sayfa başarıyla tanımlandı.';\r\n+                $message = 'Sayfa başarıyla tanımlandı ve dosya oluşturuldu.';\r\n                 $messageType = 'success';\r\n                 break;\r\n                 \r\n             case 'edit_sayfa':\r\n@@ -559,16 +692,12 @@\n                                     <input type=\"text\" class=\"form-control\" id=\"modul_adi\" name=\"modul_adi\" required \r\n                                            placeholder=\"Örn: Yönetim\">\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n-                                    <label for=\"modul_url\" class=\"form-label\">Modül URL</label>\r\n-                                    <select class=\"form-select\" id=\"modul_url\" name=\"modul_url\">\r\n-                                        <option value=\"\">Klasör seçiniz veya elle girin...</option>\r\n-                                        <?php foreach ($viewFolders as $vf): ?>\r\n-                                            <option value=\"<?php echo htmlspecialchars($vf); ?>\"><?php echo htmlspecialchars($vf); ?></option>\r\n-                                        <?php endforeach; ?>\r\n-                                    </select>\r\n-                                    <small class=\"form-text text-muted\">Eğer listede yoksa elle \"/Klasor\" şeklinde girebilirsiniz.</small>\r\n+                                    <label for=\"modul_url\" class=\"form-label\">Modül URL (Klasör Adı)</label>\r\n+                                    <input type=\"text\" class=\"form-control\" id=\"modul_url\" name=\"modul_url\" \r\n+                                           placeholder=\"Örn: Yonetim (klasör otomatik oluşturulacak)\">\r\n+                                    <small class=\"form-text text-muted\">Klasör adı giriniz. Otomatik olarak views klasöründe oluşturulacak.</small>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"modul_aciklama\" class=\"form-label\">Açıklama</label>\r\n                                     <textarea class=\"form-control\" id=\"modul_aciklama\" name=\"aciklama\" rows=\"2\" \r\n@@ -680,9 +809,9 @@\n                             <form method=\"POST\" action=\"\">\r\n                                 <input type=\"hidden\" name=\"action\" value=\"add_menu\">\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"menu_modul_id\" class=\"form-label\">Modül Seç</label>\r\n-                                    <select class=\"form-select\" id=\"menu_modul_id\" name=\"modul_id\" required onchange=\"updateMenuUrlDropdown()\">\r\n+                                    <select class=\"form-select\" id=\"menu_modul_id\" name=\"modul_id\" required>\r\n                                         <option value=\"\">Modül seçiniz...</option>\r\n                                         <?php foreach ($moduller as $modul): ?>\r\n                                             <?php if ($modul['durum'] == 1): ?>\r\n                                                 <option value=\"<?php echo $modul['modul_id']; ?>\">\r\n@@ -697,13 +826,12 @@\n                                     <input type=\"text\" class=\"form-control\" id=\"menu_adi\" name=\"menu_adi\" required \r\n                                            placeholder=\"Örn: Tanımlar\">\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n-                                    <label for=\"menu_url\" class=\"form-label\">Menü URL</label>\r\n-                                    <select class=\"form-select\" id=\"menu_url\" name=\"menu_url\">\r\n-                                        <option value=\"\">Önce modül seçiniz...</option>\r\n-                                    </select>\r\n-                                    <small class=\"form-text text-muted\">Seçilen modülün alt klasörleri listelenir.</small>\r\n+                                    <label for=\"menu_url\" class=\"form-label\">Menü URL (Alt Klasör Adı)</label>\r\n+                                    <input type=\"text\" class=\"form-control\" id=\"menu_url\" name=\"menu_url\" \r\n+                                           placeholder=\"Örn: Tanimlar (alt klasör otomatik oluşturulacak)\">\r\n+                                    <small class=\"form-text text-muted\">Alt klasör adı giriniz. Modül klasörü altında oluşturulacak.</small>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"menu_ikon\" class=\"form-label\">İkon</label>\r\n                                     <select class=\"form-select icon-select\" id=\"menu_ikon\" name=\"ikon\">\r\n@@ -825,9 +953,9 @@\n                                     </select>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"sayfa_menu_id\" class=\"form-label\">Menü Seç</label>\r\n-                                    <select class=\"form-select\" id=\"sayfa_menu_id\" name=\"menu_id\" required onchange=\"updateSayfaUrlDropdown()\">\r\n+                                    <select class=\"form-select\" id=\"sayfa_menu_id\" name=\"menu_id\" required>\r\n                                         <option value=\"\">Önce modül seçiniz...</option>\r\n                                     </select>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n@@ -835,13 +963,12 @@\n                                     <input type=\"text\" class=\"form-control\" id=\"sayfa_adi\" name=\"sayfa_adi\" required \r\n                                            placeholder=\"Örn: Bayi Hakedis Prim Dönem\">\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n-                                    <label for=\"sayfa_url\" class=\"form-label\">Sayfa URL</label>\r\n-                                    <select class=\"form-select\" id=\"sayfa_url\" name=\"sayfa_url\">\r\n-                                        <option value=\"\">Önce menü seçiniz...</option>\r\n-                                    </select>\r\n-                                    <small class=\"form-text text-muted\">Seçilen menünün PHP dosyaları listelenir.</small>\r\n+                                    <label for=\"sayfa_url\" class=\"form-label\">Sayfa URL (PHP Dosya Adı)</label>\r\n+                                    <input type=\"text\" class=\"form-control\" id=\"sayfa_url\" name=\"sayfa_url\" \r\n+                                           placeholder=\"Örn: bayi_listesi.php (dosya otomatik oluşturulacak)\">\r\n+                                    <small class=\"form-text text-muted\">PHP dosya adı giriniz (.php uzantısıyla). Otomatik olarak template ile oluşturulacak.</small>\r\n                                 </div>\r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"sayfa_aciklama\" class=\"form-label\">Açıklama</label>\r\n                                     <textarea class=\"form-control\" id=\"sayfa_aciklama\" name=\"aciklama\" rows=\"2\" \r\n@@ -1142,16 +1269,12 @@\n                         <label for=\"edit_modul_adi\" class=\"form-label\">Modül Adı</label>\r\n                         <input type=\"text\" class=\"form-control\" id=\"edit_modul_adi\" name=\"modul_adi\" required>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n-                        <label for=\"edit_modul_url\" class=\"form-label\">Modül URL</label>\r\n-                        <select class=\"form-select\" id=\"edit_modul_url\" name=\"modul_url\">\r\n-                            <option value=\"\">Klasör seçiniz...</option>\r\n-                            <?php foreach ($allViewFolders as $vf): ?>\r\n-                                <option value=\"<?php echo htmlspecialchars($vf); ?>\"><?php echo htmlspecialchars($vf); ?></option>\r\n-                            <?php endforeach; ?>\r\n-                        </select>\r\n-                        <small class=\"form-text text-muted\">View klasörlerinden seçiniz.</small>\r\n+                        <label for=\"edit_modul_url\" class=\"form-label\">Modül URL (Klasör Adı)</label>\r\n+                        <input type=\"text\" class=\"form-control\" id=\"edit_modul_url\" name=\"modul_url\" \r\n+                               placeholder=\"Örn: Yonetim\">\r\n+                        <small class=\"form-text text-muted\">Klasör adı giriniz.</small>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_modul_aciklama\" class=\"form-label\">Açıklama</label>\r\n                         <textarea class=\"form-control\" id=\"edit_modul_aciklama\" name=\"aciklama\" rows=\"2\"></textarea>\r\n@@ -1215,9 +1338,9 @@\n                 </div>\r\n                 <div class=\"modal-body\">\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_menu_modul_id\" class=\"form-label\">Modül</label>\r\n-                        <select class=\"form-select\" id=\"edit_menu_modul_id\" name=\"modul_id\" required onchange=\"updateEditMenuUrlDropdown()\">\r\n+                        <select class=\"form-select\" id=\"edit_menu_modul_id\" name=\"modul_id\" required>\r\n                             <option value=\"\">Modül seçiniz...</option>\r\n                             <?php foreach ($moduller as $modul): ?>\r\n                                 <?php if ($modul['durum'] == 1): ?>\r\n                                     <option value=\"<?php echo $modul['modul_id']; ?>\">\r\n@@ -1231,13 +1354,12 @@\n                         <label for=\"edit_menu_adi\" class=\"form-label\">Menü Adı</label>\r\n                         <input type=\"text\" class=\"form-control\" id=\"edit_menu_adi\" name=\"menu_adi\" required>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n-                        <label for=\"edit_menu_url\" class=\"form-label\">Menü URL</label>\r\n-                        <select class=\"form-select\" id=\"edit_menu_url\" name=\"menu_url\">\r\n-                            <option value=\"\">Önce modül seçiniz...</option>\r\n-                        </select>\r\n-                        <small class=\"form-text text-muted\">Seçilen modülün alt klasörleri listelenir.</small>\r\n+                        <label for=\"edit_menu_url\" class=\"form-label\">Menü URL (Alt Klasör Adı)</label>\r\n+                        <input type=\"text\" class=\"form-control\" id=\"edit_menu_url\" name=\"menu_url\" \r\n+                               placeholder=\"Örn: Tanimlar\">\r\n+                        <small class=\"form-text text-muted\">Alt klasör adı giriniz.</small>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_menu_ikon\" class=\"form-label\">İkon</label>\r\n                         <select class=\"form-select icon-select\" id=\"edit_menu_ikon\" name=\"ikon\">\r\n@@ -1310,22 +1432,21 @@\n                         </select>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_sayfa_menu_id\" class=\"form-label\">Menü</label>\r\n-                        <select class=\"form-select\" id=\"edit_sayfa_menu_id\" name=\"menu_id\" required onchange=\"updateEditSayfaUrlDropdown()\">\r\n+                        <select class=\"form-select\" id=\"edit_sayfa_menu_id\" name=\"menu_id\" required>\r\n                             <option value=\"\">Önce modül seçiniz...</option>\r\n                         </select>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_sayfa_adi\" class=\"form-label\">Sayfa Adı</label>\r\n                         <input type=\"text\" class=\"form-control\" id=\"edit_sayfa_adi\" name=\"sayfa_adi\" required>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n-                        <label for=\"edit_sayfa_url\" class=\"form-label\">Sayfa URL</label>\r\n-                        <select class=\"form-select\" id=\"edit_sayfa_url\" name=\"sayfa_url\">\r\n-                            <option value=\"\">PHP dosyası seçiniz...</option>\r\n-                        </select>\r\n-                        <small class=\"form-text text-muted\">Seçilen menünün PHP dosyaları listelenir.</small>\r\n+                        <label for=\"edit_sayfa_url\" class=\"form-label\">Sayfa URL (PHP Dosya Adı)</label>\r\n+                        <input type=\"text\" class=\"form-control\" id=\"edit_sayfa_url\" name=\"sayfa_url\" \r\n+                               placeholder=\"Örn: bayi_listesi.php\">\r\n+                        <small class=\"form-text text-muted\">PHP dosya adı giriniz (.php uzantısıyla).</small>\r\n                     </div>\r\n                     <div class=\"mb-3\">\r\n                         <label for=\"edit_sayfa_aciklama\" class=\"form-label\">Açıklama</label>\r\n                         <textarea class=\"form-control\" id=\"edit_sayfa_aciklama\" name=\"aciklama\" rows=\"2\"></textarea>\r\n@@ -1461,62 +1582,16 @@\n <script>\r\n // Menü verilerini JavaScript'e aktar\r\n const menulerData = <?php echo json_encode($menuler); ?>;\r\n const sayfalarData = <?php echo json_encode($sayfalar); ?>;\r\n-const viewSubFolders = <?php echo json_encode($viewSubFolders); ?>;\r\n-const viewFiles = <?php echo json_encode($viewFiles); ?>;\r\n const modullerData = <?php echo json_encode($moduller); ?>;\r\n-const usedMenuUrls = <?php echo json_encode($usedMenuUrls); ?>;\r\n-const usedSayfaUrls = <?php echo json_encode($usedSayfaUrls); ?>;\r\n \r\n-// Menü tanımı için modül seçildiğinde URL dropdown'unu güncelle\r\n-function updateMenuUrlDropdown() {\r\n-    const modulId = document.getElementById('menu_modul_id').value;\r\n-    const menuUrlDropdown = document.getElementById('menu_url');\r\n-    \r\n-    menuUrlDropdown.innerHTML = '<option value=\"\">Alt klasör seçiniz...</option>';\r\n-    \r\n-    if (modulId) {\r\n-        // Seçilen modülün modul_url'sini bul\r\n-        const selectedModul = modullerData.find(m => m.modul_id == modulId);\r\n-        if (selectedModul && selectedModul.modul_url) {\r\n-            // modul_url'den başındaki \"/\" kaldır\r\n-            const folderName = selectedModul.modul_url.replace(/^\\//, '');\r\n-            \r\n-            // Bu modül için kullanılmış URL'leri al (string ve number karşılaştırması için her ikisini de kontrol et)\r\n-            const usedUrls = usedMenuUrls[modulId] || usedMenuUrls[String(modulId)] || [];\r\n-            \r\n-            console.log('Seçilen Modül ID:', modulId);\r\n-            console.log('Folder Name:', folderName);\r\n-            console.log('Kullanılmış URL\\'ler:', usedUrls);\r\n-            console.log('Alt Klasörler:', viewSubFolders[folderName]);\r\n-            \r\n-            // Bu modülün alt klasörlerini getir ve kullanılmamış olanları listele\r\n-            if (viewSubFolders[folderName] && viewSubFolders[folderName].length > 0) {\r\n-                viewSubFolders[folderName].forEach(subFolder => {\r\n-                    // Eğer bu URL daha önce kullanılmamışsa ekle\r\n-                    if (!usedUrls.includes(subFolder)) {\r\n-                        const option = document.createElement('option');\r\n-                        option.value = subFolder;\r\n-                        option.textContent = subFolder;\r\n-                        menuUrlDropdown.appendChild(option);\r\n-                    } else {\r\n-                        console.log('Filtrelendi (kullanılmış):', subFolder);\r\n-                    }\r\n-                });\r\n-            }\r\n-        }\r\n-    }\r\n-}\r\n-\r\n // Sayfa tanımı için menü dropdown güncelleme\r\n function updateMenuDropdown() {\r\n     const modulId = document.getElementById('sayfa_modul_id').value;\r\n     const menuDropdown = document.getElementById('sayfa_menu_id');\r\n-    const urlDropdown = document.getElementById('sayfa_url');\r\n     \r\n     menuDropdown.innerHTML = '<option value=\"\">Menü seçiniz...</option>';\r\n-    urlDropdown.innerHTML = '<option value=\"\">Önce menü seçiniz...</option>';\r\n     \r\n     if (modulId) {\r\n         const filteredMenuler = menulerData.filter(m => m.modul_id == modulId && m.durum == 1);\r\n         filteredMenuler.forEach(menu => {\r\n@@ -1527,43 +1602,8 @@\n         });\r\n     }\r\n }\r\n \r\n-// Sayfa tanımı için URL dropdown güncelleme\r\n-function updateSayfaUrlDropdown() {\r\n-    const menuId = document.getElementById('sayfa_menu_id').value;\r\n-    const urlDropdown = document.getElementById('sayfa_url');\r\n-    \r\n-    urlDropdown.innerHTML = '<option value=\"\">PHP dosyası seçiniz...</option>';\r\n-    \r\n-    if (menuId) {\r\n-        // Seçilen menünün modül ve menu_url bilgisini bul\r\n-        const selectedMenu = menulerData.find(m => m.menu_id == menuId);\r\n-        if (selectedMenu) {\r\n-            const selectedModul = modullerData.find(m => m.modul_id == selectedMenu.modul_id);\r\n-            if (selectedModul && selectedModul.modul_url && selectedMenu.menu_url) {\r\n-                const modulFolder = selectedModul.modul_url.replace(/^\\//, '');\r\n-                const menuFolder = selectedMenu.menu_url;\r\n-                \r\n-                // Bu menü için kullanılmış URL'leri al\r\n-                const usedUrls = usedSayfaUrls[menuId] || usedSayfaUrls[String(menuId)] || [];\r\n-                \r\n-                // PHP dosyalarını getir ve kullanılmayanları listele\r\n-                if (viewFiles[modulFolder] && viewFiles[modulFolder][menuFolder]) {\r\n-                    viewFiles[modulFolder][menuFolder].forEach(file => {\r\n-                        if (!usedUrls.includes(file)) {\r\n-                            const option = document.createElement('option');\r\n-                            option.value = file;\r\n-                            option.textContent = file;\r\n-                            urlDropdown.appendChild(option);\r\n-                        }\r\n-                    });\r\n-                }\r\n-            }\r\n-        }\r\n-    }\r\n-}\r\n-\r\n // Yetki tanımı için menü dropdown güncelleme\r\n function updateYetkiMenuDropdown() {\r\n     const modulId = document.getElementById('yetki_modul_id').value;\r\n     const menuDropdown = document.getElementById('yetki_menu_id');\r\n@@ -1604,9 +1644,10 @@\n // Modül düzenleme\r\n function editModul(modul) {\r\n     document.getElementById('edit_modul_id').value = modul.modul_id;\r\n     document.getElementById('edit_modul_adi').value = modul.modul_adi;\r\n-    document.getElementById('edit_modul_url').value = modul.modul_url || '';\r\n+    // Başındaki / işaretini kaldır\r\n+    document.getElementById('edit_modul_url').value = modul.modul_url ? modul.modul_url.replace(/^\\//, '') : '';\r\n     document.getElementById('edit_modul_aciklama').value = modul.aciklama || '';\r\n     document.getElementById('edit_modul_ikon').value = modul.modul_ikon || '';\r\n     document.getElementById('edit_modul_sira_no').value = modul.sira_no || 0;\r\n     document.getElementById('edit_modul_durum').value = modul.durum;\r\n@@ -1618,64 +1659,21 @@\n function editMenu(menu) {\r\n     document.getElementById('edit_menu_id').value = menu.menu_id;\r\n     document.getElementById('edit_menu_modul_id').value = menu.modul_id;\r\n     document.getElementById('edit_menu_adi').value = menu.menu_adi;\r\n+    document.getElementById('edit_menu_url').value = menu.menu_url || '';\r\n     document.getElementById('edit_menu_ikon').value = menu.ikon || '';\r\n     document.getElementById('edit_menu_sira_no').value = menu.sira_no;\r\n     document.getElementById('edit_menu_durum').value = menu.durum;\r\n     \r\n-    // Modül seçilince URL dropdown'unu güncelle\r\n-    updateEditMenuUrlDropdown();\r\n-    \r\n-    // Dropdown dolduktan sonra mevcut URL'yi seç\r\n-    setTimeout(() => {\r\n-        const urlDropdown = document.getElementById('edit_menu_url');\r\n-        // Eğer mevcut URL dropdown'da yoksa, option olarak ekle\r\n-        if (menu.menu_url) {\r\n-            const existingOption = Array.from(urlDropdown.options).find(opt => opt.value === menu.menu_url);\r\n-            if (!existingOption) {\r\n-                const option = document.createElement('option');\r\n-                option.value = menu.menu_url;\r\n-                option.textContent = menu.menu_url + ' (mevcut)';\r\n-                urlDropdown.appendChild(option);\r\n-            }\r\n-            urlDropdown.value = menu.menu_url;\r\n-        }\r\n-    }, 100);\r\n-    \r\n     new bootstrap.Modal(document.getElementById('editMenuModal')).show();\r\n }\r\n \r\n-// Menü düzenleme modalı için URL dropdown güncelleme\r\n-function updateEditMenuUrlDropdown() {\r\n-    const modulId = document.getElementById('edit_menu_modul_id').value;\r\n-    const menuUrlDropdown = document.getElementById('edit_menu_url');\r\n-    \r\n-    menuUrlDropdown.innerHTML = '<option value=\"\">Alt klasör seçiniz...</option>';\r\n-    \r\n-    if (modulId) {\r\n-        const selectedModul = modullerData.find(m => m.modul_id == modulId);\r\n-        if (selectedModul && selectedModul.modul_url) {\r\n-            const folderName = selectedModul.modul_url.replace(/^\\//, '');\r\n-            const usedUrls = usedMenuUrls[modulId] || usedMenuUrls[String(modulId)] || [];\r\n-            \r\n-            if (viewSubFolders[folderName] && viewSubFolders[folderName].length > 0) {\r\n-                viewSubFolders[folderName].forEach(subFolder => {\r\n-                    // Düzenleme modunda tüm URL'leri göster (filtreleme yapma)\r\n-                    const option = document.createElement('option');\r\n-                    option.value = subFolder;\r\n-                    option.textContent = subFolder;\r\n-                    menuUrlDropdown.appendChild(option);\r\n-                });\r\n-            }\r\n-        }\r\n-    }\r\n-}\r\n-\r\n // Sayfa düzenleme\r\n function editSayfa(sayfa) {\r\n     document.getElementById('edit_sayfa_id').value = sayfa.sayfa_id;\r\n     document.getElementById('edit_sayfa_adi').value = sayfa.sayfa_adi;\r\n+    document.getElementById('edit_sayfa_url').value = sayfa.sayfa_url || '';\r\n     document.getElementById('edit_sayfa_aciklama').value = sayfa.aciklama || '';\r\n     document.getElementById('edit_sayfa_ikon').value = sayfa.sayfa_ikon || '';\r\n     document.getElementById('edit_sayfa_sira_no').value = sayfa.sira_no || 0;\r\n     document.getElementById('edit_sayfa_dashboard').checked = sayfa.dashboard == 1;\r\n@@ -1685,62 +1683,17 @@\n     const menu = menulerData.find(m => m.menu_id == sayfa.menu_id);\r\n     if (menu) {\r\n         document.getElementById('edit_sayfa_modul_id').value = menu.modul_id;\r\n         updateEditSayfaMenuDropdown();\r\n-        // Dropdown dolduktan sonra menüyü ve URL'yi seç\r\n+        // Dropdown dolduktan sonra menüyü seç\r\n         setTimeout(() => {\r\n             document.getElementById('edit_sayfa_menu_id').value = sayfa.menu_id;\r\n-            updateEditSayfaUrlDropdown();\r\n-            \r\n-            // URL dropdown dolduktan sonra mevcut URL'yi seç\r\n-            setTimeout(() => {\r\n-                const urlDropdown = document.getElementById('edit_sayfa_url');\r\n-                if (sayfa.sayfa_url) {\r\n-                    const existingOption = Array.from(urlDropdown.options).find(opt => opt.value === sayfa.sayfa_url);\r\n-                    if (!existingOption) {\r\n-                        const option = document.createElement('option');\r\n-                        option.value = sayfa.sayfa_url;\r\n-                        option.textContent = sayfa.sayfa_url + ' (mevcut)';\r\n-                        urlDropdown.appendChild(option);\r\n-                    }\r\n-                    urlDropdown.value = sayfa.sayfa_url;\r\n-                }\r\n-            }, 100);\r\n         }, 100);\r\n     }\r\n     \r\n     new bootstrap.Modal(document.getElementById('editSayfaModal')).show();\r\n }\r\n \r\n-// Sayfa düzenleme modalı için URL dropdown güncelleme\r\n-function updateEditSayfaUrlDropdown() {\r\n-    const menuId = document.getElementById('edit_sayfa_menu_id').value;\r\n-    const urlDropdown = document.getElementById('edit_sayfa_url');\r\n-    \r\n-    urlDropdown.innerHTML = '<option value=\"\">PHP dosyası seçiniz...</option>';\r\n-    \r\n-    if (menuId) {\r\n-        const selectedMenu = menulerData.find(m => m.menu_id == menuId);\r\n-        if (selectedMenu) {\r\n-            const selectedModul = modullerData.find(m => m.modul_id == selectedMenu.modul_id);\r\n-            if (selectedModul && selectedModul.modul_url && selectedMenu.menu_url) {\r\n-                const modulFolder = selectedModul.modul_url.replace(/^\\//, '');\r\n-                const menuFolder = selectedMenu.menu_url;\r\n-                \r\n-                // Düzenleme modunda tüm dosyaları göster (filtreleme yapma)\r\n-                if (viewFiles[modulFolder] && viewFiles[modulFolder][menuFolder]) {\r\n-                    viewFiles[modulFolder][menuFolder].forEach(file => {\r\n-                        const option = document.createElement('option');\r\n-                        option.value = file;\r\n-                        option.textContent = file;\r\n-                        urlDropdown.appendChild(option);\r\n-                    });\r\n-                }\r\n-            }\r\n-        }\r\n-    }\r\n-}\r\n-\r\n // Sayfa düzenleme modalı için menü dropdown güncelleme\r\n function updateEditSayfaMenuDropdown() {\r\n     const modulId = document.getElementById('edit_sayfa_modul_id').value;\r\n     const menuDropdown = document.getElementById('edit_sayfa_menu_id');\r\n"
                },
                {
                    "date": 1761119465179,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,13 +30,11 @@\n         switch ($action) {\r\n             case 'add_modul':\r\n                 $modulAdi = trim($_POST['modul_adi']);\r\n                 $modulUrl = trim($_POST['modul_url']);\r\n-                // Eğer kullanıcı boş bıraktıysa null, değilse başına '/' ekle (tekrar eklemeyi önle)\r\n+                // Başındaki / karakterini kaldır ve temizle\r\n                 if (!empty($modulUrl)) {\r\n-                    if ($modulUrl[0] !== '/') {\r\n-                        $modulUrl = '/' . $modulUrl;\r\n-                    }\r\n+                    $modulUrl = ltrim($modulUrl, '/');\r\n                 } else {\r\n                     $modulUrl = null;\r\n                 }\r\n                 $aciklama = trim($_POST['aciklama'] ?? '');\r\n@@ -63,9 +61,9 @@\n                 \r\n                 // Modül klasörünü oluştur\r\n                 if (!empty($modulUrl)) {\r\n                     $viewsBase = dirname(__DIR__, 2);\r\n-                    $modulPath = $viewsBase . $modulUrl;\r\n+                    $modulPath = $viewsBase . '/' . $modulUrl;\r\n                     if (!is_dir($modulPath)) {\r\n                         if (!mkdir($modulPath, 0755, true)) {\r\n                             $message = 'Modül klasörü oluşturulamadı: ' . $modulPath;\r\n                             $messageType = 'danger';\r\n@@ -86,13 +84,11 @@\n             case 'edit_modul':\r\n                 $modulId = (int)$_POST['modul_id'];\r\n                 $modulAdi = trim($_POST['modul_adi']);\r\n                 $modulUrl = trim($_POST['modul_url']);\r\n-                // Eğer kullanıcı boş bıraktıysa null, değilse başına '/' ekle\r\n+                // Başındaki / karakterini kaldır ve temizle\r\n                 if (!empty($modulUrl)) {\r\n-                    if ($modulUrl[0] !== '/') {\r\n-                        $modulUrl = '/' . $modulUrl;\r\n-                    }\r\n+                    $modulUrl = ltrim($modulUrl, '/');\r\n                 } else {\r\n                     $modulUrl = null;\r\n                 }\r\n                 $aciklama = trim($_POST['aciklama'] ?? '');\r\n@@ -161,9 +157,9 @@\n                     $modul = $modulStmt->fetch();\r\n                     \r\n                     if ($modul && !empty($modul['modul_url'])) {\r\n                         $viewsBase = dirname(__DIR__, 2);\r\n-                        $menuPath = $viewsBase . $modul['modul_url'] . '/' . $menuUrl;\r\n+                        $menuPath = $viewsBase . '/' . $modul['modul_url'] . '/' . $menuUrl;\r\n                         if (!is_dir($menuPath)) {\r\n                             if (!mkdir($menuPath, 0755, true)) {\r\n                                 $message = 'Menü klasörü oluşturulamadı: ' . $menuPath;\r\n                                 $messageType = 'danger';\r\n@@ -252,9 +248,9 @@\n                     $menuData = $menuStmt->fetch();\r\n                     \r\n                     if ($menuData && !empty($menuData['modul_url']) && !empty($menuData['menu_url'])) {\r\n                         $viewsBase = dirname(__DIR__, 2);\r\n-                        $filePath = $viewsBase . $menuData['modul_url'] . '/' . $menuData['menu_url'] . '/' . $sayfaUrl;\r\n+                        $filePath = $viewsBase . '/' . $menuData['modul_url'] . '/' . $menuData['menu_url'] . '/' . $sayfaUrl;\r\n                         \r\n                         // Eğer dosya yoksa oluştur\r\n                         if (!file_exists($filePath)) {\r\n                             // Temel PHP template\r\n@@ -1644,10 +1640,9 @@\n // Modül düzenleme\r\n function editModul(modul) {\r\n     document.getElementById('edit_modul_id').value = modul.modul_id;\r\n     document.getElementById('edit_modul_adi').value = modul.modul_adi;\r\n-    // Başındaki / işaretini kaldır\r\n-    document.getElementById('edit_modul_url').value = modul.modul_url ? modul.modul_url.replace(/^\\//, '') : '';\r\n+    document.getElementById('edit_modul_url').value = modul.modul_url || '';\r\n     document.getElementById('edit_modul_aciklama').value = modul.aciklama || '';\r\n     document.getElementById('edit_modul_ikon').value = modul.modul_ikon || '';\r\n     document.getElementById('edit_modul_sira_no').value = modul.sira_no || 0;\r\n     document.getElementById('edit_modul_durum').value = modul.durum;\r\n"
                },
                {
                    "date": 1761120529024,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -204,14 +204,59 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n+                // Eski menü bilgilerini al (klasör taşıma için)\r\n+                $oldMenuSql = \"SELECT m.menu_url, m.modul_id, mod.modul_url \r\n+                               FROM tanim_menuler m \r\n+                               LEFT JOIN tanim_moduller mod ON m.modul_id = mod.modul_id \r\n+                               WHERE m.menu_id = ?\";\r\n+                $oldMenuStmt = $conn->prepare($oldMenuSql);\r\n+                $oldMenuStmt->execute([$menuId]);\r\n+                $oldMenuData = $oldMenuStmt->fetch();\r\n+                \r\n+                // Yeni modül bilgilerini al\r\n+                $newModulSql = \"SELECT modul_url FROM tanim_moduller WHERE modul_id = ?\";\r\n+                $newModulStmt = $conn->prepare($newModulSql);\r\n+                $newModulStmt->execute([$modulId]);\r\n+                $newModulData = $newModulStmt->fetch();\r\n+                \r\n+                // Modül değiştiyse ve her iki modülün de URL'i varsa klasörü taşı\r\n+                if ($oldMenuData && $newModulData && \r\n+                    $oldMenuData['modul_id'] != $modulId && \r\n+                    !empty($oldMenuData['modul_url']) && \r\n+                    !empty($newModulData['modul_url']) && \r\n+                    !empty($oldMenuData['menu_url'])) {\r\n+                    \r\n+                    $viewsBase = dirname(__DIR__, 2);\r\n+                    $oldPath = $viewsBase . '/' . $oldMenuData['modul_url'] . '/' . $oldMenuData['menu_url'];\r\n+                    $newPath = $viewsBase . '/' . $newModulData['modul_url'] . '/' . $oldMenuData['menu_url'];\r\n+                    \r\n+                    // Eski klasör varsa ve yeni klasör yoksa taşı\r\n+                    if (is_dir($oldPath) && !is_dir($newPath)) {\r\n+                        // Hedef modül klasörü yoksa oluştur\r\n+                        $targetModulDir = $viewsBase . '/' . $newModulData['modul_url'];\r\n+                        if (!is_dir($targetModulDir)) {\r\n+                            mkdir($targetModulDir, 0755, true);\r\n+                        }\r\n+                        \r\n+                        // Menü klasörünü taşı\r\n+                        if (rename($oldPath, $newPath)) {\r\n+                            $message = 'Menü güncellendi ve klasör yeni modül altına taşındı.';\r\n+                        } else {\r\n+                            $message = 'Menü güncellendi ancak klasör taşınamadı.';\r\n+                        }\r\n+                    }\r\n+                }\r\n+                \r\n                 $sql = \"UPDATE tanim_menuler SET modul_id = ?, menu_adi = ?, menu_url = ?, ikon = ?, sira_no = ?, durum = ?, updated_at = GETDATE() \r\n                         WHERE menu_id = ?\";\r\n                 $stmt = $conn->prepare($sql);\r\n                 $stmt->execute([$modulId, $menuAdi, $menuUrl, $ikon, $siraNo, $durum, $menuId]);\r\n                 \r\n-                $message = 'Menü başarıyla güncellendi.';\r\n+                if (empty($message)) {\r\n+                    $message = 'Menü başarıyla güncellendi.';\r\n+                }\r\n                 $messageType = 'success';\r\n                 break;\r\n                 \r\n             case 'add_sayfa':\r\n"
                },
                {
                    "date": 1761131685742,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -509,8 +509,106 @@\n                 $message = 'Yetki başarıyla silindi.';\r\n                 $messageType = 'success';\r\n                 break;\r\n                 \r\n+            case 'add_modul_menu_yetki':\r\n+                $hedefTip = $_POST['hedef_tip'] ?? ''; // 'modul' veya 'menu'\r\n+                $hedefId = (int)($_POST['hedef_id'] ?? 0);\r\n+                $userGroupId = (int)$_POST['user_group_id'];\r\n+                $gor = isset($_POST['gor']) ? 1 : 0;\r\n+                $durum = $_POST['durum'] ?? 1;\r\n+                \r\n+                if (!in_array($hedefTip, ['modul', 'menu'])) {\r\n+                    $message = 'Geçersiz hedef tipi.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                if ($hedefId <= 0) {\r\n+                    $message = 'Lütfen bir ' . ($hedefTip == 'modul' ? 'modül' : 'menü') . ' seçiniz.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                if ($userGroupId <= 0) {\r\n+                    $message = 'Lütfen bir kullanıcı grubu seçiniz.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                // Yetki kontrolü - aynı hedef ve grup için tekrar yetki tanımlanmasın\r\n+                if ($hedefTip == 'modul') {\r\n+                    $checkSql = \"SELECT modul_menu_yetki_id FROM tanim_modul_menu_yetkiler \r\n+                                 WHERE modul_id = ? AND menu_id IS NULL AND user_group_id = ?\";\r\n+                    $checkStmt = $conn->prepare($checkSql);\r\n+                    $checkStmt->execute([$hedefId, $userGroupId]);\r\n+                } else {\r\n+                    $checkSql = \"SELECT modul_menu_yetki_id FROM tanim_modul_menu_yetkiler \r\n+                                 WHERE menu_id = ? AND modul_id IS NULL AND user_group_id = ?\";\r\n+                    $checkStmt = $conn->prepare($checkSql);\r\n+                    $checkStmt->execute([$hedefId, $userGroupId]);\r\n+                }\r\n+                \r\n+                if ($checkStmt->fetch()) {\r\n+                    $message = 'Bu ' . ($hedefTip == 'modul' ? 'modül' : 'menü') . ' için bu kullanıcı grubuna zaten yetki tanımlanmıştır.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                // Yetki ekle\r\n+                if ($hedefTip == 'modul') {\r\n+                    $sql = \"INSERT INTO tanim_modul_menu_yetkiler (modul_id, menu_id, user_group_id, gor, durum, created_at) \r\n+                            VALUES (?, NULL, ?, ?, ?, GETDATE())\";\r\n+                    $stmt = $conn->prepare($sql);\r\n+                    $stmt->execute([$hedefId, $userGroupId, $gor, $durum]);\r\n+                } else {\r\n+                    $sql = \"INSERT INTO tanim_modul_menu_yetkiler (modul_id, menu_id, user_group_id, gor, durum, created_at) \r\n+                            VALUES (NULL, ?, ?, ?, ?, GETDATE())\";\r\n+                    $stmt = $conn->prepare($sql);\r\n+                    $stmt->execute([$hedefId, $userGroupId, $gor, $durum]);\r\n+                }\r\n+                \r\n+                $message = ucfirst($hedefTip) . ' yetkisi başarıyla tanımlandı.';\r\n+                $messageType = 'success';\r\n+                break;\r\n+                \r\n+            case 'edit_modul_menu_yetki':\r\n+                $yetkiId = (int)$_POST['mm_yetki_id'];\r\n+                $gor = isset($_POST['gor']) ? 1 : 0;\r\n+                $durum = $_POST['durum'] ?? 1;\r\n+                \r\n+                if ($yetkiId <= 0) {\r\n+                    $message = 'Geçersiz yetki ID.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                $sql = \"UPDATE tanim_modul_menu_yetkiler SET gor = ?, durum = ?, updated_at = GETDATE() \r\n+                        WHERE modul_menu_yetki_id = ?\";\r\n+                $stmt = $conn->prepare($sql);\r\n+                $stmt->execute([$gor, $durum, $yetkiId]);\r\n+                \r\n+                $message = 'Yetki başarıyla güncellendi.';\r\n+                $messageType = 'success';\r\n+                break;\r\n+                \r\n+            case 'delete_modul_menu_yetki':\r\n+                $yetkiId = (int)$_POST['mm_yetki_id'];\r\n+                \r\n+                if ($yetkiId <= 0) {\r\n+                    $message = 'Geçersiz yetki ID.';\r\n+                    $messageType = 'danger';\r\n+                    break;\r\n+                }\r\n+                \r\n+                $sql = \"DELETE FROM tanim_modul_menu_yetkiler WHERE modul_menu_yetki_id = ?\";\r\n+                $stmt = $conn->prepare($sql);\r\n+                $stmt->execute([$yetkiId]);\r\n+                \r\n+                $message = 'Yetki başarıyla silindi.';\r\n+                $messageType = 'success';\r\n+                break;\r\n+                \r\n             default:\r\n                 $message = 'Geçersiz işlem.';\r\n                 $messageType = 'danger';\r\n                 break;\r\n@@ -575,8 +673,37 @@\n     $stmt = $conn->prepare($sql);\r\n     $stmt->execute();\r\n     $userGroups = $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n     \r\n+    // Modül/Menü yetkilerini getir\r\n+    $sql = \"SELECT \r\n+                mmy.modul_menu_yetki_id,\r\n+                mmy.modul_id,\r\n+                mmy.menu_id,\r\n+                mmy.user_group_id,\r\n+                mmy.gor,\r\n+                mmy.durum,\r\n+                mmy.created_at,\r\n+                CASE \r\n+                    WHEN mmy.modul_id IS NOT NULL THEN mod.modul_adi\r\n+                    WHEN mmy.menu_id IS NOT NULL THEN m.menu_adi\r\n+                END as hedef_adi,\r\n+                CASE \r\n+                    WHEN mmy.modul_id IS NOT NULL THEN 'Modül'\r\n+                    WHEN mmy.menu_id IS NOT NULL THEN 'Menü'\r\n+                END as hedef_tip,\r\n+                ug.group_name as grup_adi,\r\n+                mod.modul_adi as modul_adi,\r\n+                m.menu_adi as menu_adi\r\n+            FROM tanim_modul_menu_yetkiler mmy\r\n+            LEFT JOIN tanim_moduller mod ON mmy.modul_id = mod.modul_id\r\n+            LEFT JOIN tanim_menuler m ON mmy.menu_id = m.menu_id\r\n+            LEFT JOIN user_groups ug ON mmy.user_group_id = ug.id\r\n+            ORDER BY mmy.created_at DESC\";\r\n+    $stmt = $conn->prepare($sql);\r\n+    $stmt->execute();\r\n+    $modulMenuYetkiler = $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n+    \r\n } catch (Exception $e) {\r\n     error_log(\"Error fetching data: \" . $e->getMessage());\r\n     $error = \"Veritabanı hatası: \" . $e->getMessage();\r\n }\r\n@@ -707,10 +834,15 @@\n                 <i class=\"fas fa-file me-1\"></i>Sayfa Tanımlama\r\n             </button>\r\n         </li>\r\n         <li class=\"nav-item\" role=\"presentation\">\r\n+            <button class=\"nav-link\" id=\"modul-menu-yetki-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#modul-menu-yetki\" type=\"button\">\r\n+                <i class=\"fas fa-lock me-1\"></i>Modül/Menü Yetkileri\r\n+            </button>\r\n+        </li>\r\n+        <li class=\"nav-item\" role=\"presentation\">\r\n             <button class=\"nav-link\" id=\"yetki-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#yetki\" type=\"button\">\r\n-                <i class=\"fas fa-key me-1\"></i>Yetki Tanımlama\r\n+                <i class=\"fas fa-key me-1\"></i>Sayfa Yetkileri\r\n             </button>\r\n         </li>\r\n     </ul>\r\n \r\n@@ -1128,8 +1260,183 @@\n                 </div>\r\n             </div>\r\n         </div>\r\n \r\n+        <!-- Modül/Menü Yetki Tanımlama -->\r\n+        <div class=\"tab-pane fade\" id=\"modul-menu-yetki\" role=\"tabpanel\">\r\n+            <div class=\"row\">\r\n+                <div class=\"col-lg-5\">\r\n+                    <div class=\"card border-0 shadow-sm\">\r\n+                        <div class=\"card-header bg-danger text-white\">\r\n+                            <h5 class=\"mb-0\"><i class=\"fas fa-plus me-2\"></i>Yeni Modül/Menü Yetkisi Ekle</h5>\r\n+                        </div>\r\n+                        <div class=\"card-body\">\r\n+                            <form method=\"POST\" action=\"\">\r\n+                                <input type=\"hidden\" name=\"action\" value=\"add_modul_menu_yetki\">\r\n+                                \r\n+                                <div class=\"mb-3\">\r\n+                                    <label class=\"form-label\">Hedef Tipi</label>\r\n+                                    <div class=\"btn-group w-100\" role=\"group\">\r\n+                                        <input type=\"radio\" class=\"btn-check\" name=\"hedef_tip\" id=\"hedef_modul\" value=\"modul\" checked onchange=\"updateHedefDropdown()\">\r\n+                                        <label class=\"btn btn-outline-primary\" for=\"hedef_modul\">\r\n+                                            <i class=\"fas fa-cube me-1\"></i>Modül\r\n+                                        </label>\r\n+                                        \r\n+                                        <input type=\"radio\" class=\"btn-check\" name=\"hedef_tip\" id=\"hedef_menu\" value=\"menu\" onchange=\"updateHedefDropdown()\">\r\n+                                        <label class=\"btn btn-outline-primary\" for=\"hedef_menu\">\r\n+                                            <i class=\"fas fa-bars me-1\"></i>Menü\r\n+                                        </label>\r\n+                                    </div>\r\n+                                </div>\r\n+                                \r\n+                                <div class=\"mb-3\" id=\"modul_select_container\">\r\n+                                    <label for=\"mm_modul_id\" class=\"form-label\">Modül Seç</label>\r\n+                                    <select class=\"form-select\" id=\"mm_modul_id\" name=\"hedef_id\" required>\r\n+                                        <option value=\"\">Modül seçiniz...</option>\r\n+                                        <?php foreach ($moduller as $modul): ?>\r\n+                                            <?php if ($modul['durum'] == 1): ?>\r\n+                                                <option value=\"<?php echo $modul['modul_id']; ?>\">\r\n+                                                    <?php echo htmlspecialchars($modul['modul_adi']); ?>\r\n+                                                </option>\r\n+                                            <?php endif; ?>\r\n+                                        <?php endforeach; ?>\r\n+                                    </select>\r\n+                                </div>\r\n+                                \r\n+                                <div class=\"mb-3\" id=\"menu_select_container\" style=\"display:none;\">\r\n+                                    <label for=\"mm_menu_modul_id\" class=\"form-label\">Modül Seç</label>\r\n+                                    <select class=\"form-select\" id=\"mm_menu_modul_id\" onchange=\"updateMMMenuDropdown()\">\r\n+                                        <option value=\"\">Modül seçiniz...</option>\r\n+                                        <?php foreach ($moduller as $modul): ?>\r\n+                                            <?php if ($modul['durum'] == 1): ?>\r\n+                                                <option value=\"<?php echo $modul['modul_id']; ?>\">\r\n+                                                    <?php echo htmlspecialchars($modul['modul_adi']); ?>\r\n+                                                </option>\r\n+                                            <?php endif; ?>\r\n+                                        <?php endforeach; ?>\r\n+                                    </select>\r\n+                                    \r\n+                                    <label for=\"mm_menu_id\" class=\"form-label mt-2\">Menü Seç</label>\r\n+                                    <select class=\"form-select\" id=\"mm_menu_id\" name=\"hedef_id\">\r\n+                                        <option value=\"\">Önce modül seçiniz...</option>\r\n+                                    </select>\r\n+                                </div>\r\n+                                \r\n+                                <div class=\"mb-3\">\r\n+                                    <label for=\"mm_user_group_id\" class=\"form-label\">Kullanıcı Grubu</label>\r\n+                                    <select class=\"form-select\" id=\"mm_user_group_id\" name=\"user_group_id\" required>\r\n+                                        <option value=\"\">Grup seçiniz...</option>\r\n+                                        <?php foreach ($userGroups as $group): ?>\r\n+                                            <option value=\"<?php echo $group['id']; ?>\">\r\n+                                                <?php echo htmlspecialchars($group['group_name']); ?>\r\n+                                            </option>\r\n+                                        <?php endforeach; ?>\r\n+                                    </select>\r\n+                                </div>\r\n+                                \r\n+                                <div class=\"mb-3\">\r\n+                                    <label class=\"form-label d-block\">Yetki</label>\r\n+                                    <div class=\"form-check\">\r\n+                                        <input class=\"form-check-input\" type=\"checkbox\" name=\"gor\" id=\"mm_gor\" value=\"1\" checked>\r\n+                                        <label class=\"form-check-label\" for=\"mm_gor\">\r\n+                                            <i class=\"fas fa-eye me-1\"></i>Görüntüleme (Bu modül/menüyü görebilir)\r\n+                                        </label>\r\n+                                    </div>\r\n+                                    <small class=\"text-muted\">Modül/Menü için sadece görüntüleme yetkisi tanımlanır.</small>\r\n+                                </div>\r\n+                                \r\n+                                <div class=\"mb-3\">\r\n+                                    <label for=\"mm_durum\" class=\"form-label\">Durum</label>\r\n+                                    <select class=\"form-select\" id=\"mm_durum\" name=\"durum\">\r\n+                                        <option value=\"1\">Aktif</option>\r\n+                                        <option value=\"0\">Pasif</option>\r\n+                                    </select>\r\n+                                </div>\r\n+                                \r\n+                                <button type=\"submit\" class=\"btn btn-danger w-100\">\r\n+                                    <i class=\"fas fa-save me-1\"></i>Kaydet\r\n+                                </button>\r\n+                            </form>\r\n+                        </div>\r\n+                    </div>\r\n+                </div>\r\n+                \r\n+                <div class=\"col-lg-7\">\r\n+                    <div class=\"card border-0 shadow-sm\">\r\n+                        <div class=\"card-header bg-danger text-white\">\r\n+                            <h5 class=\"mb-0\"><i class=\"fas fa-list me-2\"></i>Modül/Menü Yetki Listesi</h5>\r\n+                        </div>\r\n+                        <div class=\"card-body p-0\">\r\n+                            <div class=\"table-responsive\">\r\n+                                <table class=\"table table-hover mb-0\">\r\n+                                    <thead class=\"table-light\">\r\n+                                        <tr>\r\n+                                            <th>Tip</th>\r\n+                                            <th>Hedef</th>\r\n+                                            <th>Kullanıcı Grubu</th>\r\n+                                            <th>Görüntüleme</th>\r\n+                                            <th>Durum</th>\r\n+                                            <th>İşlemler</th>\r\n+                                        </tr>\r\n+                                    </thead>\r\n+                                    <tbody>\r\n+                                        <?php if (!empty($modulMenuYetkiler)): ?>\r\n+                                            <?php foreach ($modulMenuYetkiler as $yetki): ?>\r\n+                                                <tr>\r\n+                                                    <td>\r\n+                                                        <span class=\"badge bg-<?php echo $yetki['hedef_tip'] == 'Modül' ? 'primary' : 'success'; ?>\">\r\n+                                                            <?php echo htmlspecialchars($yetki['hedef_tip']); ?>\r\n+                                                        </span>\r\n+                                                    </td>\r\n+                                                    <td>\r\n+                                                        <?php if ($yetki['hedef_tip'] == 'Modül'): ?>\r\n+                                                            <strong><i class=\"fas fa-cube me-1\"></i><?php echo htmlspecialchars($yetki['modul_adi'] ?? '-'); ?></strong>\r\n+                                                        <?php else: ?>\r\n+                                                            <small class=\"text-muted\"><?php echo htmlspecialchars($yetki['modul_adi'] ?? '-'); ?></small><br>\r\n+                                                            <strong><i class=\"fas fa-bars me-1\"></i><?php echo htmlspecialchars($yetki['menu_adi'] ?? '-'); ?></strong>\r\n+                                                        <?php endif; ?>\r\n+                                                    </td>\r\n+                                                    <td><?php echo htmlspecialchars($yetki['grup_adi'] ?? '-'); ?></td>\r\n+                                                    <td>\r\n+                                                        <?php if ($yetki['gor']): ?>\r\n+                                                            <i class=\"fas fa-check-circle text-success\"></i>\r\n+                                                        <?php else: ?>\r\n+                                                            <i class=\"fas fa-times-circle text-danger\"></i>\r\n+                                                        <?php endif; ?>\r\n+                                                    </td>\r\n+                                                    <td>\r\n+                                                        <span class=\"badge bg-<?php echo $yetki['durum'] == 1 ? 'success' : 'secondary'; ?>\">\r\n+                                                            <?php echo $yetki['durum'] == 1 ? 'Aktif' : 'Pasif'; ?>\r\n+                                                        </span>\r\n+                                                    </td>\r\n+                                                    <td>\r\n+                                                        <div class=\"btn-group\" role=\"group\">\r\n+                                                            <button type=\"button\" class=\"btn btn-sm btn-outline-primary\" \r\n+                                                                    onclick=\"editModulMenuYetki(<?php echo htmlspecialchars(json_encode($yetki)); ?>)\">\r\n+                                                                <i class=\"fas fa-edit\"></i>\r\n+                                                            </button>\r\n+                                                            <button type=\"button\" class=\"btn btn-sm btn-outline-danger\" \r\n+                                                                    onclick=\"deleteModulMenuYetki(<?php echo $yetki['modul_menu_yetki_id']; ?>)\">\r\n+                                                                <i class=\"fas fa-trash\"></i>\r\n+                                                            </button>\r\n+                                                        </div>\r\n+                                                    </td>\r\n+                                                </tr>\r\n+                                            <?php endforeach; ?>\r\n+                                        <?php else: ?>\r\n+                                            <tr>\r\n+                                                <td colspan=\"6\" class=\"text-center py-4 text-muted\">Henüz modül/menü yetkisi tanımlanmamış</td>\r\n+                                            </tr>\r\n+                                        <?php endif; ?>\r\n+                                    </tbody>\r\n+                                </table>\r\n+                            </div>\r\n+                        </div>\r\n+                    </div>\r\n+                </div>\r\n+            </div>\r\n+        </div>\r\n+\r\n         <!-- Yetki Tanımlama -->\r\n         <div class=\"tab-pane fade\" id=\"yetki\" role=\"tabpanel\">\r\n             <div class=\"row\">\r\n                 <div class=\"col-lg-5\">\r\n@@ -1543,8 +1850,58 @@\n         </div>\r\n     </div>\r\n </div>\r\n \r\n+<!-- Modül/Menü Yetki Düzenle Modal -->\r\n+<div class=\"modal fade\" id=\"editModulMenuYetkiModal\" tabindex=\"-1\">\r\n+    <div class=\"modal-dialog\">\r\n+        <div class=\"modal-content\">\r\n+            <form method=\"POST\" action=\"\">\r\n+                <input type=\"hidden\" name=\"action\" value=\"edit_modul_menu_yetki\">\r\n+                <input type=\"hidden\" name=\"mm_yetki_id\" id=\"edit_mm_yetki_id\">\r\n+                <div class=\"modal-header\">\r\n+                    <h5 class=\"modal-title\">\r\n+                        <i class=\"fas fa-edit me-2\"></i>Modül/Menü Yetkisi Düzenle\r\n+                    </h5>\r\n+                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n+                </div>\r\n+                <div class=\"modal-body\">\r\n+                    <div class=\"mb-3\">\r\n+                        <label class=\"form-label\">Hedef</label>\r\n+                        <input type=\"text\" class=\"form-control\" id=\"edit_mm_hedef_info\" disabled>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label class=\"form-label\">Kullanıcı Grubu</label>\r\n+                        <input type=\"text\" class=\"form-control\" id=\"edit_mm_grup_info\" disabled>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label class=\"form-label d-block\">Yetki</label>\r\n+                        <div class=\"form-check\">\r\n+                            <input class=\"form-check-input\" type=\"checkbox\" name=\"gor\" id=\"edit_mm_gor\" value=\"1\">\r\n+                            <label class=\"form-check-label\" for=\"edit_mm_gor\">\r\n+                                <i class=\"fas fa-eye me-1\"></i>Görüntüleme\r\n+                            </label>\r\n+                        </div>\r\n+                    </div>\r\n+                    <div class=\"mb-3\">\r\n+                        <label for=\"edit_mm_durum\" class=\"form-label\">Durum</label>\r\n+                        <select class=\"form-select\" id=\"edit_mm_durum\" name=\"durum\">\r\n+                            <option value=\"1\">Aktif</option>\r\n+                            <option value=\"0\">Pasif</option>\r\n+                        </select>\r\n+                    </div>\r\n+                </div>\r\n+                <div class=\"modal-footer\">\r\n+                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">İptal</button>\r\n+                    <button type=\"submit\" class=\"btn btn-primary\">\r\n+                        <i class=\"fas fa-save me-1\"></i>Güncelle\r\n+                    </button>\r\n+                </div>\r\n+            </form>\r\n+        </div>\r\n+    </div>\r\n+</div>\r\n+\r\n <!-- Yetki Düzenle Modal -->\r\n <div class=\"modal fade\" id=\"editYetkiModal\" tabindex=\"-1\">\r\n     <div class=\"modal-dialog\">\r\n         <div class=\"modal-content\">\r\n@@ -1778,7 +2135,77 @@\n         document.body.appendChild(form);\r\n         form.submit();\r\n     }\r\n }\r\n+\r\n+// Modül/Menü Yetki - Hedef Tipi Değişimi\r\n+function updateHedefDropdown() {\r\n+    const hedefTip = document.querySelector('input[name=\"hedef_tip\"]:checked').value;\r\n+    const modulContainer = document.getElementById('modul_select_container');\r\n+    const menuContainer = document.getElementById('menu_select_container');\r\n+    \r\n+    if (hedefTip === 'modul') {\r\n+        modulContainer.style.display = 'block';\r\n+        menuContainer.style.display = 'none';\r\n+        document.getElementById('mm_modul_id').required = true;\r\n+        document.getElementById('mm_menu_id').required = false;\r\n+    } else {\r\n+        modulContainer.style.display = 'none';\r\n+        menuContainer.style.display = 'block';\r\n+        document.getElementById('mm_modul_id').required = false;\r\n+        document.getElementById('mm_menu_id').required = true;\r\n+    }\r\n+}\r\n+\r\n+// Modül/Menü Yetki - Menü Dropdown Güncelleme\r\n+function updateMMMenuDropdown() {\r\n+    const modulId = document.getElementById('mm_menu_modul_id').value;\r\n+    const menuDropdown = document.getElementById('mm_menu_id');\r\n+    \r\n+    menuDropdown.innerHTML = '<option value=\"\">Menü seçiniz...</option>';\r\n+    \r\n+    if (modulId) {\r\n+        const filteredMenuler = menulerData.filter(m => m.modul_id == modulId && m.durum == 1);\r\n+        filteredMenuler.forEach(menu => {\r\n+            const option = document.createElement('option');\r\n+            option.value = menu.menu_id;\r\n+            option.textContent = menu.menu_adi;\r\n+            menuDropdown.appendChild(option);\r\n+        });\r\n+    }\r\n+}\r\n+\r\n+// Modül/Menü Yetki Düzenleme\r\n+function editModulMenuYetki(yetki) {\r\n+    document.getElementById('edit_mm_yetki_id').value = yetki.modul_menu_yetki_id;\r\n+    \r\n+    let hedefInfo = '';\r\n+    if (yetki.hedef_tip === 'Modül') {\r\n+        hedefInfo = 'Modül: ' + yetki.modul_adi;\r\n+    } else {\r\n+        hedefInfo = 'Menü: ' + yetki.menu_adi;\r\n+    }\r\n+    \r\n+    document.getElementById('edit_mm_hedef_info').value = hedefInfo;\r\n+    document.getElementById('edit_mm_grup_info').value = yetki.grup_adi;\r\n+    document.getElementById('edit_mm_gor').checked = yetki.gor == 1;\r\n+    document.getElementById('edit_mm_durum').value = yetki.durum;\r\n+    \r\n+    new bootstrap.Modal(document.getElementById('editModulMenuYetkiModal')).show();\r\n+}\r\n+\r\n+// Modül/Menü Yetki Silme\r\n+function deleteModulMenuYetki(yetkiId) {\r\n+    if (confirm('Bu modül/menü yetkisini silmek istediğinizden emin misiniz?\\n\\nBu işlem geri alınamaz.')) {\r\n+        const form = document.createElement('form');\r\n+        form.method = 'POST';\r\n+        form.innerHTML = `\r\n+            <input type=\"hidden\" name=\"action\" value=\"delete_modul_menu_yetki\">\r\n+            <input type=\"hidden\" name=\"mm_yetki_id\" value=\"${yetkiId}\">\r\n+        `;\r\n+        document.body.appendChild(form);\r\n+        form.submit();\r\n+    }\r\n+}\r\n </script>\r\n \r\n <?php include '../../../includes/footer.php'; ?>\r\n"
                },
                {
                    "date": 1761133173236,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1269,9 +1269,9 @@\n                         <div class=\"card-header bg-danger text-white\">\r\n                             <h5 class=\"mb-0\"><i class=\"fas fa-plus me-2\"></i>Yeni Modül/Menü Yetkisi Ekle</h5>\r\n                         </div>\r\n                         <div class=\"card-body\">\r\n-                            <form method=\"POST\" action=\"\">\r\n+                            <form method=\"POST\" action=\"\" id=\"modulMenuYetkiForm\" onsubmit=\"return prepareModulMenuYetkiForm()\">\r\n                                 <input type=\"hidden\" name=\"action\" value=\"add_modul_menu_yetki\">\r\n                                 \r\n                                 <div class=\"mb-3\">\r\n                                     <label class=\"form-label\">Hedef Tipi</label>\r\n@@ -1289,9 +1289,9 @@\n                                 </div>\r\n                                 \r\n                                 <div class=\"mb-3\" id=\"modul_select_container\">\r\n                                     <label for=\"mm_modul_id\" class=\"form-label\">Modül Seç</label>\r\n-                                    <select class=\"form-select\" id=\"mm_modul_id\" name=\"hedef_id\" required>\r\n+                                    <select class=\"form-select\" id=\"mm_modul_id\" required>\r\n                                         <option value=\"\">Modül seçiniz...</option>\r\n                                         <?php foreach ($moduller as $modul): ?>\r\n                                             <?php if ($modul['durum'] == 1): ?>\r\n                                                 <option value=\"<?php echo $modul['modul_id']; ?>\">\r\n@@ -1315,13 +1315,16 @@\n                                         <?php endforeach; ?>\r\n                                     </select>\r\n                                     \r\n                                     <label for=\"mm_menu_id\" class=\"form-label mt-2\">Menü Seç</label>\r\n-                                    <select class=\"form-select\" id=\"mm_menu_id\" name=\"hedef_id\">\r\n+                                    <select class=\"form-select\" id=\"mm_menu_id\">\r\n                                         <option value=\"\">Önce modül seçiniz...</option>\r\n                                     </select>\r\n                                 </div>\r\n                                 \r\n+                                <!-- Hidden input for hedef_id -->\r\n+                                <input type=\"hidden\" name=\"hedef_id\" id=\"hedef_id_input\">\r\n+                                \r\n                                 <div class=\"mb-3\">\r\n                                     <label for=\"mm_user_group_id\" class=\"form-label\">Kullanıcı Grubu</label>\r\n                                     <select class=\"form-select\" id=\"mm_user_group_id\" name=\"user_group_id\" required>\r\n                                         <option value=\"\">Grup seçiniz...</option>\r\n@@ -2155,8 +2158,32 @@\n         document.getElementById('mm_menu_id').required = true;\r\n     }\r\n }\r\n \r\n+// Form submit öncesi hedef_id'yi hazırla\r\n+function prepareModulMenuYetkiForm() {\r\n+    const hedefTip = document.querySelector('input[name=\"hedef_tip\"]:checked').value;\r\n+    const hedefIdInput = document.getElementById('hedef_id_input');\r\n+    \r\n+    if (hedefTip === 'modul') {\r\n+        const modulId = document.getElementById('mm_modul_id').value;\r\n+        if (!modulId) {\r\n+            alert('Lütfen bir modül seçiniz.');\r\n+            return false;\r\n+        }\r\n+        hedefIdInput.value = modulId;\r\n+    } else {\r\n+        const menuId = document.getElementById('mm_menu_id').value;\r\n+        if (!menuId) {\r\n+            alert('Lütfen bir menü seçiniz.');\r\n+            return false;\r\n+        }\r\n+        hedefIdInput.value = menuId;\r\n+    }\r\n+    \r\n+    return true;\r\n+}\r\n+\r\n // Modül/Menü Yetki - Menü Dropdown Güncelleme\r\n function updateMMMenuDropdown() {\r\n     const modulId = document.getElementById('mm_menu_modul_id').value;\r\n     const menuDropdown = document.getElementById('mm_menu_id');\r\n"
                },
                {
                    "date": 1761134569538,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -417,14 +417,64 @@\n                     $messageType = 'danger';\r\n                     break;\r\n                 }\r\n                 \r\n+                // Eski sayfa bilgilerini al (dosya taşıma için)\r\n+                $oldSayfaSql = \"SELECT s.sayfa_url, s.menu_id, m.menu_url, m.modul_id, mod.modul_url \r\n+                               FROM tanim_sayfalar s \r\n+                               LEFT JOIN tanim_menuler m ON s.menu_id = m.menu_id \r\n+                               LEFT JOIN tanim_moduller mod ON m.modul_id = mod.modul_id \r\n+                               WHERE s.sayfa_id = ?\";\r\n+                $oldSayfaStmt = $conn->prepare($oldSayfaSql);\r\n+                $oldSayfaStmt->execute([$sayfaId]);\r\n+                $oldSayfaData = $oldSayfaStmt->fetch();\r\n+                \r\n+                // Yeni menü bilgilerini al\r\n+                $newMenuSql = \"SELECT m.menu_url, m.modul_id, mod.modul_url \r\n+                               FROM tanim_menuler m \r\n+                               LEFT JOIN tanim_moduller mod ON m.modul_id = mod.modul_id \r\n+                               WHERE m.menu_id = ?\";\r\n+                $newMenuStmt = $conn->prepare($newMenuSql);\r\n+                $newMenuStmt->execute([$menuId]);\r\n+                $newMenuData = $newMenuStmt->fetch();\r\n+                \r\n+                // Modül veya menü değiştiyse ve dosya varsa taşı\r\n+                if ($oldSayfaData && $newMenuData && \r\n+                    !empty($oldSayfaData['modul_url']) && \r\n+                    !empty($oldSayfaData['menu_url']) && \r\n+                    !empty($newMenuData['modul_url']) && \r\n+                    !empty($newMenuData['menu_url']) && \r\n+                    !empty($oldSayfaData['sayfa_url'])) {\r\n+                    \r\n+                    $viewsBase = dirname(__DIR__, 2);\r\n+                    $oldPath = $viewsBase . '/' . $oldSayfaData['modul_url'] . '/' . $oldSayfaData['menu_url'] . '/' . $oldSayfaData['sayfa_url'];\r\n+                    $newPath = $viewsBase . '/' . $newMenuData['modul_url'] . '/' . $newMenuData['menu_url'] . '/' . $oldSayfaData['sayfa_url'];\r\n+                    \r\n+                    // Eski ve yeni yol farklıysa taşı (menü veya modül değişimi)\r\n+                    if ($oldPath !== $newPath && file_exists($oldPath) && !file_exists($newPath)) {\r\n+                        // Hedef klasör yoksa oluştur\r\n+                        $targetDir = $viewsBase . '/' . $newMenuData['modul_url'] . '/' . $newMenuData['menu_url'];\r\n+                        if (!is_dir($targetDir)) {\r\n+                            mkdir($targetDir, 0755, true);\r\n+                        }\r\n+                        \r\n+                        // Dosyayı taşı\r\n+                        if (rename($oldPath, $newPath)) {\r\n+                            $message = 'Sayfa güncellendi ve dosya yeni konuma taşındı.';\r\n+                        } else {\r\n+                            $message = 'Sayfa güncellendi ancak dosya taşınamadı.';\r\n+                        }\r\n+                    }\r\n+                }\r\n+                \r\n                 $sql = \"UPDATE tanim_sayfalar SET menu_id = ?, sayfa_adi = ?, sayfa_url = ?, aciklama = ?, sayfa_ikon = ?, sira_no = ?, durum = ?, dashboard = ?, updated_at = GETDATE() \r\n                         WHERE sayfa_id = ?\";\r\n                 $stmt = $conn->prepare($sql);\r\n                 $stmt->execute([$menuId, $sayfaAdi, $sayfaUrl, $aciklama, $sayfaIkon, $siraNo, $durum, $dashboard, $sayfaId]);\r\n                 \r\n-                $message = 'Sayfa başarıyla güncellendi.';\r\n+                if (empty($message)) {\r\n+                    $message = 'Sayfa başarıyla güncellendi.';\r\n+                }\r\n                 $messageType = 'success';\r\n                 break;\r\n                 \r\n             case 'add_yetki':\r\n"
                }
            ],
            "date": 1761042748670,
            "name": "Commit-0",
            "content": "<?php\r\n// Enable error reporting for debugging\r\nini_set('display_errors', 1);\r\nini_set('display_startup_errors', 1);\r\nerror_reporting(E_ALL);\r\n\r\n$pageTitle = \"Sayfa Tanım ve Yetkilendirme\";\r\n$breadcrumbs = [\r\n    ['title' => 'Sayfa Tanım ve Yetkilendirme']\r\n];\r\n\r\n// Auth kontrol\r\ntry {\r\n    require_once '../../../auth.php';\r\n    $currentUser = checkAdminAuth(); // Sadece admin erişebilir\r\n} catch (Exception $e) {\r\n    die(\"Auth hatası: \" . $e->getMessage());\r\n}\r\n\r\n$message = '';\r\n$messageType = '';\r\n\r\n// İşlemler\r\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\r\n    try {\r\n        $conn = getDatabaseConnection();\r\n        \r\n        $action = $_POST['action'] ?? '';\r\n        \r\n        switch ($action) {\r\n            case 'add_modul':\r\n                $modulAdi = trim($_POST['modul_adi']);\r\n                $modulUrl = trim($_POST['modul_url']);\r\n                $aciklama = trim($_POST['aciklama'] ?? '');\r\n                $durum = $_POST['durum'] ?? 1;\r\n                \r\n                if (empty($modulAdi)) {\r\n                    $message = 'Modül adı alanı zorunludur.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                // Modül adı kontrolü\r\n                $checkSql = \"SELECT modul_id FROM tanim_moduller WHERE modul_adi = ?\";\r\n                $checkStmt = $conn->prepare($checkSql);\r\n                $checkStmt->execute([$modulAdi]);\r\n                \r\n                if ($checkStmt->fetch()) {\r\n                    $message = 'Bu modül adı zaten kullanılmaktadır.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                $sql = \"INSERT INTO tanim_moduller (modul_adi, modul_url, aciklama, durum, created_at) \r\n                        VALUES (?, ?, ?, ?, GETDATE())\";\r\n                $stmt = $conn->prepare($sql);\r\n                $stmt->execute([$modulAdi, $modulUrl, $aciklama, $durum]);\r\n                \r\n                $message = 'Modül başarıyla tanımlandı.';\r\n                $messageType = 'success';\r\n                break;\r\n                \r\n            case 'add_menu':\r\n                $modulId = (int)$_POST['modul_id'];\r\n                $menuAdi = trim($_POST['menu_adi']);\r\n                $menuUrl = trim($_POST['menu_url']);\r\n                $ikon = trim($_POST['ikon'] ?? '');\r\n                $siraNo = (int)($_POST['sira_no'] ?? 0);\r\n                $durum = $_POST['durum'] ?? 1;\r\n                \r\n                if ($modulId <= 0) {\r\n                    $message = 'Lütfen bir modül seçiniz.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                if (empty($menuAdi)) {\r\n                    $message = 'Menü adı alanı zorunludur.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                $sql = \"INSERT INTO tanim_menuler (modul_id, menu_adi, menu_url, ikon, sira_no, durum, created_at) \r\n                        VALUES (?, ?, ?, ?, ?, ?, GETDATE())\";\r\n                $stmt = $conn->prepare($sql);\r\n                $stmt->execute([$modulId, $menuAdi, $menuUrl, $ikon, $siraNo, $durum]);\r\n                \r\n                $message = 'Menü başarıyla tanımlandı.';\r\n                $messageType = 'success';\r\n                break;\r\n                \r\n            case 'add_sayfa':\r\n                $menuId = (int)$_POST['menu_id'];\r\n                $sayfaAdi = trim($_POST['sayfa_adi']);\r\n                $sayfaUrl = trim($_POST['sayfa_url']);\r\n                $aciklama = trim($_POST['aciklama'] ?? '');\r\n                $durum = $_POST['durum'] ?? 1;\r\n                \r\n                if ($menuId <= 0) {\r\n                    $message = 'Lütfen bir menü seçiniz.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                if (empty($sayfaAdi)) {\r\n                    $message = 'Sayfa adı alanı zorunludur.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                $sql = \"INSERT INTO tanim_sayfalar (menu_id, sayfa_adi, sayfa_url, aciklama, durum, created_at) \r\n                        VALUES (?, ?, ?, ?, ?, GETDATE())\";\r\n                $stmt = $conn->prepare($sql);\r\n                $stmt->execute([$menuId, $sayfaAdi, $sayfaUrl, $aciklama, $durum]);\r\n                \r\n                $message = 'Sayfa başarıyla tanımlandı.';\r\n                $messageType = 'success';\r\n                break;\r\n                \r\n            case 'add_yetki':\r\n                $sayfaId = (int)$_POST['sayfa_id'];\r\n                $userGroupId = (int)$_POST['user_group_id'];\r\n                $gor = isset($_POST['gor']) ? 1 : 0;\r\n                $kendiKullaniciniGor = isset($_POST['kendi_kullanicini_gor']) ? 1 : 0;\r\n                $ekle = isset($_POST['ekle']) ? 1 : 0;\r\n                $duzenle = isset($_POST['duzenle']) ? 1 : 0;\r\n                $sil = isset($_POST['sil']) ? 1 : 0;\r\n                $durum = $_POST['durum'] ?? 1;\r\n                \r\n                if ($sayfaId <= 0) {\r\n                    $message = 'Lütfen bir sayfa seçiniz.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                if ($userGroupId <= 0) {\r\n                    $message = 'Lütfen bir kullanıcı grubu seçiniz.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                // Yetki kontrolü - aynı sayfa ve grup için tekrar yetki tanımlanmasın\r\n                $checkSql = \"SELECT sayfa_yetki_id FROM tanim_sayfa_yetkiler WHERE sayfa_id = ? AND user_group_id = ?\";\r\n                $checkStmt = $conn->prepare($checkSql);\r\n                $checkStmt->execute([$sayfaId, $userGroupId]);\r\n                \r\n                if ($checkStmt->fetch()) {\r\n                    $message = 'Bu sayfa için bu kullanıcı grubuna zaten yetki tanımlanmıştır.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                $sql = \"INSERT INTO tanim_sayfa_yetkiler (sayfa_id, user_group_id, gor, kendi_kullanicini_gor, ekle, duzenle, sil, durum, created_at) \r\n                        VALUES (?, ?, ?, ?, ?, ?, ?, ?, GETDATE())\";\r\n                $stmt = $conn->prepare($sql);\r\n                $stmt->execute([$sayfaId, $userGroupId, $gor, $kendiKullaniciniGor, $ekle, $duzenle, $sil, $durum]);\r\n                \r\n                $message = 'Yetki başarıyla tanımlandı.';\r\n                $messageType = 'success';\r\n                break;\r\n                \r\n            case 'edit_yetki':\r\n                $yetkiId = (int)$_POST['yetki_id'];\r\n                $gor = isset($_POST['gor']) ? 1 : 0;\r\n                $kendiKullaniciniGor = isset($_POST['kendi_kullanicini_gor']) ? 1 : 0;\r\n                $ekle = isset($_POST['ekle']) ? 1 : 0;\r\n                $duzenle = isset($_POST['duzenle']) ? 1 : 0;\r\n                $sil = isset($_POST['sil']) ? 1 : 0;\r\n                $durum = $_POST['durum'] ?? 1;\r\n                \r\n                if ($yetkiId <= 0) {\r\n                    $message = 'Geçersiz yetki ID.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                $sql = \"UPDATE tanim_sayfa_yetkiler SET gor = ?, kendi_kullanicini_gor = ?, ekle = ?, duzenle = ?, sil = ?, durum = ?, updated_at = GETDATE() \r\n                        WHERE sayfa_yetki_id = ?\";\r\n                $stmt = $conn->prepare($sql);\r\n                $stmt->execute([$gor, $kendiKullaniciniGor, $ekle, $duzenle, $sil, $durum, $yetkiId]);\r\n                \r\n                $message = 'Yetki başarıyla güncellendi.';\r\n                $messageType = 'success';\r\n                break;\r\n                \r\n            case 'delete_yetki':\r\n                $yetkiId = (int)$_POST['yetki_id'];\r\n                \r\n                if ($yetkiId <= 0) {\r\n                    $message = 'Geçersiz yetki ID.';\r\n                    $messageType = 'danger';\r\n                    break;\r\n                }\r\n                \r\n                $sql = \"DELETE FROM tanim_sayfa_yetkiler WHERE sayfa_yetki_id = ?\";\r\n                $stmt = $conn->prepare($sql);\r\n                $stmt->execute([$yetkiId]);\r\n                \r\n                $message = 'Yetki başarıyla silindi.';\r\n                $messageType = 'success';\r\n                break;\r\n                \r\n            default:\r\n                $message = 'Geçersiz işlem.';\r\n                $messageType = 'danger';\r\n                break;\r\n        }\r\n    } catch (Exception $e) {\r\n        error_log(\"POST operation error: \" . $e->getMessage());\r\n        $message = 'Hata: ' . $e->getMessage();\r\n        $messageType = 'danger';\r\n    }\r\n}\r\n\r\n// Verileri listele\r\n$moduller = [];\r\n$menuler = [];\r\n$sayfalar = [];\r\n$yetkiler = [];\r\n$userGroups = [];\r\n$error = '';\r\n\r\ntry {\r\n    $conn = getDatabaseConnection();\r\n    \r\n    // Modülleri getir\r\n    $sql = \"SELECT * FROM tanim_moduller ORDER BY created_at DESC\";\r\n    $stmt = $conn->prepare($sql);\r\n    $stmt->execute();\r\n    $moduller = $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n    \r\n    // Menüleri getir\r\n    $sql = \"SELECT m.*, mod.modul_adi \r\n            FROM tanim_menuler m \r\n            LEFT JOIN tanim_moduller mod ON m.modul_id = mod.modul_id \r\n            ORDER BY m.sira_no, m.created_at DESC\";\r\n    $stmt = $conn->prepare($sql);\r\n    $stmt->execute();\r\n    $menuler = $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n    \r\n    // Sayfaları getir\r\n    $sql = \"SELECT s.*, m.menu_adi, mod.modul_adi \r\n            FROM tanim_sayfalar s \r\n            LEFT JOIN tanim_menuler m ON s.menu_id = m.menu_id \r\n            LEFT JOIN tanim_moduller mod ON m.modul_id = mod.modul_id \r\n            ORDER BY s.created_at DESC\";\r\n    $stmt = $conn->prepare($sql);\r\n    $stmt->execute();\r\n    $sayfalar = $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n    \r\n    // Yetkileri getir\r\n    $sql = \"SELECT y.*, s.sayfa_adi, m.menu_adi, mod.modul_adi, ug.group_name as grup_adi\r\n            FROM tanim_sayfa_yetkiler y \r\n            LEFT JOIN tanim_sayfalar s ON y.sayfa_id = s.sayfa_id \r\n            LEFT JOIN tanim_menuler m ON s.menu_id = m.menu_id \r\n            LEFT JOIN tanim_moduller mod ON m.modul_id = mod.modul_id \r\n            LEFT JOIN user_groups ug ON y.user_group_id = ug.id\r\n            ORDER BY y.created_at DESC\";\r\n    $stmt = $conn->prepare($sql);\r\n    $stmt->execute();\r\n    $yetkiler = $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n    \r\n    // Kullanıcı gruplarını getir\r\n    $sql = \"SELECT id, group_name FROM user_groups ORDER BY group_name\";\r\n    $stmt = $conn->prepare($sql);\r\n    $stmt->execute();\r\n    $userGroups = $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n    \r\n} catch (Exception $e) {\r\n    error_log(\"Error fetching data: \" . $e->getMessage());\r\n    $error = \"Veritabanı hatası: \" . $e->getMessage();\r\n}\r\n\r\ntry {\r\n    include '../../../includes/header.php';\r\n} catch (Exception $e) {\r\n    die(\"Header dosyası yüklenirken hata: \" . $e->getMessage());\r\n}\r\n?>\r\n\r\n<div class=\"container-fluid mt-4\">\r\n    <div class=\"row\">\r\n        <div class=\"col-12\">\r\n            <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n                <h2><i class=\"fas fa-shield-alt me-2\"></i>Sayfa Tanım ve Yetkilendirme</h2>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <?php if ($message): ?>\r\n        <div class=\"alert alert-<?php echo $messageType; ?> alert-dismissible fade show\" role=\"alert\">\r\n            <i class=\"fas fa-<?php echo $messageType === 'success' ? 'check-circle' : 'exclamation-triangle'; ?> me-2\"></i>\r\n            <?php echo htmlspecialchars($message); ?>\r\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>\r\n        </div>\r\n    <?php endif; ?>\r\n\r\n    <?php if ($error): ?>\r\n        <div class=\"alert alert-danger alert-dismissible fade show\" role=\"alert\">\r\n            <i class=\"fas fa-exclamation-triangle me-2\"></i>\r\n            <?php echo htmlspecialchars($error); ?>\r\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>\r\n        </div>\r\n    <?php endif; ?>\r\n\r\n    <!-- Tab Menü -->\r\n    <ul class=\"nav nav-tabs mb-4\" id=\"mainTabs\" role=\"tablist\">\r\n        <li class=\"nav-item\" role=\"presentation\">\r\n            <button class=\"nav-link active\" id=\"modul-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#modul\" type=\"button\">\r\n                <i class=\"fas fa-cube me-1\"></i>Modül Tanımlama\r\n            </button>\r\n        </li>\r\n        <li class=\"nav-item\" role=\"presentation\">\r\n            <button class=\"nav-link\" id=\"menu-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#menu\" type=\"button\">\r\n                <i class=\"fas fa-bars me-1\"></i>Menü Tanımlama\r\n            </button>\r\n        </li>\r\n        <li class=\"nav-item\" role=\"presentation\">\r\n            <button class=\"nav-link\" id=\"sayfa-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#sayfa\" type=\"button\">\r\n                <i class=\"fas fa-file me-1\"></i>Sayfa Tanımlama\r\n            </button>\r\n        </li>\r\n        <li class=\"nav-item\" role=\"presentation\">\r\n            <button class=\"nav-link\" id=\"yetki-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#yetki\" type=\"button\">\r\n                <i class=\"fas fa-key me-1\"></i>Yetki Tanımlama\r\n            </button>\r\n        </li>\r\n    </ul>\r\n\r\n    <!-- Tab İçerikler -->\r\n    <div class=\"tab-content\" id=\"mainTabsContent\">\r\n        \r\n        <!-- Modül Tanımlama -->\r\n        <div class=\"tab-pane fade show active\" id=\"modul\" role=\"tabpanel\">\r\n            <div class=\"row\">\r\n                <div class=\"col-lg-4\">\r\n                    <div class=\"card border-0 shadow-sm\">\r\n                        <div class=\"card-header bg-primary text-white\">\r\n                            <h5 class=\"mb-0\"><i class=\"fas fa-plus me-2\"></i>Yeni Modül Ekle</h5>\r\n                        </div>\r\n                        <div class=\"card-body\">\r\n                            <form method=\"POST\" action=\"\">\r\n                                <input type=\"hidden\" name=\"action\" value=\"add_modul\">\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"modul_adi\" class=\"form-label\">Modül Adı</label>\r\n                                    <input type=\"text\" class=\"form-control\" id=\"modul_adi\" name=\"modul_adi\" required \r\n                                           placeholder=\"Örn: Yönetim\">\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"modul_url\" class=\"form-label\">Modül URL</label>\r\n                                    <input type=\"text\" class=\"form-control\" id=\"modul_url\" name=\"modul_url\" \r\n                                           placeholder=\"Örn: /Yonetim\">\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"modul_aciklama\" class=\"form-label\">Açıklama</label>\r\n                                    <textarea class=\"form-control\" id=\"modul_aciklama\" name=\"aciklama\" rows=\"2\" \r\n                                              placeholder=\"Modül açıklaması...\"></textarea>\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"modul_durum\" class=\"form-label\">Durum</label>\r\n                                    <select class=\"form-select\" id=\"modul_durum\" name=\"durum\">\r\n                                        <option value=\"1\">Aktif</option>\r\n                                        <option value=\"0\">Pasif</option>\r\n                                    </select>\r\n                                </div>\r\n                                <button type=\"submit\" class=\"btn btn-primary w-100\">\r\n                                    <i class=\"fas fa-save me-1\"></i>Kaydet\r\n                                </button>\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"col-lg-8\">\r\n                    <div class=\"card border-0 shadow-sm\">\r\n                        <div class=\"card-header bg-primary text-white\">\r\n                            <h5 class=\"mb-0\"><i class=\"fas fa-list me-2\"></i>Modül Listesi</h5>\r\n                        </div>\r\n                        <div class=\"card-body p-0\">\r\n                            <div class=\"table-responsive\">\r\n                                <table class=\"table table-hover mb-0\">\r\n                                    <thead class=\"table-light\">\r\n                                        <tr>\r\n                                            <th>ID</th>\r\n                                            <th>Modül Adı</th>\r\n                                            <th>URL</th>\r\n                                            <th>Açıklama</th>\r\n                                            <th>Durum</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        <?php if (!empty($moduller)): ?>\r\n                                            <?php foreach ($moduller as $modul): ?>\r\n                                                <tr>\r\n                                                    <td><?php echo $modul['modul_id']; ?></td>\r\n                                                    <td><strong><?php echo htmlspecialchars($modul['modul_adi']); ?></strong></td>\r\n                                                    <td><?php echo htmlspecialchars($modul['modul_url'] ?? '-'); ?></td>\r\n                                                    <td><?php echo htmlspecialchars($modul['aciklama'] ?? '-'); ?></td>\r\n                                                    <td>\r\n                                                        <span class=\"badge bg-<?php echo $modul['durum'] == 1 ? 'success' : 'secondary'; ?>\">\r\n                                                            <?php echo $modul['durum'] == 1 ? 'Aktif' : 'Pasif'; ?>\r\n                                                        </span>\r\n                                                    </td>\r\n                                                </tr>\r\n                                            <?php endforeach; ?>\r\n                                        <?php else: ?>\r\n                                            <tr>\r\n                                                <td colspan=\"5\" class=\"text-center py-4 text-muted\">Henüz modül tanımlanmamış</td>\r\n                                            </tr>\r\n                                        <?php endif; ?>\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Menü Tanımlama -->\r\n        <div class=\"tab-pane fade\" id=\"menu\" role=\"tabpanel\">\r\n            <div class=\"row\">\r\n                <div class=\"col-lg-4\">\r\n                    <div class=\"card border-0 shadow-sm\">\r\n                        <div class=\"card-header bg-success text-white\">\r\n                            <h5 class=\"mb-0\"><i class=\"fas fa-plus me-2\"></i>Yeni Menü Ekle</h5>\r\n                        </div>\r\n                        <div class=\"card-body\">\r\n                            <form method=\"POST\" action=\"\">\r\n                                <input type=\"hidden\" name=\"action\" value=\"add_menu\">\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"menu_modul_id\" class=\"form-label\">Modül Seç</label>\r\n                                    <select class=\"form-select\" id=\"menu_modul_id\" name=\"modul_id\" required>\r\n                                        <option value=\"\">Modül seçiniz...</option>\r\n                                        <?php foreach ($moduller as $modul): ?>\r\n                                            <?php if ($modul['durum'] == 1): ?>\r\n                                                <option value=\"<?php echo $modul['modul_id']; ?>\">\r\n                                                    <?php echo htmlspecialchars($modul['modul_adi']); ?>\r\n                                                </option>\r\n                                            <?php endif; ?>\r\n                                        <?php endforeach; ?>\r\n                                    </select>\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"menu_adi\" class=\"form-label\">Menü Adı</label>\r\n                                    <input type=\"text\" class=\"form-control\" id=\"menu_adi\" name=\"menu_adi\" required \r\n                                           placeholder=\"Örn: Tanımlar\">\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"menu_url\" class=\"form-label\">Menü URL</label>\r\n                                    <input type=\"text\" class=\"form-control\" id=\"menu_url\" name=\"menu_url\" \r\n                                           placeholder=\"Örn: Tanimlar\">\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"menu_ikon\" class=\"form-label\">İkon</label>\r\n                                    <input type=\"text\" class=\"form-control\" id=\"menu_ikon\" name=\"ikon\" \r\n                                           placeholder=\"Örn: fa-list\">\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"menu_sira_no\" class=\"form-label\">Sıra No</label>\r\n                                    <input type=\"number\" class=\"form-control\" id=\"menu_sira_no\" name=\"sira_no\" value=\"0\">\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"menu_durum\" class=\"form-label\">Durum</label>\r\n                                    <select class=\"form-select\" id=\"menu_durum\" name=\"durum\">\r\n                                        <option value=\"1\">Aktif</option>\r\n                                        <option value=\"0\">Pasif</option>\r\n                                    </select>\r\n                                </div>\r\n                                <button type=\"submit\" class=\"btn btn-success w-100\">\r\n                                    <i class=\"fas fa-save me-1\"></i>Kaydet\r\n                                </button>\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"col-lg-8\">\r\n                    <div class=\"card border-0 shadow-sm\">\r\n                        <div class=\"card-header bg-success text-white\">\r\n                            <h5 class=\"mb-0\"><i class=\"fas fa-list me-2\"></i>Menü Listesi</h5>\r\n                        </div>\r\n                        <div class=\"card-body p-0\">\r\n                            <div class=\"table-responsive\">\r\n                                <table class=\"table table-hover mb-0\">\r\n                                    <thead class=\"table-light\">\r\n                                        <tr>\r\n                                            <th>ID</th>\r\n                                            <th>Modül</th>\r\n                                            <th>Menü Adı</th>\r\n                                            <th>URL</th>\r\n                                            <th>İkon</th>\r\n                                            <th>Sıra</th>\r\n                                            <th>Durum</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        <?php if (!empty($menuler)): ?>\r\n                                            <?php foreach ($menuler as $menu): ?>\r\n                                                <tr>\r\n                                                    <td><?php echo $menu['menu_id']; ?></td>\r\n                                                    <td><?php echo htmlspecialchars($menu['modul_adi'] ?? '-'); ?></td>\r\n                                                    <td><strong><?php echo htmlspecialchars($menu['menu_adi']); ?></strong></td>\r\n                                                    <td><?php echo htmlspecialchars($menu['menu_url'] ?? '-'); ?></td>\r\n                                                    <td><i class=\"fas <?php echo htmlspecialchars($menu['ikon'] ?? ''); ?>\"></i></td>\r\n                                                    <td><?php echo $menu['sira_no']; ?></td>\r\n                                                    <td>\r\n                                                        <span class=\"badge bg-<?php echo $menu['durum'] == 1 ? 'success' : 'secondary'; ?>\">\r\n                                                            <?php echo $menu['durum'] == 1 ? 'Aktif' : 'Pasif'; ?>\r\n                                                        </span>\r\n                                                    </td>\r\n                                                </tr>\r\n                                            <?php endforeach; ?>\r\n                                        <?php else: ?>\r\n                                            <tr>\r\n                                                <td colspan=\"7\" class=\"text-center py-4 text-muted\">Henüz menü tanımlanmamış</td>\r\n                                            </tr>\r\n                                        <?php endif; ?>\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Sayfa Tanımlama -->\r\n        <div class=\"tab-pane fade\" id=\"sayfa\" role=\"tabpanel\">\r\n            <div class=\"row\">\r\n                <div class=\"col-lg-4\">\r\n                    <div class=\"card border-0 shadow-sm\">\r\n                        <div class=\"card-header bg-info text-white\">\r\n                            <h5 class=\"mb-0\"><i class=\"fas fa-plus me-2\"></i>Yeni Sayfa Ekle</h5>\r\n                        </div>\r\n                        <div class=\"card-body\">\r\n                            <form method=\"POST\" action=\"\">\r\n                                <input type=\"hidden\" name=\"action\" value=\"add_sayfa\">\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"sayfa_modul_id\" class=\"form-label\">Modül Seç</label>\r\n                                    <select class=\"form-select\" id=\"sayfa_modul_id\" onchange=\"updateMenuDropdown()\">\r\n                                        <option value=\"\">Modül seçiniz...</option>\r\n                                        <?php foreach ($moduller as $modul): ?>\r\n                                            <?php if ($modul['durum'] == 1): ?>\r\n                                                <option value=\"<?php echo $modul['modul_id']; ?>\">\r\n                                                    <?php echo htmlspecialchars($modul['modul_adi']); ?>\r\n                                                </option>\r\n                                            <?php endif; ?>\r\n                                        <?php endforeach; ?>\r\n                                    </select>\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"sayfa_menu_id\" class=\"form-label\">Menü Seç</label>\r\n                                    <select class=\"form-select\" id=\"sayfa_menu_id\" name=\"menu_id\" required>\r\n                                        <option value=\"\">Önce modül seçiniz...</option>\r\n                                    </select>\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"sayfa_adi\" class=\"form-label\">Sayfa Adı</label>\r\n                                    <input type=\"text\" class=\"form-control\" id=\"sayfa_adi\" name=\"sayfa_adi\" required \r\n                                           placeholder=\"Örn: Bayi Hakedis Prim Dönem\">\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"sayfa_url\" class=\"form-label\">Sayfa URL</label>\r\n                                    <input type=\"text\" class=\"form-control\" id=\"sayfa_url\" name=\"sayfa_url\" \r\n                                           placeholder=\"Örn: bayi_hakedis_prim_donem.php\">\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"sayfa_aciklama\" class=\"form-label\">Açıklama</label>\r\n                                    <textarea class=\"form-control\" id=\"sayfa_aciklama\" name=\"aciklama\" rows=\"2\" \r\n                                              placeholder=\"Sayfa açıklaması...\"></textarea>\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"sayfa_durum\" class=\"form-label\">Durum</label>\r\n                                    <select class=\"form-select\" id=\"sayfa_durum\" name=\"durum\">\r\n                                        <option value=\"1\">Aktif</option>\r\n                                        <option value=\"0\">Pasif</option>\r\n                                    </select>\r\n                                </div>\r\n                                <button type=\"submit\" class=\"btn btn-info w-100 text-white\">\r\n                                    <i class=\"fas fa-save me-1\"></i>Kaydet\r\n                                </button>\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"col-lg-8\">\r\n                    <div class=\"card border-0 shadow-sm\">\r\n                        <div class=\"card-header bg-info text-white\">\r\n                            <h5 class=\"mb-0\"><i class=\"fas fa-list me-2\"></i>Sayfa Listesi</h5>\r\n                        </div>\r\n                        <div class=\"card-body p-0\">\r\n                            <div class=\"table-responsive\">\r\n                                <table class=\"table table-hover mb-0\">\r\n                                    <thead class=\"table-light\">\r\n                                        <tr>\r\n                                            <th>ID</th>\r\n                                            <th>Modül</th>\r\n                                            <th>Menü</th>\r\n                                            <th>Sayfa Adı</th>\r\n                                            <th>URL</th>\r\n                                            <th>Durum</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        <?php if (!empty($sayfalar)): ?>\r\n                                            <?php foreach ($sayfalar as $sayfa): ?>\r\n                                                <tr>\r\n                                                    <td><?php echo $sayfa['sayfa_id']; ?></td>\r\n                                                    <td><?php echo htmlspecialchars($sayfa['modul_adi'] ?? '-'); ?></td>\r\n                                                    <td><?php echo htmlspecialchars($sayfa['menu_adi'] ?? '-'); ?></td>\r\n                                                    <td><strong><?php echo htmlspecialchars($sayfa['sayfa_adi']); ?></strong></td>\r\n                                                    <td><?php echo htmlspecialchars($sayfa['sayfa_url'] ?? '-'); ?></td>\r\n                                                    <td>\r\n                                                        <span class=\"badge bg-<?php echo $sayfa['durum'] == 1 ? 'success' : 'secondary'; ?>\">\r\n                                                            <?php echo $sayfa['durum'] == 1 ? 'Aktif' : 'Pasif'; ?>\r\n                                                        </span>\r\n                                                    </td>\r\n                                                </tr>\r\n                                            <?php endforeach; ?>\r\n                                        <?php else: ?>\r\n                                            <tr>\r\n                                                <td colspan=\"6\" class=\"text-center py-4 text-muted\">Henüz sayfa tanımlanmamış</td>\r\n                                            </tr>\r\n                                        <?php endif; ?>\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Yetki Tanımlama -->\r\n        <div class=\"tab-pane fade\" id=\"yetki\" role=\"tabpanel\">\r\n            <div class=\"row\">\r\n                <div class=\"col-lg-5\">\r\n                    <div class=\"card border-0 shadow-sm\">\r\n                        <div class=\"card-header bg-warning text-dark\">\r\n                            <h5 class=\"mb-0\"><i class=\"fas fa-plus me-2\"></i>Yeni Yetki Ekle</h5>\r\n                        </div>\r\n                        <div class=\"card-body\">\r\n                            <form method=\"POST\" action=\"\">\r\n                                <input type=\"hidden\" name=\"action\" value=\"add_yetki\">\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"yetki_modul_id\" class=\"form-label\">Modül Seç</label>\r\n                                    <select class=\"form-select\" id=\"yetki_modul_id\" onchange=\"updateYetkiMenuDropdown()\">\r\n                                        <option value=\"\">Modül seçiniz...</option>\r\n                                        <?php foreach ($moduller as $modul): ?>\r\n                                            <?php if ($modul['durum'] == 1): ?>\r\n                                                <option value=\"<?php echo $modul['modul_id']; ?>\">\r\n                                                    <?php echo htmlspecialchars($modul['modul_adi']); ?>\r\n                                                </option>\r\n                                            <?php endif; ?>\r\n                                        <?php endforeach; ?>\r\n                                    </select>\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"yetki_menu_id\" class=\"form-label\">Menü Seç</label>\r\n                                    <select class=\"form-select\" id=\"yetki_menu_id\" onchange=\"updateYetkiSayfaDropdown()\">\r\n                                        <option value=\"\">Önce modül seçiniz...</option>\r\n                                    </select>\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"yetki_sayfa_id\" class=\"form-label\">Sayfa Seç</label>\r\n                                    <select class=\"form-select\" id=\"yetki_sayfa_id\" name=\"sayfa_id\" required>\r\n                                        <option value=\"\">Önce menü seçiniz...</option>\r\n                                    </select>\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"user_group_id\" class=\"form-label\">Kullanıcı Grubu</label>\r\n                                    <select class=\"form-select\" id=\"user_group_id\" name=\"user_group_id\" required>\r\n                                        <option value=\"\">Grup seçiniz...</option>\r\n                                        <?php foreach ($userGroups as $group): ?>\r\n                                            <option value=\"<?php echo $group['id']; ?>\">\r\n                                                <?php echo htmlspecialchars($group['group_name']); ?>\r\n                                            </option>\r\n                                        <?php endforeach; ?>\r\n                                    </select>\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label class=\"form-label d-block\">Yetkiler</label>\r\n                                    <div class=\"form-check\">\r\n                                        <input class=\"form-check-input\" type=\"checkbox\" name=\"gor\" id=\"gor\" value=\"1\">\r\n                                        <label class=\"form-check-label\" for=\"gor\">Görüntüleme</label>\r\n                                    </div>\r\n                                    <div class=\"form-check\">\r\n                                        <input class=\"form-check-input\" type=\"checkbox\" name=\"kendi_kullanicini_gor\" id=\"kendi_kullanicini_gor\" value=\"1\">\r\n                                        <label class=\"form-check-label\" for=\"kendi_kullanicini_gor\">Kendi Kullanıcısını Gör</label>\r\n                                    </div>\r\n                                    <div class=\"form-check\">\r\n                                        <input class=\"form-check-input\" type=\"checkbox\" name=\"ekle\" id=\"ekle\" value=\"1\">\r\n                                        <label class=\"form-check-label\" for=\"ekle\">Ekleme</label>\r\n                                    </div>\r\n                                    <div class=\"form-check\">\r\n                                        <input class=\"form-check-input\" type=\"checkbox\" name=\"duzenle\" id=\"duzenle\" value=\"1\">\r\n                                        <label class=\"form-check-label\" for=\"duzenle\">Düzenleme</label>\r\n                                    </div>\r\n                                    <div class=\"form-check\">\r\n                                        <input class=\"form-check-input\" type=\"checkbox\" name=\"sil\" id=\"sil\" value=\"1\">\r\n                                        <label class=\"form-check-label\" for=\"sil\">Silme</label>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"mb-3\">\r\n                                    <label for=\"yetki_durum\" class=\"form-label\">Durum</label>\r\n                                    <select class=\"form-select\" id=\"yetki_durum\" name=\"durum\">\r\n                                        <option value=\"1\">Aktif</option>\r\n                                        <option value=\"0\">Pasif</option>\r\n                                    </select>\r\n                                </div>\r\n                                <button type=\"submit\" class=\"btn btn-warning w-100\">\r\n                                    <i class=\"fas fa-save me-1\"></i>Kaydet\r\n                                </button>\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"col-lg-7\">\r\n                    <div class=\"card border-0 shadow-sm\">\r\n                        <div class=\"card-header bg-warning text-dark\">\r\n                            <h5 class=\"mb-0\"><i class=\"fas fa-list me-2\"></i>Yetki Listesi</h5>\r\n                        </div>\r\n                        <div class=\"card-body p-0\">\r\n                            <div class=\"table-responsive\">\r\n                                <table class=\"table table-hover mb-0\">\r\n                                    <thead class=\"table-light\">\r\n                                        <tr>\r\n                                            <th>Modül/Menü/Sayfa</th>\r\n                                            <th>Kullanıcı Grubu</th>\r\n                                            <th>Yetkiler</th>\r\n                                            <th>Durum</th>\r\n                                            <th>İşlemler</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        <?php if (!empty($yetkiler)): ?>\r\n                                            <?php foreach ($yetkiler as $yetki): ?>\r\n                                                <tr>\r\n                                                    <td>\r\n                                                        <small class=\"text-muted\"><?php echo htmlspecialchars($yetki['modul_adi'] ?? '-'); ?></small><br>\r\n                                                        <small class=\"text-muted\"><?php echo htmlspecialchars($yetki['menu_adi'] ?? '-'); ?></small><br>\r\n                                                        <strong><?php echo htmlspecialchars($yetki['sayfa_adi'] ?? '-'); ?></strong>\r\n                                                    </td>\r\n                                                    <td><?php echo htmlspecialchars($yetki['grup_adi'] ?? '-'); ?></td>\r\n                                                    <td>\r\n                                                        <?php if ($yetki['gor']): ?>\r\n                                                            <span class=\"badge bg-primary me-1\">Gör</span>\r\n                                                        <?php endif; ?>\r\n                                                        <?php if ($yetki['kendi_kullanicini_gor']): ?>\r\n                                                            <span class=\"badge bg-secondary me-1\">Kendi</span>\r\n                                                        <?php endif; ?>\r\n                                                        <?php if ($yetki['ekle']): ?>\r\n                                                            <span class=\"badge bg-success me-1\">Ekle</span>\r\n                                                        <?php endif; ?>\r\n                                                        <?php if ($yetki['duzenle']): ?>\r\n                                                            <span class=\"badge bg-info me-1\">Düzenle</span>\r\n                                                        <?php endif; ?>\r\n                                                        <?php if ($yetki['sil']): ?>\r\n                                                            <span class=\"badge bg-danger me-1\">Sil</span>\r\n                                                        <?php endif; ?>\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <span class=\"badge bg-<?php echo $yetki['durum'] == 1 ? 'success' : 'secondary'; ?>\">\r\n                                                            <?php echo $yetki['durum'] == 1 ? 'Aktif' : 'Pasif'; ?>\r\n                                                        </span>\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <div class=\"btn-group\" role=\"group\">\r\n                                                            <button type=\"button\" class=\"btn btn-sm btn-outline-primary\" \r\n                                                                    onclick=\"editYetki(<?php echo htmlspecialchars(json_encode($yetki)); ?>)\">\r\n                                                                <i class=\"fas fa-edit\"></i>\r\n                                                            </button>\r\n                                                            <button type=\"button\" class=\"btn btn-sm btn-outline-danger\" \r\n                                                                    onclick=\"deleteYetki(<?php echo $yetki['sayfa_yetki_id']; ?>)\">\r\n                                                                <i class=\"fas fa-trash\"></i>\r\n                                                            </button>\r\n                                                        </div>\r\n                                                    </td>\r\n                                                </tr>\r\n                                            <?php endforeach; ?>\r\n                                        <?php else: ?>\r\n                                            <tr>\r\n                                                <td colspan=\"5\" class=\"text-center py-4 text-muted\">Henüz yetki tanımlanmamış</td>\r\n                                            </tr>\r\n                                        <?php endif; ?>\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- Yetki Düzenle Modal -->\r\n<div class=\"modal fade\" id=\"editYetkiModal\" tabindex=\"-1\">\r\n    <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n            <form method=\"POST\" action=\"\">\r\n                <input type=\"hidden\" name=\"action\" value=\"edit_yetki\">\r\n                <input type=\"hidden\" name=\"yetki_id\" id=\"edit_yetki_id\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">\r\n                        <i class=\"fas fa-edit me-2\"></i>Yetki Düzenle\r\n                    </h5>\r\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <div class=\"mb-3\">\r\n                        <label class=\"form-label\">Sayfa</label>\r\n                        <input type=\"text\" class=\"form-control\" id=\"edit_sayfa_info\" disabled>\r\n                    </div>\r\n                    <div class=\"mb-3\">\r\n                        <label class=\"form-label\">Kullanıcı Grubu</label>\r\n                        <input type=\"text\" class=\"form-control\" id=\"edit_grup_info\" disabled>\r\n                    </div>\r\n                    <div class=\"mb-3\">\r\n                        <label class=\"form-label d-block\">Yetkiler</label>\r\n                        <div class=\"form-check\">\r\n                            <input class=\"form-check-input\" type=\"checkbox\" name=\"gor\" id=\"edit_gor\" value=\"1\">\r\n                            <label class=\"form-check-label\" for=\"edit_gor\">Görüntüleme</label>\r\n                        </div>\r\n                        <div class=\"form-check\">\r\n                            <input class=\"form-check-input\" type=\"checkbox\" name=\"kendi_kullanicini_gor\" id=\"edit_kendi_kullanicini_gor\" value=\"1\">\r\n                            <label class=\"form-check-label\" for=\"edit_kendi_kullanicini_gor\">Kendi Kullanıcısını Gör</label>\r\n                        </div>\r\n                        <div class=\"form-check\">\r\n                            <input class=\"form-check-input\" type=\"checkbox\" name=\"ekle\" id=\"edit_ekle\" value=\"1\">\r\n                            <label class=\"form-check-label\" for=\"edit_ekle\">Ekleme</label>\r\n                        </div>\r\n                        <div class=\"form-check\">\r\n                            <input class=\"form-check-input\" type=\"checkbox\" name=\"duzenle\" id=\"edit_duzenle\" value=\"1\">\r\n                            <label class=\"form-check-label\" for=\"edit_duzenle\">Düzenleme</label>\r\n                        </div>\r\n                        <div class=\"form-check\">\r\n                            <input class=\"form-check-input\" type=\"checkbox\" name=\"sil\" id=\"edit_sil\" value=\"1\">\r\n                            <label class=\"form-check-label\" for=\"edit_sil\">Silme</label>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"edit_yetki_durum\" class=\"form-label\">Durum</label>\r\n                        <select class=\"form-select\" id=\"edit_yetki_durum\" name=\"durum\">\r\n                            <option value=\"1\">Aktif</option>\r\n                            <option value=\"0\">Pasif</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">İptal</button>\r\n                    <button type=\"submit\" class=\"btn btn-primary\">\r\n                        <i class=\"fas fa-save me-1\"></i>Güncelle\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\r\n<script>\r\n// Menü verilerini JavaScript'e aktar\r\nconst menulerData = <?php echo json_encode($menuler); ?>;\r\nconst sayfalarData = <?php echo json_encode($sayfalar); ?>;\r\n\r\n// Sayfa tanımı için menü dropdown güncelleme\r\nfunction updateMenuDropdown() {\r\n    const modulId = document.getElementById('sayfa_modul_id').value;\r\n    const menuDropdown = document.getElementById('sayfa_menu_id');\r\n    \r\n    menuDropdown.innerHTML = '<option value=\"\">Menü seçiniz...</option>';\r\n    \r\n    if (modulId) {\r\n        const filteredMenuler = menulerData.filter(m => m.modul_id == modulId && m.durum == 1);\r\n        filteredMenuler.forEach(menu => {\r\n            const option = document.createElement('option');\r\n            option.value = menu.menu_id;\r\n            option.textContent = menu.menu_adi;\r\n            menuDropdown.appendChild(option);\r\n        });\r\n    }\r\n}\r\n\r\n// Yetki tanımı için menü dropdown güncelleme\r\nfunction updateYetkiMenuDropdown() {\r\n    const modulId = document.getElementById('yetki_modul_id').value;\r\n    const menuDropdown = document.getElementById('yetki_menu_id');\r\n    const sayfaDropdown = document.getElementById('yetki_sayfa_id');\r\n    \r\n    menuDropdown.innerHTML = '<option value=\"\">Menü seçiniz...</option>';\r\n    sayfaDropdown.innerHTML = '<option value=\"\">Önce menü seçiniz...</option>';\r\n    \r\n    if (modulId) {\r\n        const filteredMenuler = menulerData.filter(m => m.modul_id == modulId && m.durum == 1);\r\n        filteredMenuler.forEach(menu => {\r\n            const option = document.createElement('option');\r\n            option.value = menu.menu_id;\r\n            option.textContent = menu.menu_adi;\r\n            menuDropdown.appendChild(option);\r\n        });\r\n    }\r\n}\r\n\r\n// Yetki tanımı için sayfa dropdown güncelleme\r\nfunction updateYetkiSayfaDropdown() {\r\n    const menuId = document.getElementById('yetki_menu_id').value;\r\n    const sayfaDropdown = document.getElementById('yetki_sayfa_id');\r\n    \r\n    sayfaDropdown.innerHTML = '<option value=\"\">Sayfa seçiniz...</option>';\r\n    \r\n    if (menuId) {\r\n        const filteredSayfalar = sayfalarData.filter(s => s.menu_id == menuId && s.durum == 1);\r\n        filteredSayfalar.forEach(sayfa => {\r\n            const option = document.createElement('option');\r\n            option.value = sayfa.sayfa_id;\r\n            option.textContent = sayfa.sayfa_adi;\r\n            sayfaDropdown.appendChild(option);\r\n        });\r\n    }\r\n}\r\n\r\n// Yetki düzenleme\r\nfunction editYetki(yetki) {\r\n    document.getElementById('edit_yetki_id').value = yetki.sayfa_yetki_id;\r\n    document.getElementById('edit_sayfa_info').value = yetki.modul_adi + ' / ' + yetki.menu_adi + ' / ' + yetki.sayfa_adi;\r\n    document.getElementById('edit_grup_info').value = yetki.grup_adi;\r\n    document.getElementById('edit_gor').checked = yetki.gor == 1;\r\n    document.getElementById('edit_kendi_kullanicini_gor').checked = yetki.kendi_kullanicini_gor == 1;\r\n    document.getElementById('edit_ekle').checked = yetki.ekle == 1;\r\n    document.getElementById('edit_duzenle').checked = yetki.duzenle == 1;\r\n    document.getElementById('edit_sil').checked = yetki.sil == 1;\r\n    document.getElementById('edit_yetki_durum').value = yetki.durum;\r\n    \r\n    new bootstrap.Modal(document.getElementById('editYetkiModal')).show();\r\n}\r\n\r\n// Yetki silme\r\nfunction deleteYetki(yetkiId) {\r\n    if (confirm('Bu yetkiyi silmek istediğinizden emin misiniz?\\n\\nBu işlem geri alınamaz.')) {\r\n        const form = document.createElement('form');\r\n        form.method = 'POST';\r\n        form.innerHTML = `\r\n            <input type=\"hidden\" name=\"action\" value=\"delete_yetki\">\r\n            <input type=\"hidden\" name=\"yetki_id\" value=\"${yetkiId}\">\r\n        `;\r\n        document.body.appendChild(form);\r\n        form.submit();\r\n    }\r\n}\r\n</script>\r\n\r\n<?php include '../../../includes/footer.php'; ?>\r\n"
        }
    ]
}